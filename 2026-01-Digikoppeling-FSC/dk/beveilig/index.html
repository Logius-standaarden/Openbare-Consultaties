<!DOCTYPE html><html lang="nl"><head>
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<meta charset="utf-8">
<meta name="generator" content="ReSpec 35.4.1">
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;background:var(--indextable-hover-bg,#fff);color:#000;color:var(--text,#000);box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);box-shadow:0 1em 3em -.4em var(--tocsidebar-shadow,rgba(0,0,0,.3)),0 0 1px 1px var(--tocsidebar-shadow,rgba(0,0,0,.05));border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;border-bottom-color:var(--indextable-hover-bg,#fff);top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1;border-bottom-color:var(--indextable-hover-bg,#a2a9b1)}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;color:var(--text,#000);margin-top:.25em}
.dfn-panel ul a[href]{color:#333;color:var(--text,#333)}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
  
  
<meta content="text/html; charset=utf-8" http-equiv="content-type">
  
  
<link href="https://gitdocumentatie.logius.nl/publicatie/respec/style/logos/logius.ico" rel="shortcut icon" type="image/x-icon">
  
<title>Digikoppeling Beveiligingstandaarden en voorschriften 2.1.0</title>
  
 
<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:italic}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline;position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-.7em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
<style id="respec-nlgov">
img.license{float:left;padding-right:5px;background:0 0}
</style>
<meta name="color-scheme" content="light">
<meta name="description" content="Dit document beschrijft de eisen die Digikoppeling stelt aan de beveiliging van de berichtuitwisseling.">
<style>

  .sidelabel {
    position: fixed;
    -webkit-transform-origin: top right;
    right: 100%;
    top: 0;
    -webkit-transform: rotate(-90deg);
    padding: 4px 50px 4px 10px;
    color: white;
    white-space: nowrap;
    z-index: 1;
    background-color: #000000;
  }
</style>
<script id="initialUserConfig" type="application/json">{
  "nl_organisationName": "Logius",
  "nl_organisationStylesURL": "https://gitdocumentatie.logius.nl/publicatie/respec/style/",
  "nl_organisationPublishURL": "https://gitdocumentatie.logius.nl/publicatie/",
  "logos": [
    {
      "src": "https://gitdocumentatie.logius.nl/publicatie/respec/style/logos/figure-logius.svg",
      "alt": "Logius",
      "id": "Logius",
      "height": 77,
      "width": 44,
      "url": "https://www.logius.nl/onze-dienstverlening/standaarden"
    }
  ],
  "useLogo": true,
  "fileName": "",
  "latestVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "shortName",
    "/",
    "fileName"
  ],
  "thisVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "shortName",
    "/",
    "publishVersion",
    "/",
    "fileName"
  ],
  "prevVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "shortName",
    "/",
    "previousPublishVersion",
    "/",
    "fileName"
  ],
  "addSectionLinks": true,
  "localizationStrings": {
    "en": {
      "wv": "Draft",
      "cv": "Consultation version",
      "vv": "Proposed version",
      "def": "Definitive version",
      "basis": "Document",
      "eo": "Outdated version",
      "tg": "Rescinded version",
      "no": "Norm",
      "st": "Standard",
      "im": "Information model",
      "pr": "Guideline",
      "hr": "Guide",
      "wa": "Proposed recommendation",
      "al": "General",
      "bd": "Governance documentation",
      "bp": "Best practice"
    },
    "nl": {
      "wv": "Werkversie",
      "cv": "Consultatieversie",
      "vv": "Versie ter vaststelling",
      "def": "Vastgestelde versie",
      "basis": "Document",
      "eo": "Verouderde versie",
      "tg": "Teruggetrokken versie",
      "no": "Norm",
      "st": "Standaard",
      "im": "Informatiemodel",
      "pr": "Praktijkrichtlijn",
      "hr": "Handreiking",
      "wa": "Werkafspraak",
      "al": "Algemeen",
      "bd": "Beheerdocumentatie",
      "bp": "Best practice"
    }
  },
  "sotdText": {
    "nl": {
      "sotd": "Status van dit document",
      "def": "Dit is de definitieve versie van dit document. Wijzigingen naar aanleiding van consultaties zijn doorgevoerd.",
      "wv": "Dit is een werkversie die op elk moment kan worden gewijzigd, verwijderd of vervangen door andere documenten. Het is geen door het TO goedgekeurde consultatieversie.",
      "cv": "Dit is een door het TO goedgekeurde consultatieversie. Commentaar over dit document kan gestuurd worden naar digikoppeling@logius.nl",
      "vv": "Dit is een definitief concept van de nieuwe versie van dit document. Wijzigingen naar aanleiding van consultaties zijn doorgevoerd.",
      "basis": "Dit is een document zonder officiële status."
    },
    "en": {
      "sotd": "Status of This Document",
      "def": "This is the definitive version of this document. Edits resulting from consultations have been applied.",
      "wv": "This is a draft that could be altered, removed or replaced by other documents. It is not a recommendation approved by TO.",
      "cv": "This is a proposed recommendation approved by TO. Comments regarding this document may be sent to api@logius.nl",
      "vv": "This is the definitive concept of this document. Edits resulting from consultations have been applied.",
      "basis": "This document has no official standing."
    }
  },
  "labelColor": {
    "def": "#154273",
    "wv": "#39870c",
    "cv": "#000000",
    "vv": "#000000"
  },
  "useLabel": true,
  "licenses": {
    "cc0": {
      "name": "Creative Commons 0 Public Domain Dedication",
      "short": "CC0",
      "url": "https://creativecommons.org/publicdomain/zero/1.0/",
      "image": "https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-zero.svg"
    },
    "cc-by": {
      "name": "Creative Commons Attribution 4.0 International Public License",
      "short": "CC-BY",
      "url": "https://creativecommons.org/licenses/by/4.0/legalcode",
      "image": "https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-by.svg"
    },
    "cc-by-nd": {
      "name": "Creative Commons Naamsvermelding-GeenAfgeleideWerken 4.0 Internationaal",
      "short": "CC-BY-ND",
      "url": "https://creativecommons.org/licenses/by-nd/4.0/legalcode.nl",
      "image": "https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-by-nd.svg"
    }
  },
  "license": "cc-by",
  "localBiblio": {
    "ADR": {
      "authors": [
        "Jasper Roes",
        "Joost Farla"
      ],
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/adr/2.1",
      "publisher": "Logius",
      "title": "API Design Rules"
    },
    "ADR1": {
      "authors": [
        "Jasper Roes",
        "Joost Farla"
      ],
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/adr/1.0",
      "publisher": "Logius",
      "title": "API Design Rules"
    },
    "ADR-ext": {
      "authors": [
        "Jasper Roes",
        "Linda van den Brink"
      ],
      "date": "Januari 2020",
      "href": "https://docs.geostandaarden.nl/api/API-Strategie-ext",
      "publisher": "Geonovum/Kennisplatform APi's",
      "title": "API Designrules Extensions (Nederlandse API Strategie IIb)"
    },
    "Algemene Voorwaarden Logius": {
      "date": "12 juni 2018",
      "href": "https://www.logius.nl/onze-organisatie/zakendoen-met-logius/voorwaarden/algemene-voorwaarden-logius",
      "publisher": "Logius",
      "title": "Algemene voorwaarden Logius"
    },
    "AuthZEN": {
      "date": "6 September 2024 ",
      "href": "https://openid.net/specs/authorization-api-1_0-01.html",
      "publisher": "OpenID",
      "title": "Authorization API 1.0 – draft 01"
    },
    "AVG": {
      "date": "27 april 2016",
      "href": "https://eur-lex.europa.eu/legal-content/NL/TXT/?uri=CELEX%3A32016R0679",
      "publisher": "Verordening (EU) 2016/679 van het Europees Parlement",
      "title": "Algemene Verordening Gegevensbescherming"
    },
    "BCP195": {
      "authors": [
        "Y. Sheffer",
        "R. Holz",
        "P. Saint-Andre"
      ],
      "date": "May 2015",
      "href": "https://tools.ietf.org/html/bcp195",
      "publisher": "IETF",
      "title": "Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"
    },
    "DK-beveiliging": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/beveilig/",
      "publisher": "Logius",
      "title": "Digikoppeling Beveiligingsstandaarden en voorschriften"
    },
    "CloudEvents": {
      "date": "May 2011",
      "href": "https://github.com/cloudevents/spec/blob/v1.0.1/spec.md",
      "publisher": "CNCF Serverless Working Group",
      "title": "CloudEvents - Version 1.0.1"
    },
    "NLGOV-CloudEvents": {
      "authors": [
        "Werkgroep Berichtenstandaard (Project Notificatieservices)"
      ],
      "href": "https://logius-standaarden.github.io/NL-GOV-profile-for-CloudEvents/",
      "publisher": "Logius",
      "title": "NL GOV profile for CloudEvents"
    },
    "DK-CV": {
      "href": "https://gitlab.com/logius/digikoppeling-compliance",
      "publisher": "Logius",
      "title": "Digikoppeling Compliance Voorziening"
    },
    "DK-Portaal": {
      "href": "https://oinregister.logius.nl/",
      "publisher": "Logius",
      "title": "Digikoppeling Portaal",
      "id": "dk-portaal"
    },
    "DK-WUS-voorbeeld": {
      "href": "https://www.logius.nl/sites/default/files/public/bestanden/diensten/DigiKoppeling/Overig/Digikoppeling-Koppelvlakstandaard-WUS-Voorbeeldberichten.zip",
      "publisher": "Logius",
      "title": "Set voorbeeldberichten (zip)"
    },
    "Deployment Guide 1.1": {
      "authors": [
        "Pete Wenzel",
        "Jacques Durand"
      ],
      "date": "June 2005",
      "href": "http://www.oasis-open.org/apps/org/workgroup/ebxml-iic-deployment-profile-template-intro-100406.doc",
      "publisher": "OASIS",
      "title": "Deployment Profile Template For OASIS ebXML Message Service 2.0"
    },
    "DK": {
      "href": "https://www.logius.nl/domeinen/gegevensuitwisseling/digikoppeling",
      "publisher": "Logius",
      "title": "Logius | Digikoppeling"
    },
    "DK-Doc": {
      "href": "https://www.logius.nl/domeinen/gegevensuitwisseling/digikoppeling/documentatie",
      "publisher": "Logius",
      "title": "Digikoppeling documentatie"
    },
    "DK-Beheermodel": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/beheer/",
      "publisher": "Logius",
      "title": "Digikoppeling Beheermodel",
      "id": "dk-beheermodel"
    },
    "DK-BPebMS": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/bpebms/",
      "publisher": "Logius",
      "title": "Digikoppeling Best Practices ebMS2"
    },
    "DK-BPGB": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/bpgb/",
      "publisher": "Logius",
      "title": "Digikoppeling Best Practices Grote Berichten"
    },
    "DK-BPWUS": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/bpwus/",
      "publisher": "Logius",
      "title": "Digikoppeling Best Practices WUS"
    },
    "DK-Beveiliging": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/beveilig/",
      "publisher": "Logius",
      "title": "Digikoppeling Beveiligingsstandaarden en voorschriften"
    },
    "DK-gbachtcert": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/ebms/",
      "publisher": "Logius",
      "title": "Digikoppeling Koppelvlakstandaard ebMS2",
      "id": "dk-gbachtcert"
    },
    "DK-ebMS": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/ebms/",
      "publisher": "Logius",
      "title": "Digikoppeling Koppelvlakstandaard ebMS2"
    },
    "DK-GB": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/gb/",
      "publisher": "Logius",
      "title": "Digikoppeling Koppelvlakstandaard Grote Berichten"
    },
    "DK-WUS": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/wus/",
      "publisher": "Logius",
      "title": "Digikoppeling Koppelvlakstandaard WUS"
    },
    "DK-RESTAPI": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/restapi/",
      "publisher": "Logius",
      "title": "Digikoppeling Koppelvlakstandaard REST-API"
    },
    "DK-Architectuur": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/architectuur/",
      "publisher": "Logius",
      "title": "Digikoppeling Architectuur",
      "id": "dk-architectuur"
    },
    "DK-IDAuth": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/idauth/",
      "publisher": "Logius",
      "title": "Digikoppeling Identificatie en Authenticatie",
      "id": "dk-idauth"
    },
    "DK-WI": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/watisdk/",
      "publisher": "Logius",
      "title": "Wat is Digikoppeling?"
    },
    "BOMOSFundament": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/bomos/fundament/",
      "date": "2 november 2023",
      "publisher": "Logius",
      "title": "BOMOS, het fundament"
    },
    "BOMOSVerdieping": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/bomos/verdieping/",
      "date": "2 november 2023",
      "publisher": "Logius",
      "title": "BOMOS, de verdieping"
    },
    "ebCPP": {
      "authors": [
        "Oasis"
      ],
      "date": "september 2002",
      "href": "http://www.ebxml.org/specs/ebcpp-2.0.pdf",
      "publisher": "Oasis",
      "title": "Collaboration-Protocol Profile and Agreement Specification Version 2.0"
    },
    "ebMS3": {
      "authors": [
        "Ian Jones",
        "Pete Wenzel"
      ],
      "date": "October 2007",
      "href": "https://docs.oasis-open.org/ebxml-msg/ebms/v3.0/core/os/ebms_core-3.0-spec-os.html",
      "publisher": "Oasis",
      "title": "Collaboration-Protocol Profile and Agreement Specification Version 2.0"
    },
    "eDelivery API4IPS": {
      "authors": [
        "J. Dimitriou, V. Veduta, B. Dumitriu"
      ],
      "date": "sept 8 2022",
      "href": "https://ec.europa.eu/digital-building-blocks/wikis/display/EDELCOMMUNITY/Project+deliverables",
      "publisher": "OpenID foundation",
      "title": "(ISA2).(eDelivery).(Piloting a REST API extension of CEF eDelivery).(ISA² IPS REST API Profile).(v1.0).pdf"
    },
    "Expert": {
      "authors": [
        "@@@"
      ],
      "date": "@@@",
      "href": "https://www.forumstandaardisatie.nl/sites/bfs/files/@@@.pdf",
      "publisher": "Forum Standaardisatie",
      "title": "Expertadvies CloudEvents 1.0"
    },
    "folmer2011": {
      "href": "https://research.utwente.nl/en/publications/management-and-development-model-for-open-standards-bomos-version",
      "title": "Management and Development Model for Open Standards (BOMOS) version 2",
      "keywords": "IR-76837",
      "authors": [
        "ErwinFolmer",
        "Matthijs Punter"
      ],
      "date": "2011",
      "language": "English",
      "publisher": "Programmabureau NOiV"
    },
    "folmer2012": {
      "href": "https://research.utwente.nl/en/publications/quality-of-semantic-standards",
      "title": "Quality of Semantic Standards",
      "authors": [
        "Erwin Folmer"
      ],
      "date": "2012",
      "publisher": "Universiteit Twente"
    },
    "DK-Gebruiksvoorwaarden": {
      "date": "1 januari 2021",
      "href": "https://www.logius.nl/domeinen/gegevensuitwisseling/digikoppeling/documentatie/gebruiksvoorwaarden-digikoppeling",
      "publisher": "Logius",
      "title": "Gebruiksvoorwaarden Digikoppeling"
    },
    "ADR-GEO": {
      "authors": [
        "L. van den Brink, P. Bresters, P. van Genuchten, G. Mathijssen, M. Strijker"
      ],
      "date": "March 07, 2024",
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/mod-geo/",
      "publisher": "Geonovum",
      "title": "API Design Rules Module: Geospatial"
    },
    "HTTPS-factsheet NCSC": {
      "date": "Nov 2014",
      "href": "https://www.ncsc.nl/documenten/factsheets/2019/juni/01/factsheet-https-kan-een-stuk-veiliger",
      "publisher": "NCSC",
      "title": "Factsheet HTTPS kan een stuk veiliger",
      "id": "https-factsheet ncsc"
    },
    "iGOV.OpenID": {
      "authors": [
        "M. Varley, P. Grassi"
      ],
      "date": "October 5 2018",
      "href": "https://openid.net/specs/openid-igov-openid-connect-1_0.html",
      "publisher": "OpenID foundation",
      "title": "International Government Assurance Profile (iGov) for OpenID Connect 1.0 - draft 3"
    },
    "NLGOV.OpenID": {
      "authors": [
        "Remco Schaar, Frank van Es, Joris Joosten, Jan Geert Koops"
      ],
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/oidc/",
      "publisher": "Logius",
      "title": "OpenID NLGov"
    },
    "Introspection": {
      "authors": [
        "J. Richer"
      ],
      "date": "October 2015",
      "href": "https://tools.ietf.org/html/rfc7662",
      "publisher": "IETF",
      "title": "OAuth 2.0 Token Introspection"
    },
    "JWA": {
      "authors": [
        "M. Jones"
      ],
      "date": "may 2015",
      "href": "https://tools.ietf.org/html/rfc7518",
      "publisher": "IETF",
      "title": "JSON Web Algorithms (JWA)"
    },
    "JWE": {
      "authors": [
        "M. Jones, J. Hildebrand"
      ],
      "date": "may 2015",
      "href": "https://tools.ietf.org/html/rfc7516",
      "publisher": "IETF",
      "title": "JSON Web Encryption (JWE)"
    },
    "JWK": {
      "authors": [
        "M. Jones"
      ],
      "date": "may 2015",
      "href": "https://tools.ietf.org/html/rfc7517",
      "publisher": "IETF",
      "title": "JSON Web Key (JWK))"
    },
    "JWS": {
      "authors": [
        "M. Jones, J. Bradley, N. Sakimura"
      ],
      "date": "may 2015",
      "href": "https://tools.ietf.org/html/rfc7515",
      "publisher": "IETF",
      "title": "JSON Web Signature (JWS)"
    },
    "JWT": {
      "authors": [
        "M. Jones, J. Bradley, N. Sakimura"
      ],
      "date": "may 2015",
      "href": "https://tools.ietf.org/html/rfc7519",
      "publisher": "IETF",
      "title": "JSON Web Token (JWT)"
    },
    "NCSC 2021": {
      "date": "Jan 2021",
      "href": "https://www.ncsc.nl/documenten/publicaties/2021/januari/19/ict-beveiligingsrichtlijnen-voor-transport-layer-security-2.1",
      "publisher": "NCSC",
      "title": "ICT-beveiligingsrichtlijnen voor Transport Layer Security (TLS) v2.1",
      "id": "ncsc 2021"
    },
    "NCSC 2025": {
      "date": "June 2025",
      "href": "https://www.ncsc.nl/wat-kun-je-zelf-doen/documenten/publicaties/2025/juni/01/ict-beveiligingsrichtlijnen-voor-transport-layer-security-2025-05",
      "publisher": "NCSC",
      "title": "Transport Layer Security (TLS) richtlijnen 2025-05",
      "id": "ncsc 2025"
    },
    "NEN3610": {
      "authors": [
        ""
      ],
      "date": "Maart 2011",
      "href": "https://www.nen.nl/nen-3610-2011-a1-2016-nl-217738",
      "publisher": "Nederlands Normalisatie-instituut",
      "title": "Basismodel Geo-informatie - Termen, definities, relaties en algemene regels voor de uitwisseling van informatie over aan de aarde gerelateerde ruimtelijke objecten"
    },
    "no-Reliable-messaging": {
      "authors": [
        "Marc de Graauw"
      ],
      "date": "June 18, 2010",
      "href": "https://www.infoq.com/articles/no-reliable-messaging/",
      "publisher": "infoQ",
      "title": "Nobody Needs Reliable Messaging"
    },
    "OAuth2": {
      "authors": [
        "D. Hardt"
      ],
      "date": "October 2012",
      "href": "https://tools.ietf.org/html/rfc6749",
      "publisher": "The Internet Engineering Task Force",
      "title": "The OAuth 2.0 Authorization Framework"
    },
    "OpenID.Core": {
      "authors": [
        "N. Sakimura, J. Bradley, M. Jones, B. de Medeiros, C. Mortimore"
      ],
      "date": "November 8 2014",
      "href": "https://openid.net/specs/openid-connect-core-1_0.html",
      "publisher": "OpenID foundation",
      "title": "OpenID Connect Core 1.0"
    },
    "OpenID.Discovery": {
      "authors": [
        "N. Sakimura, J. Bradley, M. Jones, E. Jay"
      ],
      "date": "November 8 2014",
      "href": "https://openid.net/specs/openid-connect-discovery-1_0.html",
      "publisher": "OpenID foundation",
      "title": "OpenID Connect Discovery 1.0"
    },
    "Pas-toe-of-leg-uit": {
      "href": "https://www.forumstandaardisatie.nl/open-standaarden/verplicht",
      "publisher": "Forum Standaardisatie",
      "title": "Lijst Verplichte standaarden"
    },
    "PKIO-PvE": {
      "href": "https://cp.pkioverheid.nl/",
      "publisher": "Logius",
      "title": "Certificate Policy/Programme of Requirements PKIoverheid",
      "id": "pkio-pve"
    },
    "PKI-CA": {
      "href": "https://www.logius.nl/domeinen/toegang/aansluiten-als-trust-service-provider",
      "publisher": "Logius",
      "title": "Aansluiten als Trust Service Provider",
      "id": "pki-ca"
    },
    "PKIoverheid": {
      "href": "https://www.logius.nl/domeinen/toegang/pkioverheid",
      "publisher": "Logius",
      "title": "PKIoverheid",
      "id": "pkioverheid"
    },
    "PKIO-Cert": {
      "href": "https://cert.pkioverheid.nl/",
      "publisher": "Logius",
      "title": "Overzicht PKIoverheid certificaten"
    },
    "SemVer": {
      "authors": [
        "T. Preston-Werner"
      ],
      "date": "June 2013",
      "href": "https://semver.org",
      "title": "Semantic Versioning 2.0.0"
    },
    "ADR-TS": {
      "authors": [
        ""
      ],
      "date": "March 07, 2024",
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/mod-ts/",
      "publisher": "Kennisplatform API's",
      "title": "API Design Rules Module: Transport Security"
    },
    "UMMR10": {
      "authors": [
        ""
      ],
      "date": "2001",
      "href": "https://unece.org/DAM/cefact/umm/UMM_Revision_10_2001.zip",
      "publisher": "UN/CEFACT",
      "title": "UMM Revision 10"
    },
    "UMMUG": {
      "authors": [
        ""
      ],
      "date": "2003",
      "href": "https://www.unece.org/fileadmin/DAM/cefact/umm/UMM_userguide_220606.pdf",
      "publisher": "UN/CEFACT",
      "title": "UN/CEFACT Modeling Methodology (UMM) User Guide"
    },
    "UUID": {
      "authors": [
        "P. Leach",
        "M. Mealling",
        "R. Salz"
      ],
      "date": "July 2005",
      "href": "https://tools.ietf.org/html/rfc4122",
      "publisher": "The Internet Engineering Task Force",
      "title": "A Universally Unique IDentifier (UUID) URN Namespace"
    },
    "DK-Voorwaarden": {
      "date": "1 januari 2021",
      "href": "https://www.logius.nl/domeinen/gegevensuitwisseling/digikoppeling/documentatie/voorwaarden-digikoppeling",
      "publisher": "Logius",
      "title": "Voorwaarden Digikoppeling"
    },
    "X520": {
      "href": "https://www.iso.org/standard/43796.html",
      "publisher": "ISO",
      "title": "ITU-T Recommendation X.520 (2001) ISO/IEC 9594-6"
    },
    "ADR-Validator": {
      "href": "https://gitlab.com/commonground/don/adr-validator/-/tree/v0.5.0/pkg/rulesets",
      "title": "Technical ADR Validation rule testset 0.5.0",
      "authors": [
        "H. Stijns"
      ],
      "publisher": "Geonovum",
      "date": "November 2023"
    },
    "JRC117836": {
      "href": "https://op.europa.eu/en/publication-detail/-/publication/6521f427-01df-11ea-8c1f-01aa75ed71a1",
      "title": "The Relationship Between Open Source Software and Standard Setting",
      "authors": [
        "Knut Blind",
        "Mirko Böhm"
      ],
      "editors": [
        "Nikolaus Thumm"
      ],
      "publisher": "Joint Research Center",
      "id": "JRC117836",
      "date": "2019"
    },
    "Krechmer2002": {
      "href": "https://www.isology.com/pdf/cathedrals.pdf",
      "title": "Cathedrals, Libraries and Bazaars",
      "authors": [
        "Ken Krechmer"
      ],
      "publisher": "Association of Computing Machinery (ACM)",
      "date": "March 2002"
    },
    "FSC-Core": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/fsc/core/2.0.0/",
      "title": "FSC - Core",
      "authors": [
        "Eelco Hotting",
        "Ronald Koster",
        "Henk van Maanen",
        "Niels Dequeker",
        "Edward van Gelderen",
        "Pim Gaemers"
      ],
      "publisher": "Logius"
    },
    "FSC-Logging": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/fsc/logging/1.1.0/",
      "title": "FSC - Logging",
      "authors": [
        "Eelco Hotting",
        "Ronald Koster",
        "Henk van Maanen",
        "Niels Dequeker",
        "Edward van Gelderen",
        "Pim Gaemers"
      ],
      "publisher": "Logius"
    },
    "HEART.OAuth2": {
      "authors": [
        "J. Richer"
      ],
      "date": "April 25, 2017",
      "href": "https://openid.net/specs/openid-heart-oauth2-1_0.html",
      "publisher": "OpenID foundation",
      "title": "Health Relationship Trust Profile for OAuth 2.0"
    },
    "JWS.JWE.Algs": {
      "authors": [
        "Jim Schaad, Jeff Hodges, Joe Hildebrand, Sean Turner"
      ],
      "date": "",
      "href": "https://www.iana.org/assignments/jose/jose.xhtml#web-signature-encryption-algorithms",
      "publisher": "IANA",
      "title": "IANA JSON Web Signatures and Encryption Algorithms registry"
    },
    "I-D.ietf-oauth-pop-architecture": {
      "authors": [
        "P. Hunt, J. Richer, W. Mills, P. Mishra, H. Tschofenig"
      ],
      "date": "July 8, 2016",
      "href": "https://tools.ietf.org/html/draft-ietf-oauth-pop-architecture-08",
      "publisher": "IETF",
      "title": "OAuth 2.0 Proof-of-Possession (PoP) Security Architecture"
    },
    "iGOV.OAuth2": {
      "authors": [
        "J. Richer, M. Varley, P. Grassi"
      ],
      "date": "October 5 2018",
      "href": "https://openid.net/specs/openid-igov-oauth2-1_0-03.html",
      "publisher": "OpenID foundation",
      "title": "International Government Assurance Profile (iGov) for OAuth 2.0"
    },
    "NLGOV.OAuth2": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/oauth/",
      "publisher": "Logius",
      "title": "NL GOV Assurance profile for OAuth 2.0"
    },
    "ietf-oauth-v2-1-10-refresh-token-grant": {
      "authors": [
        "Dick Hardt, Aaron Parecki, Torsten Lodderstedt"
      ],
      "date": "January 9, 2024",
      "href": "https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-1-10#name-refresh-token-grant",
      "publisher": "IETF",
      "title": "The OAuth 2.1 Authorization Framework: Refresh Token Grant"
    },
    "OpenID.FAPI2.0": {
      "authors": [
        "D. Fett, D. Tonge, J. Heenan"
      ],
      "date": "February 22 2025",
      "href": "https://openid.net/specs/fapi-security-profile-2_0-final.html",
      "publisher": "OpenID foundation",
      "title": "FAPI 2.0 Security Profile"
    },
    "logboek-extensie-guideline": {
      "href": "https://logius-standaarden.github.io/logboek-extensie-template/",
      "publisher": "Logius",
      "title": "LDV Extensie Guideline"
    },
    "logboek dataverwerkingen": {
      "href": "https://logius-standaarden.github.io/logboek-dataverwerkingen/",
      "publisher": "Logius",
      "title": "Logboek Dataverwerkingen"
    }
  },
  "authors": [
    {
      "name": "Pieter Hering",
      "url": "https://logius.nl/standaarden"
    }
  ],
  "editors": [
    {
      "name": "Peter Haasnoot",
      "url": "https://logius.nl/standaarden"
    },
    {
      "name": "Nil Barua",
      "url": "https://logius.nl/standaarden"
    }
  ],
  "github": "https://github.com/Logius-standaarden/Digikoppeling-Beveiligingsstandaarden-en-voorschriften",
  "previousPublishDate": "2025-06-24",
  "previousPublishVersion": "2.0.1",
  "pubDomain": "dk",
  "publishDate": "2026-01-19",
  "publishVersion": "2.1.0",
  "shortName": "beveilig",
  "specStatus": "CV",
  "specType": "ST",
  "preProcess": [
    null,
    null
  ]
}</script>
<link rel="stylesheet" href="https://gitdocumentatie.logius.nl/publicatie/respec/style/base.css"></head>
 <body class="h-entry toc-inline"><div class="head">
    <a class="logo" href="https://www.logius.nl/onze-dienstverlening/standaarden"><img alt="Logius" height="77" id="Logius" src="https://gitdocumentatie.logius.nl/publicatie/respec/style/logos/figure-logius.svg" width="44">
  </a> <h1 id="title" class="title">Digikoppeling Beveiligingstandaarden en voorschriften 2.1.0</h1>
    
    <h2>
      Logius Standaard<br>
      Consultatieversie
      <time class="dt-published" datetime="2026-01-19">19 januari 2026</time>
    </h2>
    <dl>
      <dt>Deze versie:</dt><dd class="status">
              <a class="u-url status" href="https://gitdocumentatie.logius.nl/publicatie/dk/beveilig/2.1.0/">https://gitdocumentatie.logius.nl/publicatie/dk/beveilig/2.1.0/</a>
            </dd>
      <dt>Laatst gepubliceerde versie:</dt><dd>
              <a href="https://gitdocumentatie.logius.nl/publicatie/dk/beveilig/">https://gitdocumentatie.logius.nl/publicatie/dk/beveilig/</a>
            </dd>
      <dt>Laatste werkversie:</dt><dd><a href="https://logius-standaarden.github.io/Digikoppeling-Beveiligingsstandaarden-en-voorschriften/">https://logius-standaarden.github.io/Digikoppeling-Beveiligingsstandaarden-en-voorschriften/</a></dd>
      
      
      
      <dt>Vorige versie:</dt><dd><a href="https://gitdocumentatie.logius.nl/publicatie/dk/beveilig/2.0.1/">https://gitdocumentatie.logius.nl/publicatie/dk/beveilig/2.0.1/</a></dd>
      
      <dt>Redacteurs:</dt>
      <dd class="editor p-author h-card vcard">
    <a class="u-url url p-name fn" href="https://logius.nl/standaarden">Peter Haasnoot</a>
  </dd><dd class="editor p-author h-card vcard">
    <a class="u-url url p-name fn" href="https://logius.nl/standaarden">Nil Barua</a>
  </dd>
      
      <dt>Auteur:</dt><dd class="editor p-author h-card vcard">
    <a class="u-url url p-name fn" href="https://logius.nl/standaarden">Pieter Hering</a>
  </dd>
      <dt>Doe mee:</dt><dd>
    <a href="https://github.com/Logius-standaarden/Digikoppeling-Beveiligingsstandaarden-en-voorschriften/">GitHub Logius-standaarden/Digikoppeling-Beveiligingsstandaarden-en-voorschriften</a>
  </dd><dd>
    <a href="https://github.com/Logius-standaarden/Digikoppeling-Beveiligingsstandaarden-en-voorschriften/issues/">Dien een melding in</a>
  </dd><dd>
    <a href="https://github.com/Logius-standaarden/Digikoppeling-Beveiligingsstandaarden-en-voorschriften/commits/">Revisiehistorie</a>
  </dd><dd>
    <a href="https://github.com/Logius-standaarden/Digikoppeling-Beveiligingsstandaarden-en-voorschriften/pulls/">Pull requests</a>
  </dd>
    </dl>
    
    
    <p>
          Dit document is ook beschikbaar in dit niet-normatieve formaat:
          <a rel="alternate" href="dk-beveilig-2.1.0.pdf">PDF</a>
        </p>
    <p class="copyright">
            Dit document valt onder de volgende licentie: 
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0/legalcode" class="subfoot"><img class="license" src="https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-by.svg" alt="Logo Creative Commons Attribution 4.0 International Public License"><br> Creative Commons Attribution 4.0 International Public License</a>
          </p>
    <hr title="Separator for header">
  </div><section id="sotd" class="introductory"><h2>Status van dit document</h2><p>Dit is een door het TO goedgekeurde consultatieversie. Commentaar over dit document kan gestuurd worden naar digikoppeling@logius.nl</p></section><nav id="toc"><h2 class="introductory" id="inhoudsopgave">Inhoudsopgave</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#sotd">Status van dit document</a></li><li class="tocline"><a class="tocxref" href="#conformance">Conformiteit</a></li><li class="tocline"><a class="tocxref" href="#abstract">Samenvatting</a></li><li class="tocline"><a class="tocxref" href="#documentbeheer">Documentbeheer</a></li><li class="tocline"><a class="tocxref" href="#colofon">Colofon</a></li><li class="tocline"><a class="tocxref" href="#inleiding"><bdi class="secno">1. </bdi>Inleiding</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#doel-en-doelgroep"><bdi class="secno">1.1 </bdi>Doel en Doelgroep</a></li><li class="tocline"><a class="tocxref" href="#digikoppeling"><bdi class="secno">1.2 </bdi>Digikoppeling</a></li><li class="tocline"><a class="tocxref" href="#digikoppeling-standaarden"><bdi class="secno">1.3 </bdi>Digikoppeling standaarden</a></li></ol></li><li class="tocline"><a class="tocxref" href="#identificatie"><bdi class="secno">2. </bdi>Identificatie</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#wat-is-identificatie"><bdi class="secno">2.1 </bdi>Wat is identificatie?</a></li><li class="tocline"><a class="tocxref" href="#identificerend-nummer"><bdi class="secno">2.2 </bdi>Identificerend nummer</a></li></ol></li><li class="tocline"><a class="tocxref" href="#pkioverheid-certificaten"><bdi class="secno">3. </bdi>PKIoverheid certificaten</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#standaarden"><bdi class="secno">3.1 </bdi>Standaarden</a></li><li class="tocline"><a class="tocxref" href="#wat-is-pkioverheid"><bdi class="secno">3.2 </bdi>Wat is PKIoverheid?</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#pkioverheid"><bdi class="secno">3.2.1 </bdi>PKIoverheid</a></li><li class="tocline"><a class="tocxref" href="#pkioverheid-certificaat"><bdi class="secno">3.2.2 </bdi>PKIoverheid certificaat</a></li></ol></li><li class="tocline"><a class="tocxref" href="#voorschriften"><bdi class="secno">3.3 </bdi>Voorschriften</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#digikoppeling-voorschriften"><bdi class="secno">3.3.1 </bdi>Digikoppeling voorschriften</a></li><li class="tocline"><a class="tocxref" href="#pkioverheid-programme-of-requirements"><bdi class="secno">3.3.2 </bdi>PKIoverheid Programme of Requirements</a></li><li class="tocline"><a class="tocxref" href="#geldigheid"><bdi class="secno">3.3.3 </bdi>Geldigheid</a></li></ol></li><li class="tocline"><a class="tocxref" href="#best-practices"><bdi class="secno">3.4 </bdi>Best practices</a></li></ol></li><li class="tocline"><a class="tocxref" href="#tls-transport-layer-security"><bdi class="secno">4. </bdi>TLS (Transport Layer Security)</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#standaarden-0"><bdi class="secno">4.1 </bdi>Standaarden</a></li><li class="tocline"><a class="tocxref" href="#digikoppeling-voorschriften-0"><bdi class="secno">4.2 </bdi>Digikoppeling voorschriften</a></li><li class="tocline"><a class="tocxref" href="#onderbouwing"><bdi class="secno">4.3 </bdi>Onderbouwing</a></li><li class="tocline"><a class="tocxref" href="#overwegingen"><bdi class="secno">4.4 </bdi>Overwegingen</a></li></ol></li><li class="tocline"><a class="tocxref" href="#cipher-suites-voor-tls-signing-en-encryptie"><bdi class="secno">5. </bdi>Cipher suites voor TLS, signing en encryptie</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#tls-ciphersuites"><bdi class="secno">5.1 </bdi>TLS Ciphersuites</a></li><li class="tocline"><a class="tocxref" href="#xml-signing"><bdi class="secno">5.2 </bdi>XML Signing</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#digikoppeling-voorschriften-voor-xml-signing"><bdi class="secno">5.2.1 </bdi>Digikoppeling voorschriften voor XML signing</a></li><li class="tocline"><a class="tocxref" href="#reden-voor-vervanging-sha-1-door-sha-2"><bdi class="secno">5.2.2 </bdi>Reden voor vervanging SHA-1 door SHA-2</a></li></ol></li><li class="tocline"><a class="tocxref" href="#xml-encryptie"><bdi class="secno">5.3 </bdi>XML Encryptie</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#digikoppeling-voorschriften-voor-payload-encryptie"><bdi class="secno">5.3.1 </bdi>Digikoppeling voorschriften voor payload encryptie</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#tof"><bdi class="secno">6. </bdi>Lijst met figuren</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">A. </bdi>Referenties</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normatieve-referenties"><bdi class="secno">A.1 </bdi>Normatieve referenties</a></li><li class="tocline"><a class="tocxref" href="#informatieve-referenties"><bdi class="secno">A.2 </bdi>Informatieve referenties</a></li></ol></li></ol></nav><section id="conformance" class="introductory"><div class="header-wrapper"><h2 id="conformiteit">Conformiteit</h2><a class="self-link" href="#conformance" aria-label="Permalink for this Section"></a></div><p>Naast onderdelen die als niet normatief gemarkeerd zijn, zijn ook alle diagrammen, voorbeelden, en noten in dit document niet normatief. Verder is alles in dit document normatief.</p>
  </section>
  <section id="abstract" class="introductory"><h2>Samenvatting</h2><p>Dit document beschrijft de eisen die Digikoppeling stelt aan de beveiliging van de berichtuitwisseling.</p>

<p>Dit document is bestemd voor architecten en ontwikkelaars van applicaties die gebruik maken van Digikoppeling om
    berichten tussen systemen veilig uit te wisselen.</p>

<p>Alle Digikoppeling webservices die op WUS of ebMS2 gebaseerd zijn, moeten conformeren aan deze Digikoppeling
    beveiligingsstandaarden en voorschriften. Deze wordt in dit document gespecificeerd.</p>

<p>Doel van dit document is ontwikkelaars te informeren wat deze beveiligingsvoorschriften precies inhouden, welke
    standaarden en welke versies toegestaan zijn en partijen zich aan moeten conformeren.</p></section>
  
  <section class="introductory" id="documentbeheer"><div class="header-wrapper"><h2 id="documentbeheer-0">Documentbeheer</h2><a class="self-link" href="#documentbeheer" aria-label="Permalink for this Section"></a></div>
<table>
<thead>
<tr>
<th>Datum</th>
<th>Versie</th>
<th>Auteur</th>
<th>Opmerkingen</th>
</tr>
</thead>
<tbody><tr>
<td>04/04/2016</td>
<td>1.0</td>
<td>Logius</td>
<td>Nieuwe standaarddocument</td>
</tr>
<tr>
<td>12/10/2017</td>
<td>1.1</td>
<td>Logius</td>
<td>CSP hernoemd naar TSP Opmerkingen over migratie TLS verwijderd</td>
</tr>
<tr>
<td>17/12/2019</td>
<td>1.2</td>
<td>Logius</td>
<td>Aanpassing n.a.v. NCSC TLS Richtlijnen versie 2.0</td>
</tr>
<tr>
<td>01/09/2020</td>
<td>1.3</td>
<td>Logius</td>
<td>PKIO Private Root certificaten toegevoegd</td>
</tr>
<tr>
<td>01/02/2021</td>
<td>1.4</td>
<td>Logius</td>
<td>Alleen PKIO Private Root toegestaan. Verwijzing naar meest recente versie van [<cite><a class="bibref" data-link-type="biblio" href="#bib-ncsc 2021" title="ICT-beveiligingsrichtlijnen voor Transport Layer Security (TLS) v2.1">NCSC 2021</a></cite>]. Vorige versie was v2.0 uit 2019</td>
</tr>
<tr>
<td>15/05/2025</td>
<td>2.0</td>
<td>Logius</td>
<td>Uitfasering 3DES</td>
</tr>
<tr>
<td>24/06/2025</td>
<td>2.0.1</td>
<td>Logius</td>
<td>Aanpassing n.a.v. NCSC TLS 2025 Richtlijnen. Verwijzing naar meest recente versie van [<cite><a class="bibref" data-link-type="biblio" href="#bib-ncsc 2025" title="Transport Layer Security (TLS) richtlijnen 2025-05">NCSC 2025</a></cite>]. Vorige versie was [<cite><a class="bibref" data-link-type="biblio" href="#bib-ncsc 2021" title="ICT-beveiligingsrichtlijnen voor Transport Layer Security (TLS) v2.1">NCSC 2021</a></cite>]</td>
</tr>
</tbody></table>
</section>
  <section class="introductory" id="colofon"><div class="header-wrapper"><h2 id="colofon-0">Colofon</h2><a class="self-link" href="#colofon" aria-label="Permalink for this Section"></a></div>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>Logius Servicecentrum:</td>
<td>Postbus 96810 <br>2509 JE Den Haag<br>tel. 0900 555 4555 (10 ct p/m)<br>email <a href="mailto:servicecentrum@logius.nl">servicecentrum@logius.nl</a></td>
</tr>
</tbody></table>
</section>
  <section id="inleiding"><div class="header-wrapper"><h2 id="x1-inleiding"><bdi class="secno">1. </bdi>Inleiding</h2><a class="self-link" href="#inleiding" aria-label="Permalink for Section 1."></a></div>
<section id="doel-en-doelgroep"><div class="header-wrapper"><h3 id="x1-1-doel-en-doelgroep"><bdi class="secno">1.1 </bdi>Doel en Doelgroep</h3><a class="self-link" href="#doel-en-doelgroep" aria-label="Permalink for Section 1.1"></a></div>
<p>Dit document beschrijft de eisen die Digikoppeling stelt aan de beveiliging van de berichtuitwisseling.</p>
<p>Dit document is bestemd voor architecten en ontwikkelaars van applicaties die gebruik maken van Digikoppeling om berichten tussen systemen veilig uit te wisselen.</p>
<p>Alle Digikoppeling webservices moeten conformeren aan deze Digikoppeling beveiligingsstandaarden en voorschriften. Deze wordt in dit document gespecificeerd.</p>
<p>Doel van dit document is ontwikkelaars te informeren wat deze beveiligingsvoorschriften precies inhouden, welke standaarden en welke versies toegestaan zijn en partijen zich aan moeten conformeren.</p>
</section><section id="digikoppeling"><div class="header-wrapper"><h3 id="x1-2-digikoppeling"><bdi class="secno">1.2 </bdi>Digikoppeling</h3><a class="self-link" href="#digikoppeling" aria-label="Permalink for Section 1.2"></a></div>
<p>Deze paragraaf bevat zeer beknopt een aantal hoofdpunten uit de overige documentatie.</p>
<p>Digikoppeling biedt de mogelijkheid om op een sterk gestandaardiseerde wijze berichten uit te wisselen tussen serviceaanbieders (service providers) en serviceafnemers (service requesters of consumers).</p>
<p>De uitwisseling tussen service providers en requesters wordt in drie lagen opgedeeld:</p>
<ul>
<li><p>Inhoud: op deze laag worden de afspraken gemaakt over de inhoud van het uit te wisselen bericht, dus de structuur, semantiek, waardebereiken etc.<br>  Digikoppeling houdt zich niet met de inhoud bezig, ‘heeft geen boodschap aan de boodschap’.</p>
</li>
<li><p>Logistiek: op deze laag bevinden zich de afspraken betreffende transportprotocollen (HTTP &amp; TLS), messaging, beveiliging (authenticatie en encryptie) en betrouwbaarheid. Dit is de laag van Digikoppeling.</p>
</li>
<li><p>Transport: deze laag verzorgt het daadwerkelijke transport van het bericht (TCP/IP).</p>
</li>
</ul>
<p>Digikoppeling richt zich dus uitsluitend op de logistieke laag. Deze afspraken komen in de koppelvlakstandaarden en andere voorzieningen.</p>
<p>De koppelvlakstandaarden dienen te leiden tot een maximum aan interoperabiliteit met een minimum aan benodigde ontwikkelinspanning. Daarom is gekozen voor bewezen interoperabele internationale standaarden.</p>
</section><section id="digikoppeling-standaarden"><div class="header-wrapper"><h3 id="x1-3-digikoppeling-standaarden"><bdi class="secno">1.3 </bdi>Digikoppeling standaarden</h3><a class="self-link" href="#digikoppeling-standaarden" aria-label="Permalink for Section 1.3"></a></div>
<p>De documentatie is als volgt opgebouwd:</p>
<figure id="fig-opbouw-documentatie-digikoppeling">
  <object data="https://logius-standaarden.github.io/publicatie/dk/actueel/media/DK_Specificatie_structuur.svg" type="image/svg+xml" id="infographic">Overzicht van de onderdelen van de Digikoppeling Standaard, de standaard is onderverdeeld in normatieve en ondersteunende onderdelen</object>
  <figcaption><a class="self-link" href="#fig-opbouw-documentatie-digikoppeling">Figuur <bdi class="figno">1</bdi></a> <span class="fig-title">Opbouw documentatie Digikoppeling</span></figcaption>
</figure>

<p><b>Legenda</b></p>
<table class="legendum">
    <thead>
        <tr>
            <th><strong>Kleur</strong></th>
            <th><strong>Soort Document</strong></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="green">Groen</td>
            <td>Standaard documentatie</td>
        </tr>
        <tr>
            <td class="grey">Grijs</td>
            <td>Ondersteunende documentatie</td>
        </tr>
    </tbody>
</table>


<p><b>Beheer</b></p>
<ul>
<li><p>De standaarddocumenten (groen/vierkant aangegeven) vallen onder het beheer zoals geformaliseerd in het document <cite><a data-matched-text="[[[?DK-Beheermodel]]]" href="https://gitdocumentatie.logius.nl/publicatie/dk/beheer/">Digikoppeling Beheermodel</a></cite>.</p>
</li>
<li><p>De ondersteunende documentatie wordt onderhouden door Logius als de beheerder van de standaard (en afgestemd met stakeholders/ gebruikers).</p>
</li>
<li><p>Alle goedgekeurde documenten zijn te vinden op de website van Logius, <a href="https://www.logius.nl/onze-dienstverlening/domeinen/gegevensuitwisseling/digikoppeling">www.logius.nl</a>.</p>
</li>
</ul>
</section></section>
  <section id="identificatie"><div class="header-wrapper"><h2 id="x2-identificatie"><bdi class="secno">2. </bdi>Identificatie</h2><a class="self-link" href="#identificatie" aria-label="Permalink for Section 2."></a></div>
<section id="wat-is-identificatie"><div class="header-wrapper"><h3 id="x2-1-wat-is-identificatie"><bdi class="secno">2.1 </bdi>Wat is identificatie?</h3><a class="self-link" href="#wat-is-identificatie" aria-label="Permalink for Section 2.1"></a></div>
<p>Een goede beveiliging van het berichtenverkeer begint met de identificatie van de partijen en de systemen waarmee zij berichten met elkaar uitwisselen. Identificatie houdt in dat de identiteit van de niet-natuurlijke persoon (organisatie) met grote zekerheid wordt vastgesteld.</p>
<p>De Digikoppeling standaarden schrijven voor hoe de berichtuitwisseling tussen systemen van verschillende organisaties plaats moet vinden. Deze organisaties en systemen worden geauthenticeerd aan de hand van een PKIoverheid certificaat met daarin een uniek identificerend nummer, het OIN.</p>
</section><section id="identificerend-nummer"><div class="header-wrapper"><h3 id="x2-2-identificerend-nummer"><bdi class="secno">2.2 </bdi>Identificerend nummer</h3><a class="self-link" href="#identificerend-nummer" aria-label="Permalink for Section 2.2"></a></div>
<p>Het organisatie identificatienummer (OIN) is het identificerende nummer voor organisaties die gebruik maken van Digikoppeling. De partijen identificeren elkaar op basis van dit nummer.</p>
<p>De bron voor identificatie van organisaties is een erkend register dat is opgenomen in het OIN beleid. In de meeste gevallen is dit het Handelsregister. Het OIN kan worden opgezocht in het OIN Register.</p>
<p>Zie <cite><a data-matched-text="[[[?DK-IDAuth]]]" href="https://gitdocumentatie.logius.nl/publicatie/dk/idauth/">Digikoppeling Identificatie en Authenticatie</a></cite> voor meer informatie.</p>
<p>Het OIN register is bereikbaar via het <cite><a data-matched-text="[[[DK-Portaal]]]" href="https://oinregister.logius.nl/">Digikoppeling Portaal</a></cite>.</p>
</section></section>
  <section id="pkioverheid-certificaten"><div class="header-wrapper"><h2 id="x3-pkioverheid-certificaten"><bdi class="secno">3. </bdi>PKIoverheid certificaten</h2><a class="self-link" href="#pkioverheid-certificaten" aria-label="Permalink for Section 3."></a></div>
<section id="standaarden"><div class="header-wrapper"><h3 id="x3-1-standaarden"><bdi class="secno">3.1 </bdi>Standaarden</h3><a class="self-link" href="#standaarden" aria-label="Permalink for Section 3.1"></a></div>
<table>
<thead>
<tr>
<th>Standaarden</th>
<th>Status</th>
<th>Genoemd in</th>
</tr>
</thead>
<tbody><tr>
<td>PKIoverheid certificaten &amp; CRL Profile</td>
<td>Verplicht</td>
<td><cite><a data-matched-text="[[[PKIO-PvE]]]" href="https://cp.pkioverheid.nl/">Certificate Policy/Programme of Requirements PKIoverheid</a></cite>, [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3447" title="Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1">rfc3447</a></cite>]</td>
</tr>
</tbody></table>
</section><section id="wat-is-pkioverheid"><div class="header-wrapper"><h3 id="x3-2-wat-is-pkioverheid"><bdi class="secno">3.2 </bdi>Wat is PKIoverheid?</h3><a class="self-link" href="#wat-is-pkioverheid" aria-label="Permalink for Section 3.2"></a></div>
<section id="pkioverheid"><div class="header-wrapper"><h4 id="x3-2-1-pkioverheid"><bdi class="secno">3.2.1 </bdi>PKIoverheid</h4><a class="self-link" href="#pkioverheid" aria-label="Permalink for Section 3.2.1"></a></div>
<p>PKIoverheid is de public key infrastructure in Nederland waarmee PKIoverheid certificaten worden uitgegeven en toegepast conform afspraken die zijn vastgelegd in het PKIoverheid Programme of Requirements.</p>
<p>Zie ook het document <cite><a data-matched-text="[[[?DK-gbachtcert]]]" href="https://gitdocumentatie.logius.nl/publicatie/dk/ebms/">Digikoppeling Koppelvlakstandaard ebMS2</a></cite> en <cite><a data-matched-text="[[[?PKIoverheid]]]" href="https://www.logius.nl/domeinen/toegang/pkioverheid">PKIoverheid</a></cite></p>
</section><section id="pkioverheid-certificaat"><div class="header-wrapper"><h4 id="x3-2-2-pkioverheid-certificaat"><bdi class="secno">3.2.2 </bdi>PKIoverheid certificaat</h4><a class="self-link" href="#pkioverheid-certificaat" aria-label="Permalink for Section 3.2.2"></a></div>
<p>Het PKIoverheid-certificaat is een computerbestand dat werkt als een digitaal paspoort. Als iemand een website, e-mail of document van uw organisatie wil bekijken, controleert zijn webbrowser of e-mailprogramma het bijbehorende certificaat. Door elkaar te identificeren verkleint de kans dat oplichters zich voor kunnen doen als iemand anders. Digitale certificaten waarborgen dus betrouwbaarheid [<cite><a class="bibref" data-link-type="biblio" href="#bib-pkioverheid" title="PKIoverheid">PKIoverheid</a></cite>].</p>
<p>Digikoppeling vereist dat de communicatiepartners PKIoverheid private root certificaten gebruiken met een OIN om op een vertrouwelijke wijze gegevens uit te wisselen.</p>
</section></section><section id="voorschriften"><div class="header-wrapper"><h3 id="x3-3-voorschriften"><bdi class="secno">3.3 </bdi>Voorschriften</h3><a class="self-link" href="#voorschriften" aria-label="Permalink for Section 3.3"></a></div>
<section id="digikoppeling-voorschriften"><div class="header-wrapper"><h4 id="x3-3-1-digikoppeling-voorschriften"><bdi class="secno">3.3.1 </bdi>Digikoppeling voorschriften</h4><a class="self-link" href="#digikoppeling-voorschriften" aria-label="Permalink for Section 3.3.1"></a></div>
<table>
<thead>
<tr>
<th>Nr</th>
<th>Voorschrift</th>
<th>Toelichting</th>
</tr>
</thead>
<tbody><tr>
<td>PKI001</td>
<td>Gebruik OIN in <code>subject:serialNumber</code> veld is verplicht</td>
<td>Dit is afgesproken met de TSP's in de Digikoppeling Overeenkomsten. Zij verstrekken PKIoverheid certificaten met het OIN in het <code>subject:serialNumber</code> field conform de OIN systematiek als het een certificaat betreft dat voor Digikoppeling wordt gebruikt. [<cite><a class="bibref" data-link-type="biblio" href="#bib-pki-ca" title="Aansluiten als Trust Service Provider">PKI-CA</a></cite>]</td>
</tr>
<tr>
<td>PKI002</td>
<td>PKIoverheid certificaat moet geldig zijn (het mag niet zijn verlopen of ingetrokken).</td>
<td></td>
</tr>
<tr>
<td>PKI003<br>(WT004)</td>
<td>De geldigheid van het certificaat wordt getoetst met betrekking tot de geldigheidsdatum en de Certificate Revocation List(CRL) die voldoet aan de eisen van PKIoverheid.</td>
<td></td>
</tr>
<tr>
<td>PKI004<br>(WT005)</td>
<td>De betreffende CRL dient zowel voor de versturende als ontvangende partij te benaderen zijn.</td>
<td></td>
</tr>
<tr>
<td>PKI005</td>
<td>Het certificaat moet zijn van het type PKIoverheid private root (PKI Staat der Nederlanden Private Root) <br>Voor Serviceaanbieders  en Servicegebruikers geldt dat zij vanaf 1-1-2021 gebruik moeten maken van private root certificaten</td>
<td>PKIoverheid geeft aan dat voor machine-naar-machine (M2M) verkeer (zoals Digikoppeling) Private root certificaten gebruikt dienen te worden.</td>
</tr>
</tbody></table>
</section><section id="pkioverheid-programme-of-requirements"><div class="header-wrapper"><h4 id="x3-3-2-pkioverheid-programme-of-requirements"><bdi class="secno">3.3.2 </bdi>PKIoverheid Programme of Requirements</h4><a class="self-link" href="#pkioverheid-programme-of-requirements" aria-label="Permalink for Section 3.3.2"></a></div>
<ol>
<li><p>Een PKIoverheid certificaat dient conform de eisen van het PKIoverheid PvE te worden uitgegeven door de Trust Service Providers (TSP).</p>
</li>
<li><p>De te gebruiken certificaten in de productie omgeving voldoen aan de eisen van PKIoverheid (PvE) en de inhoud van de identificerende velden in het certificaat dienen te voldoen aan de afspraken zoals gesteld in de functionele eisen in het document <cite><a data-matched-text="[[[?DK-IDAuth]]]" href="https://gitdocumentatie.logius.nl/publicatie/dk/idauth/">Digikoppeling Identificatie en Authenticatie</a></cite>. Met het toepassen van PKIoverheid-certificaten die Digikoppeling compliant zijn, wordt hieraan voldaan.</p>
</li>
<li><p>Certificaten voor productie wijken af van certificaten voor test doordat zij onder een andere 'root' zijn uitgegeven, respectievelijk 'Staat der Nederlanden' (productie) en 'TRIAL PKIoverheid' (test). Deze zijn te vinden op <a href="https://cert.pkioverheid.nl">https://cert.pkioverheid.nl</a>.</p>
</li>
</ol>
</section><section id="geldigheid"><div class="header-wrapper"><h4 id="x3-3-3-geldigheid"><bdi class="secno">3.3.3 </bdi>Geldigheid</h4><a class="self-link" href="#geldigheid" aria-label="Permalink for Section 3.3.3"></a></div>
<p>De geldigheid van het certificaat wordt getoetst met betrekking tot de geldigheidsdatum en de Certificate Revocation List (CRL) die voldoet aan de eisen van PKIoverheid. Zie eis PKI002 en PKI003. </p>
<p>De betreffende CRL dient zowel voor de versturende als ontvangende partij te benaderen zijn. Zie eis PKI004 (WT005)</p>
<p>Een certificaat dient te worden ingetrokken als de organisatie niet meer bestaat of als de private sleutel gecompromitteerd is.</p>
</section></section><section id="best-practices"><div class="header-wrapper"><h3 id="x3-4-best-practices"><bdi class="secno">3.4 </bdi>Best practices</h3><a class="self-link" href="#best-practices" aria-label="Permalink for Section 3.4"></a></div>
<p>De best practices voor inrichting en gebruik zijn beschreven in <em>Gebruik en achtergronden Digikoppeling certificaten</em>.</p>
</section></section>
  <section id="tls-transport-layer-security"><div class="header-wrapper"><h2 id="x4-tls-transport-layer-security"><bdi class="secno">4. </bdi>TLS (Transport Layer Security)</h2><a class="self-link" href="#tls-transport-layer-security" aria-label="Permalink for Section 4."></a></div>
<p>Transport Layer Security (TLS) is een protocol dat een veilige versleutelde verbinding legt tussen systemen waardoor gegevens vertrouwelijk en compleet wordt uitgewisseld. Binnen de context van Digikoppeling verplicht TLS het gebruik van wederzijde authenticatie van de betrokken partijen, zodat alleen geautoriseerde systemen kunnen communiceren met elkaar.</p>
<section id="standaarden-0"><div class="header-wrapper"><h3 id="x4-1-standaarden"><bdi class="secno">4.1 </bdi>Standaarden</h3><a class="self-link" href="#standaarden-0" aria-label="Permalink for Section 4.1"></a></div>
<table>
<thead>
<tr>
<th>Standaarden</th>
<th>Status</th>
<th>Bron</th>
</tr>
</thead>
<tbody><tr>
<td>TLS 1.2 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5246" title="The Transport Layer Security (TLS) Protocol Version 1.2">rfc5246</a></cite>]</td>
<td>Verplicht</td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-ncsc 2025" title="Transport Layer Security (TLS) richtlijnen 2025-05">NCSC 2025</a></cite>]</td>
</tr>
<tr>
<td>TLS 1.3 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8446" title="The Transport Layer Security (TLS) Protocol Version 1.3">rfc8446</a></cite>]</td>
<td>Zeer aanbevolen</td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-ncsc 2025" title="Transport Layer Security (TLS) richtlijnen 2025-05">NCSC 2025</a></cite>]</td>
</tr>
<tr>
<td>HTTP over TLS Transport Layer Security<br>([<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2818" title="HTTP Over TLS">rfc2818</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5785" title="Defining Well-Known Uniform Resource Identifiers (URIs)">rfc5785</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7230" title="Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing">rfc7230</a></cite>])</td>
<td>Informational</td>
<td>IETF [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5322" title="Internet Message Format">rfc5322</a></cite>]</td>
</tr>
</tbody></table>
</section><section id="digikoppeling-voorschriften-0"><div class="header-wrapper"><h3 id="x4-2-digikoppeling-voorschriften"><bdi class="secno">4.2 </bdi>Digikoppeling voorschriften</h3><a class="self-link" href="#digikoppeling-voorschriften-0" aria-label="Permalink for Section 4.2"></a></div>
<table>
<thead>
<tr>
<th>Nr</th>
<th>Voorschrift</th>
<th>Toelichting</th>
</tr>
</thead>
<tbody><tr>
<td>TLS001</td>
<td>Authenticatie is verplicht met TLS en PKIoverheid certificaten</td>
<td></td>
</tr>
<tr>
<td>TLS002</td>
<td>Tweezijdig TLS is verplicht</td>
<td>Digikoppeling schrijft het gebruik van twee-zijdig TLS voor en verplicht dit voor alle vormen van berichtuitwisseling via Digikoppeling.</td>
</tr>
<tr>
<td>TLS003</td>
<td>De TLS implementatie mag niet op SSL v3 en eerdere versies terugvallen</td>
<td>Backward compatibility mode voor SSL v3 en eerdere versies dient te worden uitgezet.</td>
</tr>
<tr>
<td>TLS004</td>
<td>Een Serviceaanbieder is <span class="underline">verplicht</span> TLS versie 1.2 te ondersteunen, daarnaast is het <span class="underline">aanbevolen</span> voor een Serviceaanbieder om TLS versie 1.3 te ondersteunen.  Als een Serviceaanbieder TLS versie 1.3 aanbiedt dan is het aanbevolen voor Serviceafnemers om TLS 1.3 te gebruiken</td>
<td>NCSC geeft aan: “Configureer het gebruik van TLS 1.2 ter ondersteuning van oudere clients, maar geef de voorkeur aan TLS 1.3 waar mogelijk [6]. Andere versies zijn niet veilig in het gebruik.” Zie [<cite><a class="bibref" data-link-type="biblio" href="#bib-ncsc 2025" title="Transport Layer Security (TLS) richtlijnen 2025-05">NCSC 2025</a></cite>]</td>
</tr>
<tr>
<td>TLS004</td>
<td>Een Serviceaanbieder is <span class="underline">verplicht</span> TLS versie 1.2 te ondersteunen, daarnaast is het <span class="underline">aanbevolen</span> voor een Serviceaanbieder om TLS versie 1.3 te ondersteunen.  Als een Serviceaanbieder TLS versie 1.3 aanbiedt dan is het aanbevolen voor Serviceafnemers om TLS 1.3 te gebruiken</td>
<td>NCSC geeft aan: “Configureer het gebruik van TLS 1.2 ter ondersteuning van oudere clients, maar geef de voorkeur aan TLS 1.3 waar mogelijk [6]. Andere versies zijn niet veilig in het gebruik.” Zie [<cite><a class="bibref" data-link-type="biblio" href="#bib-ncsc 2025" title="Transport Layer Security (TLS) richtlijnen 2025-05">NCSC 2025</a></cite>]</td>
</tr>
<tr>
<td></td>
<td>TLS 1.0 en TLS 1.1 zijn niet meer toegestaan</td>
<td>Niet meer toegestaan binnen de Digikoppeling standaard vanaf 10-9-2016</td>
</tr>
<tr>
<td>TLS005</td>
<td>Het is verplicht voor communicatie over HTTPS port 443 te gebruiken</td>
<td>Port 443 is de standaard poort voor HTTPS verkeer</td>
</tr>
<tr>
<td>TLS006</td>
<td>Het is verplicht te voldoen aan de NCSC ICT-beveiligingsrichtlijnen voor TLS</td>
<td>Zie [<cite><a class="bibref" data-link-type="biblio" href="#bib-ncsc 2025" title="Transport Layer Security (TLS) richtlijnen 2025-05">NCSC 2025</a></cite>]</td>
</tr>
<tr>
<td>TLS006</td>
<td>Het is verplicht te voldoen aan de NCSC ICT-beveiligingsrichtlijnen voor TLS</td>
<td>Zie [<cite><a class="bibref" data-link-type="biblio" href="#bib-ncsc 2025" title="Transport Layer Security (TLS) richtlijnen 2025-05">NCSC 2025</a></cite>]</td>
</tr>
</tbody></table>
</section><section id="onderbouwing"><div class="header-wrapper"><h3 id="x4-3-onderbouwing"><bdi class="secno">4.3 </bdi>Onderbouwing</h3><a class="self-link" href="#onderbouwing" aria-label="Permalink for Section 4.3"></a></div>
<p>Zowel de Digikoppeling-koppelvlakstandaard ebMS2 als de Digikoppeling-koppelvlakstandaard WUS en Digikopppeling-koppelvlakstandaard Grote Berichten schrijven het gebruik voor van (tweezijdig) TLS om de berichtenstroom te beveiligen. Het protocol TLS heeft betrekking op het communicatiekanaal. De Digikoppeling-koppelvlakstandaarden stellen deze eis dus aan de transportlaag en aan de authenticatie van organisaties.</p>
<p>In Digikoppeling is ervoor gekozen om PKIoverheid certificaten te gebruiken op het niveau van het communicatiekanaal (TLS) om de directe communicatiepartners te authenticeren. TLS kan niet toegepast worden om end-to-end authenticatie uit te voeren in een multi-hop (voor ebMS2) omgeving; zie daarvoor berichtniveau beveiliging in de <cite><a data-matched-text="[[[?DK-Architectuur]]]" href="https://gitdocumentatie.logius.nl/publicatie/dk/architectuur/">Digikoppeling Architectuur</a></cite> documentatie.</p>
</section><section id="overwegingen"><div class="header-wrapper"><h3 id="x4-4-overwegingen"><bdi class="secno">4.4 </bdi>Overwegingen</h3><a class="self-link" href="#overwegingen" aria-label="Permalink for Section 4.4"></a></div>
<p>Het NCSC adviseert om TLS altijd te configureren op basis van [<cite><a class="bibref" data-link-type="biblio" href="#bib-ncsc 2025" title="Transport Layer Security (TLS) richtlijnen 2025-05">NCSC 2025</a></cite>] voor Transport Layer Security.
Het NCSC adviseert om TLS altijd te configureren op basis van [<cite><a class="bibref" data-link-type="biblio" href="#bib-ncsc 2025" title="Transport Layer Security (TLS) richtlijnen 2025-05">NCSC 2025</a></cite>] voor Transport Layer Security.</p>
</section></section>
  <section id="cipher-suites-voor-tls-signing-en-encryptie"><div class="header-wrapper"><h2 id="x5-cipher-suites-voor-tls-signing-en-encryptie"><bdi class="secno">5. </bdi>Cipher suites voor TLS, signing en encryptie</h2><a class="self-link" href="#cipher-suites-voor-tls-signing-en-encryptie" aria-label="Permalink for Section 5."></a></div>
<section id="tls-ciphersuites"><div class="header-wrapper"><h3 id="x5-1-tls-ciphersuites"><bdi class="secno">5.1 </bdi>TLS Ciphersuites</h3><a class="self-link" href="#tls-ciphersuites" aria-label="Permalink for Section 5.1"></a></div>
<table>
<thead>
<tr>
<th>Nr</th>
<th>Voorschrift</th>
<th>Toelichting</th>
</tr>
</thead>
<tbody><tr>
<td>TLSCIPH001</td>
<td>De gebruikte TLS cryptografische algoritmen moeten de NCSC classificatie ‘voldoende’ of ‘goed’ hebben. TLS-cryptografische algoritmen die de NCSC-classificatie ‘uit te faseren’ hebben, zijn sinds 1 januari 2021 niet meer toegestaan.</td>
<td>Zie  [<cite><a class="bibref" data-link-type="biblio" href="#bib-ncsc 2025" title="Transport Layer Security (TLS) richtlijnen 2025-05">NCSC 2025</a></cite>]</td>
</tr>
<tr>
<td>TLSCIPH001</td>
<td>De gebruikte TLS cryptografische algoritmen moeten de NCSC classificatie ‘voldoende’ of ‘goed’ hebben. TLS-cryptografische algoritmen die de NCSC-classificatie ‘uit te faseren’ hebben, zijn sinds 1 januari 2021 niet meer toegestaan.</td>
<td>Zie  [<cite><a class="bibref" data-link-type="biblio" href="#bib-ncsc 2025" title="Transport Layer Security (TLS) richtlijnen 2025-05">NCSC 2025</a></cite>]</td>
</tr>
</tbody></table>
</section><section id="xml-signing"><div class="header-wrapper"><h3 id="x5-2-xml-signing"><bdi class="secno">5.2 </bdi>XML Signing</h3><a class="self-link" href="#xml-signing" aria-label="Permalink for Section 5.2"></a></div>
<section id="digikoppeling-voorschriften-voor-xml-signing"><div class="header-wrapper"><h4 id="x5-2-1-digikoppeling-voorschriften-voor-xml-signing"><bdi class="secno">5.2.1 </bdi>Digikoppeling voorschriften voor XML signing</h4><a class="self-link" href="#digikoppeling-voorschriften-voor-xml-signing" aria-label="Permalink for Section 5.2.1"></a></div>
<table>
<thead>
<tr>
<th>Nr</th>
<th>Voorschrift</th>
<th>Toelichting</th>
</tr>
</thead>
<tbody><tr>
<td>SIGN001</td>
<td>Signing met SHA-2 is verplicht.</td>
<td>Minimaal SHA-256.</td>
</tr>
<tr>
<td>SIGN002</td>
<td>Signing conform XMLDSIG is verplicht</td>
<td>Zie de koppelvlakstandaarden signed profielen</td>
</tr>
<tr>
<td>SIGN003</td>
<td>Het DigestMethod Algorithm moet gebruik maken van een van de volgende algoritmen: SHA-256, SHA-384, SHA-512 [<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlenc-core" title="XML Encryption Syntax and Processing">xmlenc-core</a></cite>], <cite><a data-matched-text="[[[FIPS-180-4]]]" href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">FIPS PUB 180-4: Secure Hash Standard (SHS)</a></cite></td>
<td>Zie ook <a href="https://www.w3.org/TR/xmldsig-core1/#sec-DigestMethod">https://www.w3.org/TR/xmldsig-core1/#sec-DigestMethod</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-xmldsig-core1" title="XML Signature Syntax and Processing Version 1.1">xmldsig-core1</a></cite>]</td>
</tr>
<tr>
<td>SIGN004</td>
<td>Het SignatureMethod Algorithm kan gebruik maken van een van de volgende algoritmen: [SHA-256] [SHA-384] [SHA-512]</td>
<td>Zie ook <a href="https://www.w3.org/TR/xmldsig-core1/#sec-DigestMethod">https://www.w3.org/TR/xmldsig-core1/#sec-DigestMethod</a> voor voorbeelden</td>
</tr>
</tbody></table>
</section><section id="reden-voor-vervanging-sha-1-door-sha-2"><div class="header-wrapper"><h4 id="x5-2-2-reden-voor-vervanging-sha-1-door-sha-2"><bdi class="secno">5.2.2 </bdi>Reden voor vervanging SHA-1 door SHA-2</h4><a class="self-link" href="#reden-voor-vervanging-sha-1-door-sha-2" aria-label="Permalink for Section 5.2.2"></a></div>
<p><em>Certificaten met SHA-1 als hashfunctie worden vervangen door certificaten met hashfuncties uit de SHA-2-familie: SHA-256, SHA-384 en SHA-512. Certificaten met MD5 als hashfunctie zijn enkele jaren geleden al vervangen. MD5 is de voorloper van SHA-1. [<cite><a class="bibref" data-link-type="biblio" href="#bib-https-factsheet ncsc" title="Factsheet HTTPS kan een stuk veiliger">HTTPS-factsheet NCSC</a></cite>]</em></p>
<p>PKIoverheid stelt SHA-2 als eis. Alle certificaten die onder de root Staat der Nederlanden worden uitgegeven moeten voldoen aan SHA-2. 
PKIoverheid stelt SHA-2 als eis. Alle certificaten die onder de root Staat der Nederlanden worden uitgegeven moeten voldoen aan SHA-2. </p>
<p>In plaats daarvan is het dus wenselijk om gebruik te maken van een algoritme dat als ‘goed’ is aangemerkt, dus:</p>
<ul>
<li><p>SHA-512,</p>
</li>
<li><p>SHA-384 of</p>
</li>
<li><p>SHA-256</p>
</li>
</ul>
</section></section><section id="xml-encryptie"><div class="header-wrapper"><h3 id="x5-3-xml-encryptie"><bdi class="secno">5.3 </bdi>XML Encryptie</h3><a class="self-link" href="#xml-encryptie" aria-label="Permalink for Section 5.3"></a></div>
<section id="digikoppeling-voorschriften-voor-payload-encryptie"><div class="header-wrapper"><h4 id="x5-3-1-digikoppeling-voorschriften-voor-payload-encryptie"><bdi class="secno">5.3.1 </bdi>Digikoppeling voorschriften voor payload encryptie</h4><a class="self-link" href="#digikoppeling-voorschriften-voor-payload-encryptie" aria-label="Permalink for Section 5.3.1"></a></div>
<table>
<thead>
<tr>
<th>Nr</th>
<th>Voorschrift</th>
<th>Toelichting</th>
</tr>
</thead>
<tbody><tr>
<td>ENC001</td>
<td>Indien er gebruik wordt gemaakt van XML encryption op payload niveau dient de FIPS 197 standaard (AES) te worden gebruikt.</td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-aes" title="NIST FIPS 197: Advanced Encryption Standard (AES)">AES</a></cite>]</td>
</tr>
<tr>
<td>ENC002</td>
<td>Encryptie conform XML versleuteling [<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlenc-core" title="XML Encryption Syntax and Processing">xmlenc-core</a></cite>] is verplicht</td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlenc-core" title="XML Encryption Syntax and Processing">xmlenc-core</a></cite>]</td>
</tr>
<tr>
<td>ENC003</td>
<td>De ondersteunde data encryption (data versleuteling) algoritmen zijn: <em>3DES(*)</em> AES128 AES256</td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlenc-core" title="XML Encryption Syntax and Processing">xmlenc-core</a></cite>]  (Gebruik GCM mode) <br><br>(*) 3DES-encryptie verouderd: Niet gebruiken.<br> 3DES-decryptie toegestaan voor legacy applicaties;</td>
</tr>
<tr>
<td>ENC004</td>
<td>Het Key transport algorithm maakt gebruik van de RSA-OAEP algoritmen.</td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5756" title="Updates for RSAES-OAEP and RSASSA-PSS Algorithm Parameters">rfc5756</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlenc-core" title="XML Encryption Syntax and Processing">xmlenc-core</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5756" title="Updates for RSAES-OAEP and RSASSA-PSS Algorithm Parameters">rfc5756</a></cite>]</td>
</tr>
</tbody></table>
</section></section></section>
  
  <section id="tof">
  <div class="header-wrapper"><h2 id="x6-lijst-met-figuren"><bdi class="secno">6. </bdi>Lijst met figuren</h2><a class="self-link" href="#tof" aria-label="Permalink for Section 6."></a></div><ul class="tof">
        <li class="tofline">
    <a class="tocxref" href="#fig-opbouw-documentatie-digikoppeling"><span class="self-link">Figuur <bdi class="figno">1</bdi></span> <span class="fig-title">Opbouw documentatie Digikoppeling</span></a>
  </li>
      </ul></section>
 

<section id="references" class="appendix"><div class="header-wrapper"><h2 id="a-referenties"><bdi class="secno">A. </bdi>Referenties</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix A."></a></div><section id="normatieve-referenties">
    <div class="header-wrapper"><h3 id="a-1-normatieve-referenties"><bdi class="secno">A.1 </bdi>Normatieve referenties</h3><a class="self-link" href="#normatieve-referenties" aria-label="Permalink for Appendix A.1"></a></div>
    <dl class="bibliography"><dt id="bib-aes">[AES]</dt><dd>
      <a href="https://csrc.nist.gov/publications/fips/fips197/fips-197.pdf"><cite>NIST FIPS 197: Advanced Encryption Standard (AES)</cite></a>. November 2001. URL: <a href="https://csrc.nist.gov/publications/fips/fips197/fips-197.pdf">https://csrc.nist.gov/publications/fips/fips197/fips-197.pdf</a>
    </dd><dt id="bib-dk-portaal">[DK-Portaal]</dt><dd>
      <a href="https://oinregister.logius.nl/"><cite>Digikoppeling Portaal</cite></a>.  Logius. URL: <a href="https://oinregister.logius.nl/">https://oinregister.logius.nl/</a>
    </dd><dt id="bib-fips-180-4">[FIPS-180-4]</dt><dd>
      <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf"><cite>FIPS PUB 180-4: Secure Hash Standard (SHS)</cite></a>.  U.S. Department of Commerce/National Institute of Standards and Technology. August 2015. National Standard. URL: <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>
    </dd><dt id="bib-https-factsheet ncsc">[HTTPS-factsheet NCSC]</dt><dd>
      <a href="https://www.ncsc.nl/documenten/factsheets/2019/juni/01/factsheet-https-kan-een-stuk-veiliger"><cite>Factsheet HTTPS kan een stuk veiliger</cite></a>.  NCSC. Nov 2014. URL: <a href="https://www.ncsc.nl/documenten/factsheets/2019/juni/01/factsheet-https-kan-een-stuk-veiliger">https://www.ncsc.nl/documenten/factsheets/2019/juni/01/factsheet-https-kan-een-stuk-veiliger</a>
    </dd><dt id="bib-ncsc 2025">[NCSC 2025]</dt><dd>
      <a href="https://www.ncsc.nl/wat-kun-je-zelf-doen/documenten/publicaties/2025/juni/01/ict-beveiligingsrichtlijnen-voor-transport-layer-security-2025-05"><cite>Transport Layer Security (TLS) richtlijnen 2025-05</cite></a>.  NCSC. June 2025. URL: <a href="https://www.ncsc.nl/wat-kun-je-zelf-doen/documenten/publicaties/2025/juni/01/ict-beveiligingsrichtlijnen-voor-transport-layer-security-2025-05">https://www.ncsc.nl/wat-kun-je-zelf-doen/documenten/publicaties/2025/juni/01/ict-beveiligingsrichtlijnen-voor-transport-layer-security-2025-05</a>
    </dd><dt id="bib-pki-ca">[PKI-CA]</dt><dd>
      <a href="https://www.logius.nl/domeinen/toegang/aansluiten-als-trust-service-provider"><cite>Aansluiten als Trust Service Provider</cite></a>.  Logius. URL: <a href="https://www.logius.nl/domeinen/toegang/aansluiten-als-trust-service-provider">https://www.logius.nl/domeinen/toegang/aansluiten-als-trust-service-provider</a>
    </dd><dt id="bib-pkio-pve">[PKIO-PvE]</dt><dd>
      <a href="https://cp.pkioverheid.nl/"><cite>Certificate Policy/Programme of Requirements PKIoverheid</cite></a>.  Logius. URL: <a href="https://cp.pkioverheid.nl/">https://cp.pkioverheid.nl/</a>
    </dd><dt id="bib-rfc2818">[rfc2818]</dt><dd>
      <a href="https://httpwg.org/specs/rfc2818.html"><cite>HTTP Over TLS</cite></a>. E. Rescorla.  IETF. May 2000. Informational. URL: <a href="https://httpwg.org/specs/rfc2818.html">https://httpwg.org/specs/rfc2818.html</a>
    </dd><dt id="bib-rfc3447">[rfc3447]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc3447"><cite>Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1</cite></a>. J. Jonsson; B. Kaliski.  IETF. February 2003. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc3447">https://www.rfc-editor.org/rfc/rfc3447</a>
    </dd><dt id="bib-rfc5246">[rfc5246]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc5246"><cite>The Transport Layer Security (TLS) Protocol Version 1.2</cite></a>. T. Dierks; E. Rescorla.  IETF. August 2008. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc5246">https://www.rfc-editor.org/rfc/rfc5246</a>
    </dd><dt id="bib-rfc5322">[rfc5322]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc5322"><cite>Internet Message Format</cite></a>. P. Resnick, Ed. IETF. October 2008. Draft Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc5322">https://www.rfc-editor.org/rfc/rfc5322</a>
    </dd><dt id="bib-rfc5756">[rfc5756]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc5756"><cite>Updates for RSAES-OAEP and RSASSA-PSS Algorithm Parameters</cite></a>. S. Turner; D. Brown; K. Yiu; R. Housley; T. Polk.  IETF. January 2010. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc5756">https://www.rfc-editor.org/rfc/rfc5756</a>
    </dd><dt id="bib-rfc5785">[rfc5785]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc5785"><cite>Defining Well-Known Uniform Resource Identifiers (URIs)</cite></a>. M. Nottingham; E. Hammer-Lahav.  IETF. April 2010. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc5785">https://www.rfc-editor.org/rfc/rfc5785</a>
    </dd><dt id="bib-rfc7230">[rfc7230]</dt><dd>
      <a href="https://httpwg.org/specs/rfc7230.html"><cite>Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</cite></a>. R. Fielding, Ed.; J. Reschke, Ed. IETF. June 2014. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc7230.html">https://httpwg.org/specs/rfc7230.html</a>
    </dd><dt id="bib-rfc8446">[rfc8446]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8446"><cite>The Transport Layer Security (TLS) Protocol Version 1.3</cite></a>. E. Rescorla.  IETF. August 2018. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>
    </dd><dt id="bib-xmldsig-core1">[xmldsig-core1]</dt><dd>
      <a href="https://www.w3.org/TR/xmldsig-core1/"><cite>XML Signature Syntax and Processing Version 1.1</cite></a>. Donald Eastlake; Joseph Reagle; David Solo; Frederick Hirsch; Magnus Nyström; Thomas Roessler; Kelvin Yiu.  W3C. 11 April 2013. W3C Recommendation. URL: <a href="https://www.w3.org/TR/xmldsig-core1/">https://www.w3.org/TR/xmldsig-core1/</a>
    </dd><dt id="bib-xmlenc-core">[xmlenc-core]</dt><dd>
      <a href="https://www.w3.org/TR/xmlenc-core/"><cite>XML Encryption Syntax and Processing</cite></a>. Donald Eastlake; Joseph Reagle.  W3C. 10 December 2002. W3C Recommendation. URL: <a href="https://www.w3.org/TR/xmlenc-core/">https://www.w3.org/TR/xmlenc-core/</a>
    </dd></dl>
  </section><section id="informatieve-referenties">
    <div class="header-wrapper"><h3 id="a-2-informatieve-referenties"><bdi class="secno">A.2 </bdi>Informatieve referenties</h3><a class="self-link" href="#informatieve-referenties" aria-label="Permalink for Appendix A.2"></a></div>
    <dl class="bibliography"><dt id="bib-dk-architectuur">[DK-Architectuur]</dt><dd>
      <a href="https://gitdocumentatie.logius.nl/publicatie/dk/architectuur/"><cite>Digikoppeling Architectuur</cite></a>.  Logius. URL: <a href="https://gitdocumentatie.logius.nl/publicatie/dk/architectuur/">https://gitdocumentatie.logius.nl/publicatie/dk/architectuur/</a>
    </dd><dt id="bib-dk-beheermodel">[DK-Beheermodel]</dt><dd>
      <a href="https://gitdocumentatie.logius.nl/publicatie/dk/beheer/"><cite>Digikoppeling Beheermodel</cite></a>.  Logius. URL: <a href="https://gitdocumentatie.logius.nl/publicatie/dk/beheer/">https://gitdocumentatie.logius.nl/publicatie/dk/beheer/</a>
    </dd><dt id="bib-dk-gbachtcert">[DK-gbachtcert]</dt><dd>
      <a href="https://gitdocumentatie.logius.nl/publicatie/dk/ebms/"><cite>Digikoppeling Koppelvlakstandaard ebMS2</cite></a>.  Logius. URL: <a href="https://gitdocumentatie.logius.nl/publicatie/dk/ebms/">https://gitdocumentatie.logius.nl/publicatie/dk/ebms/</a>
    </dd><dt id="bib-dk-idauth">[DK-IDAuth]</dt><dd>
      <a href="https://gitdocumentatie.logius.nl/publicatie/dk/idauth/"><cite>Digikoppeling Identificatie en Authenticatie</cite></a>.  Logius. URL: <a href="https://gitdocumentatie.logius.nl/publicatie/dk/idauth/">https://gitdocumentatie.logius.nl/publicatie/dk/idauth/</a>
    </dd><dt id="bib-ncsc 2021">[NCSC 2021]</dt><dd>
      <a href="https://www.ncsc.nl/documenten/publicaties/2021/januari/19/ict-beveiligingsrichtlijnen-voor-transport-layer-security-2.1"><cite>ICT-beveiligingsrichtlijnen voor Transport Layer Security (TLS) v2.1</cite></a>.  NCSC. Jan 2021. URL: <a href="https://www.ncsc.nl/documenten/publicaties/2021/januari/19/ict-beveiligingsrichtlijnen-voor-transport-layer-security-2.1">https://www.ncsc.nl/documenten/publicaties/2021/januari/19/ict-beveiligingsrichtlijnen-voor-transport-layer-security-2.1</a>
    </dd><dt id="bib-pkioverheid">[PKIoverheid]</dt><dd>
      <a href="https://www.logius.nl/domeinen/toegang/pkioverheid"><cite>PKIoverheid</cite></a>.  Logius. URL: <a href="https://www.logius.nl/domeinen/toegang/pkioverheid">https://www.logius.nl/domeinen/toegang/pkioverheid</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><div class="sidelabel">Logius Standaard - Consultatieversie</div><script src="https://gitdocumentatie.logius.nl/publicatie/respec/fixup.js"></script></body></html>
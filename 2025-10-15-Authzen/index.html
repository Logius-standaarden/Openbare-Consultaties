<!DOCTYPE html><html lang="en"><head>
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<meta name="generator" content="ReSpec 35.4.1">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-color:var(--warning-border,#f11);border-width:.2em;border-style:solid;background:#fbe9e9;background:var(--warning-bg,#fbe9e9);color:#000;color:var(--text,#000)}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;background:var(--indextable-hover-bg,#fff);color:#000;color:var(--text,#000);box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);box-shadow:0 1em 3em -.4em var(--tocsidebar-shadow,rgba(0,0,0,.3)),0 0 1px 1px var(--tocsidebar-shadow,rgba(0,0,0,.05));border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;border-bottom-color:var(--indextable-hover-bg,#fff);top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1;border-bottom-color:var(--indextable-hover-bg,#a2a9b1)}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;color:var(--text,#000);margin-top:.25em}
.dfn-panel ul a[href]{color:#333;color:var(--text,#333)}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
  
  
  
<meta name="color-scheme" content="light dark">
  
<title>NLGov Profile for OpenID AuthZEN Authorization API</title>
  
<link href="https://gitdocumentatie.logius.nl/publicatie/respec/style/logos/logius.ico" rel="shortcut icon" type="image/x-icon">
  
  
<style>

    .nlgov-add {
      background-color: lightgreen;
    }
    .nlgov-del {
      background-color: lightcoral;
      text-decoration: line-through;
    }
  
</style> 
 
<link id="nordvpn-contentScript-extension-fonts" rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato">
<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:italic}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline;position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-.7em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
<style id="respec-nlgov">
img.license{float:left;padding-right:5px;background:0 0}
</style>
<style>
ul.index{columns:30ch;column-gap:1.5em}
ul.index li{list-style:inherit}
ul.index li span{color:inherit;cursor:pointer;white-space:normal}
#index-defined-here ul.index li{font-size:.9rem}
ul.index code{color:inherit}
#index-defined-here .print-only{display:none}
@media print{
#index-defined-here .print-only{display:initial}
}
</style>
<meta name="description" content="The Authorization API enables Policy Decision Points (PDPs) and Policy Enforcement Points (PEPs) to communicate authorization requests and decisions to each other without requiring knowledge of each other's inner workings. The Authorization API is served by the PDP and is called by the PEP. The Authorization API includes evaluation endpoints, which provide specific access decisions, and search endpoints for discovering permissible subjects, resources, or actions.">
<style>
.hljs{--base:#fafafa;--mono-1:#383a42;--mono-2:#686b77;--mono-3:#717277;--hue-1:#0b76c5;--hue-2:#336ae3;--hue-3:#a626a4;--hue-4:#42803c;--hue-5:#ca4706;--hue-5-2:#c91243;--hue-6:#986801;--hue-6-2:#9a6a01}
@media (prefers-color-scheme:dark){
.hljs{--base:#282c34;--mono-1:#abb2bf;--mono-2:#818896;--mono-3:#5c6370;--hue-1:#56b6c2;--hue-2:#61aeee;--hue-3:#c678dd;--hue-4:#98c379;--hue-5:#e06c75;--hue-5-2:#be5046;--hue-6:#d19a66;--hue-6-2:#e6c07b}
}
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;color:var(--mono-1,#383a42);background:#fafafa;background:var(--base,#fafafa)}
.hljs-comment,.hljs-quote{color:#717277;color:var(--mono-3,#717277);font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4;color:var(--hue-3,#a626a4)}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;color:var(--hue-5,#ca4706);font-weight:700}
.hljs-literal{color:#0b76c5;color:var(--hue-1,#0b76c5)}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c;color:var(--hue-4,#42803c)}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01;color:var(--hue-6-2,#9a6a01)}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801;color:var(--hue-6,#986801)}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3;color:var(--hue-2,#336ae3)}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>

  .sidelabel {
    position: fixed;
    -webkit-transform-origin: top right;
    right: 100%;
    top: 0;
    -webkit-transform: rotate(-90deg);
    padding: 4px 50px 4px 10px;
    color: white;
    white-space: nowrap;
    z-index: 1;
    background-color: #000000;
  }
</style>
<script id="initialUserConfig" type="application/json">{
  "nl_organisationName": "Logius",
  "nl_organisationStylesURL": "https://gitdocumentatie.logius.nl/publicatie/respec/style/",
  "nl_organisationPublishURL": "https://gitdocumentatie.logius.nl/publicatie/",
  "logos": [
    {
      "src": "https://gitdocumentatie.logius.nl/publicatie/respec/style/logos/figure-logius.svg",
      "alt": "Logius",
      "id": "Logius",
      "height": 77,
      "width": 44,
      "url": "https://www.logius.nl/onze-dienstverlening/standaarden"
    }
  ],
  "useLogo": true,
  "fileName": "",
  "latestVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "shortName",
    "/",
    "fileName"
  ],
  "thisVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "shortName",
    "/",
    "publishVersion",
    "/",
    "fileName"
  ],
  "prevVersion": [],
  "addSectionLinks": true,
  "localizationStrings": {
    "en": {
      "wv": "Draft",
      "cv": "Consultation version",
      "vv": "Proposed version",
      "def": "Definitive version",
      "basis": "Document",
      "eo": "Outdated version",
      "tg": "Rescinded version",
      "no": "Norm",
      "st": "Standard",
      "im": "Information model",
      "pr": "Guideline",
      "hr": "Guide",
      "wa": "Proposed recommendation",
      "al": "General",
      "bd": "Governance documentation",
      "bp": "Best practice"
    },
    "nl": {
      "wv": "Werkversie",
      "cv": "Consultatieversie",
      "vv": "Versie ter vaststelling",
      "def": "Vastgestelde versie",
      "basis": "Document",
      "eo": "Verouderde versie",
      "tg": "Teruggetrokken versie",
      "no": "Norm",
      "st": "Standaard",
      "im": "Informatiemodel",
      "pr": "Praktijkrichtlijn",
      "hr": "Handreiking",
      "wa": "Werkafspraak",
      "al": "Algemeen",
      "bd": "Beheerdocumentatie",
      "bp": "Best practice"
    }
  },
  "sotdText": {
    "nl": {
      "sotd": "Status van dit document",
      "def": "Dit is de definitieve versie van dit document. Wijzigingen naar aanleiding van consultaties zijn doorgevoerd.",
      "wv": "Dit is een werkversie die op elk moment kan worden gewijzigd, verwijderd of vervangen door andere documenten. Het is geen door het TO goedgekeurde consultatieversie.",
      "cv": "Dit is een door het TO goedgekeurde consultatieversie. Commentaar over dit document kan gestuurd worden naar digikoppeling@logius.nl",
      "vv": "Dit is een definitief concept van de nieuwe versie van dit document. Wijzigingen naar aanleiding van consultaties zijn doorgevoerd.",
      "basis": "Dit is een document zonder officiële status."
    },
    "en": {
      "sotd": "Status of This Document",
      "def": "This is the definitive version of this document. Edits resulting from consultations have been applied.",
      "wv": "This is a draft that could be altered, removed or replaced by other documents. It is not a recommendation approved by TO.",
      "cv": "This is a proposed recommendation approved by TO. Comments regarding this document may be sent to api@logius.nl",
      "vv": "This is the definitive concept of this document. Edits resulting from consultations have been applied.",
      "basis": "This document has no official standing."
    }
  },
  "labelColor": {
    "def": "#154273",
    "wv": "#39870c",
    "cv": "#000000",
    "vv": "#000000"
  },
  "useLabel": true,
  "licenses": {
    "cc0": {
      "name": "Creative Commons 0 Public Domain Dedication",
      "short": "CC0",
      "url": "https://creativecommons.org/publicdomain/zero/1.0/",
      "image": "https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-zero.svg"
    },
    "cc-by": {
      "name": "Creative Commons Attribution 4.0 International Public License",
      "short": "CC-BY",
      "url": "https://creativecommons.org/licenses/by/4.0/legalcode",
      "image": "https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-by.svg"
    },
    "cc-by-nd": {
      "name": "Creative Commons Naamsvermelding-GeenAfgeleideWerken 4.0 Internationaal",
      "short": "CC-BY-ND",
      "url": "https://creativecommons.org/licenses/by-nd/4.0/legalcode.nl",
      "image": "https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-by-nd.svg"
    }
  },
  "license": "cc-by",
  "localBiblio": {
    "ADR": {
      "authors": [
        "Jasper Roes",
        "Joost Farla"
      ],
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/adr/2.0",
      "publisher": "Logius",
      "title": "API Design Rules",
      "id": "adr"
    },
    "ADR1": {
      "authors": [
        "Jasper Roes",
        "Joost Farla"
      ],
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/adr/1.0",
      "publisher": "Logius",
      "title": "API Design Rules"
    },
    "ADR-ext": {
      "authors": [
        "Jasper Roes",
        "Linda van den Brink"
      ],
      "date": "Januari 2020",
      "href": "https://docs.geostandaarden.nl/api/API-Strategie-ext",
      "publisher": "Geonovum/Kennisplatform APi's",
      "title": "API Designrules Extensions (Nederlandse API Strategie IIb)"
    },
    "Algemene Voorwaarden Logius": {
      "date": "12 juni 2018",
      "href": "https://www.logius.nl/onze-organisatie/zakendoen-met-logius/voorwaarden/algemene-voorwaarden-logius",
      "publisher": "Logius",
      "title": "Algemene voorwaarden Logius"
    },
    "AuthZEN": {
      "date": "6 September 2024 ",
      "href": "https://openid.net/specs/authorization-api-1_0-01.html",
      "publisher": "OpenID",
      "title": "Authorization API 1.0 – draft 01"
    },
    "AVG": {
      "date": "27 april 2016",
      "href": "https://eur-lex.europa.eu/legal-content/NL/TXT/?uri=CELEX%3A32016R0679",
      "publisher": "Verordening (EU) 2016/679 van het Europees Parlement",
      "title": "Algemene Verordening Gegevensbescherming"
    },
    "BCP195": {
      "authors": [
        "Y. Sheffer",
        "R. Holz",
        "P. Saint-Andre"
      ],
      "date": "May 2015",
      "href": "https://tools.ietf.org/html/bcp195",
      "publisher": "IETF",
      "title": "Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"
    },
    "DK-beveiliging": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/beveilig/",
      "publisher": "Logius",
      "title": "Digikoppeling Beveiligingsstandaarden en voorschriften"
    },
    "CloudEvents": {
      "authors": [
        "@@@"
      ],
      "date": "May 2011",
      "href": "https://github.com/cloudevents/spec/blob/v1.0.1/spec.md",
      "publisher": "@@@",
      "title": "CloudEvents - Version 1.0.1"
    },
    "NLGOV-CloudEvents": {
      "authors": [
        "Werkgroep Berichtenstandaard (Project Notificatieservices)"
      ],
      "href": "https://logius-standaarden.github.io/NL-GOV-profile-for-CloudEvents/",
      "publisher": "Logius",
      "title": "NL GOV profile for CloudEvents"
    },
    "DK-CV": {
      "href": "https://gitlab.com/logius/digikoppeling-compliance",
      "publisher": "Logius",
      "title": "Digikoppeling Compliance Voorziening"
    },
    "DK-Portaal": {
      "href": "https://oinregister.logius.nl/",
      "publisher": "Logius",
      "title": "Digikoppeling Portaal"
    },
    "DK-WUS-voorbeeld": {
      "href": "https://www.logius.nl/sites/default/files/public/bestanden/diensten/DigiKoppeling/Overig/Digikoppeling-Koppelvlakstandaard-WUS-Voorbeeldberichten.zip",
      "publisher": "Logius",
      "title": "Set voorbeeldberichten (zip)"
    },
    "Deployment Guide 1.1": {
      "authors": [
        "Pete Wenzel",
        "Jacques Durand"
      ],
      "date": "June 2005",
      "href": "http://www.oasis-open.org/apps/org/workgroup/ebxml-iic-deployment-profile-template-intro-100406.doc",
      "publisher": "OASIS",
      "title": "Deployment Profile Template For OASIS ebXML Message Service 2.0"
    },
    "DK": {
      "href": "https://www.logius.nl/domeinen/gegevensuitwisseling/digikoppeling",
      "publisher": "Logius",
      "title": "Logius | Digikoppeling"
    },
    "DK-Doc": {
      "href": "https://www.logius.nl/domeinen/gegevensuitwisseling/digikoppeling/documentatie",
      "publisher": "Logius",
      "title": "Digikoppeling documentatie"
    },
    "DK-Beheermodel": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/beheer/",
      "publisher": "Logius",
      "title": "Digikoppeling Beheermodel"
    },
    "DK-BPebMS": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/bpebms/",
      "publisher": "Logius",
      "title": "Digikoppeling Best Practices ebMS2"
    },
    "DK-BPGB": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/bpgb/",
      "publisher": "Logius",
      "title": "Digikoppeling Best Practices Grote Berichten"
    },
    "DK-BPWUS": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/bpwus/",
      "publisher": "Logius",
      "title": "Digikoppeling Best Practices WUS"
    },
    "DK-Beveiliging": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/beveilig/",
      "publisher": "Logius",
      "title": "Digikoppeling Beveiligingsstandaarden en voorschriften"
    },
    "DK-gbachtcert": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/ebms/",
      "publisher": "Logius",
      "title": "Digikoppeling Koppelvlakstandaard ebMS2"
    },
    "DK-ebMS": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/ebms/",
      "publisher": "Logius",
      "title": "Digikoppeling Koppelvlakstandaard ebMS2"
    },
    "DK-GB": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/gb/",
      "publisher": "Logius",
      "title": "Digikoppeling Koppelvlakstandaard Grote Berichten"
    },
    "DK-WUS": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/wus/",
      "publisher": "Logius",
      "title": "Digikoppeling Koppelvlakstandaard WUS"
    },
    "DK-RESTAPI": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/restapi/",
      "publisher": "Logius",
      "title": "Digikoppeling Koppelvlakstandaard REST-API"
    },
    "DK-Architectuur": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/architectuur/",
      "publisher": "Logius",
      "title": "Digikoppeling Architectuur"
    },
    "DK-IDAuth": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/idauth/",
      "publisher": "Logius",
      "title": "Digikoppeling Identificatie en Authenticatie"
    },
    "DK-WI": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/dk/watisdk/",
      "publisher": "Logius",
      "title": "Wat is Digikoppeling?"
    },
    "BOMOSFundament": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/bomos/fundament/",
      "date": "2 november 2023",
      "publisher": "Logius",
      "title": "BOMOS, het fundament"
    },
    "BOMOSVerdieping": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/bomos/verdieping/",
      "date": "2 november 2023",
      "publisher": "Logius",
      "title": "BOMOS, de verdieping"
    },
    "ebCPP": {
      "authors": [
        "Oasis"
      ],
      "date": "september 2002",
      "href": "http://www.ebxml.org/specs/ebcpp-2.0.pdf",
      "publisher": "Oasis",
      "title": "Collaboration-Protocol Profile and Agreement Specification Version 2.0"
    },
    "ebMS3": {
      "authors": [
        "Ian Jones",
        "Pete Wenzel"
      ],
      "date": "October 2007",
      "href": "https://docs.oasis-open.org/ebxml-msg/ebms/v3.0/core/os/ebms_core-3.0-spec-os.html",
      "publisher": "Oasis",
      "title": "Collaboration-Protocol Profile and Agreement Specification Version 2.0"
    },
    "eDelivery API4IPS": {
      "authors": [
        "J. Dimitriou, V. Veduta, B. Dumitriu"
      ],
      "date": "sept 8 2022",
      "href": "https://ec.europa.eu/digital-building-blocks/wikis/display/EDELCOMMUNITY/Project+deliverables",
      "publisher": "OpenID foundation",
      "title": "(ISA2).(eDelivery).(Piloting a REST API extension of CEF eDelivery).(ISA² IPS REST API Profile).(v1.0).pdf"
    },
    "Expert": {
      "authors": [
        "@@@"
      ],
      "date": "@@@",
      "href": "https://www.forumstandaardisatie.nl/sites/bfs/files/@@@.pdf",
      "publisher": "Forum Standaardisatie",
      "title": "Expertadvies CloudEvents 1.0"
    },
    "folmer2011": {
      "href": "https://research.utwente.nl/en/publications/management-and-development-model-for-open-standards-bomos-version",
      "title": "Management and Development Model for Open Standards (BOMOS) version 2",
      "keywords": "IR-76837",
      "authors": [
        "ErwinFolmer",
        "Matthijs Punter"
      ],
      "date": "2011",
      "language": "English",
      "publisher": "Programmabureau NOiV"
    },
    "folmer2012": {
      "href": "https://research.utwente.nl/en/publications/quality-of-semantic-standards",
      "title": "Quality of Semantic Standards",
      "authors": [
        "Erwin Folmer"
      ],
      "date": "2012",
      "publisher": "Universiteit Twente"
    },
    "DK-Gebruiksvoorwaarden": {
      "date": "1 januari 2021",
      "href": "https://www.logius.nl/domeinen/gegevensuitwisseling/digikoppeling/documentatie/gebruiksvoorwaarden-digikoppeling",
      "publisher": "Logius",
      "title": "Gebruiksvoorwaarden Digikoppeling"
    },
    "ADR-GEO": {
      "authors": [
        "L. van den Brink, P. Bresters, P. van Genuchten, G. Mathijssen, M. Strijker"
      ],
      "date": "March 07, 2024",
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/mod-geo/",
      "publisher": "Geonovum",
      "title": "API Design Rules Module: Geospatial"
    },
    "HTTPS-factsheet NCSC": {
      "date": "Nov 2014",
      "href": "https://www.ncsc.nl/documenten/factsheets/2019/juni/01/factsheet-https-kan-een-stuk-veiliger",
      "publisher": "NCSC",
      "title": "Factsheet HTTPS kan een stuk veiliger"
    },
    "iGOV.OpenID": {
      "authors": [
        "M. Varley, P. Grassi"
      ],
      "date": "October 5 2018",
      "href": "https://openid.net/specs/openid-igov-openid-connect-1_0.html",
      "publisher": "OpenID foundation",
      "title": "International Government Assurance Profile (iGov) for OpenID Connect 1.0 - draft 3"
    },
    "NLGOV.OpenID": {
      "authors": [
        "Remco Schaar, Frank van Es, Joris Joosten, Jan Geert Koops"
      ],
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/oidc/",
      "publisher": "Logius",
      "title": "OpenID NLGov"
    },
    "Introspection": {
      "authors": [
        "J. Richer"
      ],
      "date": "October 2015",
      "href": "https://tools.ietf.org/html/rfc7662",
      "publisher": "IETF",
      "title": "OAuth 2.0 Token Introspection"
    },
    "JWA": {
      "authors": [
        "M. Jones"
      ],
      "date": "may 2015",
      "href": "https://tools.ietf.org/html/rfc7518",
      "publisher": "IETF",
      "title": "JSON Web Algorithms (JWA)"
    },
    "JWE": {
      "authors": [
        "M. Jones, J. Hildebrand"
      ],
      "date": "may 2015",
      "href": "https://tools.ietf.org/html/rfc7516",
      "publisher": "IETF",
      "title": "JSON Web Encryption (JWE)"
    },
    "JWK": {
      "authors": [
        "M. Jones"
      ],
      "date": "may 2015",
      "href": "https://tools.ietf.org/html/rfc7517",
      "publisher": "IETF",
      "title": "JSON Web Key (JWK))"
    },
    "JWS": {
      "authors": [
        "M. Jones, J. Bradley, N. Sakimura"
      ],
      "date": "may 2015",
      "href": "https://tools.ietf.org/html/rfc7515",
      "publisher": "IETF",
      "title": "JSON Web Signature (JWS)"
    },
    "JWT": {
      "authors": [
        "M. Jones, J. Bradley, N. Sakimura"
      ],
      "date": "may 2015",
      "href": "https://tools.ietf.org/html/rfc7519",
      "publisher": "IETF",
      "title": "JSON Web Token (JWT)"
    },
    "NCSC 2019": {
      "date": "April 2019",
      "href": "https://www.ncsc.nl/documenten/publicaties/2019/mei/01/ict-beveiligingsrichtlijnen-voor-transport-layer-security-tls",
      "publisher": "NCSC",
      "title": "ICT-beveiligingsrichtlijnen voor Transport Layer Security (TLS) v2.0"
    },
    "NCSC 2021": {
      "date": "Jan 2021",
      "href": "https://www.ncsc.nl/documenten/publicaties/2021/januari/19/ict-beveiligingsrichtlijnen-voor-transport-layer-security-2.1",
      "publisher": "NCSC",
      "title": "ICT-beveiligingsrichtlijnen voor Transport Layer Security (TLS) v2.1"
    },
    "NCSC 2025": {
      "date": "June 2025",
      "href": "https://www.ncsc.nl/wat-kun-je-zelf-doen/documenten/publicaties/2025/juni/01/ict-beveiligingsrichtlijnen-voor-transport-layer-security-2025-05",
      "publisher": "NCSC",
      "title": "ICT-beveiligingsrichtlijnen voor Transport Layer Security (TLS) v2.1"
    },
    "NEN3610": {
      "authors": [
        ""
      ],
      "date": "Maart 2011",
      "href": "https://www.nen.nl/nen-3610-2011-a1-2016-nl-217738",
      "publisher": "Nederlands Normalisatie-instituut",
      "title": "Basismodel Geo-informatie - Termen, definities, relaties en algemene regels voor de uitwisseling van informatie over aan de aarde gerelateerde ruimtelijke objecten"
    },
    "no-Reliable-messaging": {
      "authors": [
        "Marc de Graauw"
      ],
      "date": "June 18, 2010",
      "href": "https://www.infoq.com/articles/no-reliable-messaging/",
      "publisher": "infoQ",
      "title": "Nobody Needs Reliable Messaging"
    },
    "OAuth2": {
      "authors": [
        "D. Hardt"
      ],
      "date": "October 2012",
      "href": "https://tools.ietf.org/html/rfc6749",
      "publisher": "The Internet Engineering Task Force",
      "title": "The OAuth 2.0 Authorization Framework"
    },
    "OpenID.Core": {
      "authors": [
        "N. Sakimura, J. Bradley, M. Jones, B. de Medeiros, C. Mortimore"
      ],
      "date": "November 8 2014",
      "href": "https://openid.net/specs/openid-connect-core-1_0.html",
      "publisher": "OpenID foundation",
      "title": "OpenID Connect Core 1.0"
    },
    "OpenID.Discovery": {
      "authors": [
        "N. Sakimura, J. Bradley, M. Jones, E. Jay"
      ],
      "date": "November 8 2014",
      "href": "https://openid.net/specs/openid-connect-discovery-1_0.html",
      "publisher": "OpenID foundation",
      "title": "OpenID Connect Discovery 1.0"
    },
    "Pas-toe-of-leg-uit": {
      "href": "https://www.forumstandaardisatie.nl/open-standaarden/verplicht",
      "publisher": "Forum Standaardisatie",
      "title": "Lijst Verplichte standaarden"
    },
    "PKIO-PvE": {
      "href": "https://por.pkioverheid.nl/",
      "publisher": "Logius",
      "title": "Certificate Policy/Programme of Requirements PKIoverheid"
    },
    "PKI-CA": {
      "href": "https://www.logius.nl/domeinen/toegang/aansluiten-als-trust-service-provider",
      "publisher": "Logius",
      "title": "Aansluiten als Trust Service Provider"
    },
    "PKIoverheid": {
      "href": "https://www.logius.nl/domeinen/toegang/pkioverheid",
      "publisher": "Logius",
      "title": "PKIoverheid"
    },
    "PKIO-Cert": {
      "href": "https://cert.pkioverheid.nl/",
      "publisher": "Logius",
      "title": "Overzicht PKIoverheid certificaten"
    },
    "SemVer": {
      "authors": [
        "T. Preston-Werner"
      ],
      "date": "June 2013",
      "href": "https://semver.org",
      "title": "Semantic Versioning 2.0.0"
    },
    "ADR-TS": {
      "authors": [
        ""
      ],
      "date": "March 07, 2024",
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/mod-ts/",
      "publisher": "Kennisplatform API's",
      "title": "API Design Rules Module: Transport Security"
    },
    "UMMR10": {
      "authors": [
        ""
      ],
      "date": "2001",
      "href": "https://unece.org/DAM/cefact/umm/UMM_Revision_10_2001.zip",
      "publisher": "UN/CEFACT",
      "title": "UMM Revision 10"
    },
    "UMMUG": {
      "authors": [
        ""
      ],
      "date": "2003",
      "href": "https://www.unece.org/fileadmin/DAM/cefact/umm/UMM_userguide_220606.pdf",
      "publisher": "UN/CEFACT",
      "title": "UN/CEFACT Modeling Methodology (UMM) User Guide"
    },
    "UUID": {
      "authors": [
        "P. Leach",
        "M. Mealling",
        "R. Salz"
      ],
      "date": "July 2005",
      "href": "https://tools.ietf.org/html/rfc4122",
      "publisher": "The Internet Engineering Task Force",
      "title": "A Universally Unique IDentifier (UUID) URN Namespace"
    },
    "DK-Voorwaarden": {
      "date": "1 januari 2021",
      "href": "https://www.logius.nl/domeinen/gegevensuitwisseling/digikoppeling/documentatie/voorwaarden-digikoppeling",
      "publisher": "Logius",
      "title": "Voorwaarden Digikoppeling"
    },
    "X520": {
      "href": "https://www.iso.org/standard/43796.html",
      "publisher": "ISO",
      "title": "ITU-T Recommendation X.520 (2001) ISO/IEC 9594-6"
    },
    "ADR-Validator": {
      "href": "https://gitlab.com/commonground/don/adr-validator/-/tree/v0.5.0/pkg/rulesets",
      "title": "Technical ADR Validation rule testset 0.5.0",
      "authors": [
        "H. Stijns"
      ],
      "publisher": "Geonovum",
      "date": "November 2023"
    },
    "JRC117836": {
      "href": "https://op.europa.eu/en/publication-detail/-/publication/6521f427-01df-11ea-8c1f-01aa75ed71a1",
      "title": "The Relationship Between Open Source Software and Standard Setting",
      "authors": [
        "Knut Blind",
        "Mirko Böhm"
      ],
      "editors": [
        "Nikolaus Thumm"
      ],
      "publisher": "Joint Research Center",
      "id": "JRC117836",
      "date": "2019"
    },
    "Krechmer2002": {
      "href": "https://www.isology.com/pdf/cathedrals.pdf",
      "title": "Cathedrals, Libraries and Bazaars",
      "authors": [
        "Ken Krechmer"
      ],
      "publisher": "Association of Computing Machinery (ACM)",
      "date": "March 2002"
    },
    "FSC-Core": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/fsc/core/1.0.0/",
      "title": "FSC - Core",
      "authors": [
        "Eelco Hotting",
        "Ronald Koster",
        "Henk van Maanen",
        "Niels Dequeker",
        "Edward van Gelderen",
        "Pim Gaemers"
      ],
      "publisher": "Logius"
    },
    "FSC-Logging": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/fsc/logging/1.0.0/",
      "title": "FSC - Logging",
      "authors": [
        "Eelco Hotting",
        "Ronald Koster",
        "Henk van Maanen",
        "Niels Dequeker",
        "Edward van Gelderen",
        "Pim Gaemers"
      ],
      "publisher": "Logius"
    },
    "HEART.OAuth2": {
      "authors": [
        "J. Richer"
      ],
      "date": "April 25, 2017",
      "href": "https://openid.net/specs/openid-heart-oauth2-1_0.html",
      "publisher": "OpenID foundation",
      "title": "Health Relationship Trust Profile for OAuth 2.0"
    },
    "JWS.JWE.Algs": {
      "authors": [
        "Jim Schaad, Jeff Hodges, Joe Hildebrand, Sean Turner"
      ],
      "date": "",
      "href": "https://www.iana.org/assignments/jose/jose.xhtml#web-signature-encryption-algorithms",
      "publisher": "IANA",
      "title": "IANA JSON Web Signatures and Encryption Algorithms registry"
    },
    "I-D.ietf-oauth-pop-architecture": {
      "authors": [
        "P. Hunt, J. Richer, W. Mills, P. Mishra, H. Tschofenig"
      ],
      "date": "July 8, 2016",
      "href": "https://tools.ietf.org/html/draft-ietf-oauth-pop-architecture-08",
      "publisher": "IETF",
      "title": "OAuth 2.0 Proof-of-Possession (PoP) Security Architecture"
    },
    "iGOV.OAuth2": {
      "authors": [
        "J. Richer, M. Varley, P. Grassi"
      ],
      "date": "October 5 2018",
      "href": "https://openid.net/specs/openid-igov-oauth2-1_0-03.html",
      "publisher": "OpenID foundation",
      "title": "International Government Assurance Profile (iGov) for OAuth 2.0"
    },
    "NLGOV.OAuth2": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/oauth/",
      "publisher": "Logius",
      "title": "NL GOV Assurance profile for OAuth 2.0"
    },
    "ietf-oauth-v2-1-10-refresh-token-grant": {
      "authors": [
        "Dick Hardt, Aaron Parecki, Torsten Lodderstedt"
      ],
      "date": "January 9, 2024",
      "href": "https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-1-10#name-refresh-token-grant",
      "publisher": "IETF",
      "title": "The OAuth 2.1 Authorization Framework: Refresh Token Grant"
    },
    "OpenID.FAPI2.0": {
      "authors": [
        "D. Fett, D. Tonge, J. Heenan"
      ],
      "date": "February 22 2025",
      "href": "https://openid.net/specs/fapi-security-profile-2_0-final.html",
      "publisher": "OpenID foundation",
      "title": "FAPI 2.0 Security Profile"
    },
    "logboek-extensie-guideline": {
      "href": "https://logius-standaarden.github.io/logboek-extensie-template/",
      "publisher": "Logius",
      "title": "LDV Extensie Guideline"
    },
    "logboek dataverwerkingen": {
      "href": "https://logius-standaarden.github.io/logboek-dataverwerkingen/",
      "publisher": "Logius",
      "title": "Logboek Dataverwerkingen"
    },
    "NIST.SP.800-162": {
      "href": " https://doi.org/10.6028/NIST.SP.800-162 ",
      "title": " Guide to Attribute Based Access Control (ABAC) Definition and Considerations ",
      "authors": [
        "Vincent C. Hu",
        "David Ferraiolo",
        "Rick Kuhn",
        "Adam Schnitzer",
        "Kenneth Sandlin",
        "Robert Miller",
        "Karen Scarfone"
      ],
      "date": " January 2014 ",
      "id": "nist.sp.800-162"
    },
    "IANA.well-known-uris": {
      "href": "https://www.iana.org/assignments/well-known-uris/well-known-uris.xhtml",
      "title": "IANA \"Well-Known URIs\" registry",
      "date": "2010-01-20",
      "id": "iana.well-known-uris"
    },
    "MIM": {
      "href": "https://docs.geostandaarden.nl/mim/mim/",
      "title": "Metamodel Informatie Modellering",
      "date": "13 juni 2024",
      "id": "mim"
    }
  },
  "specStatus": "CV",
  "specType": "ST",
  "pubDomain": "api",
  "shortName": "authzen",
  "publishDate": "2025-10-16",
  "editors": [
    {
      "name": "Stas Mironov",
      "company": "Logius",
      "companyURL": "https://www.logius.nl/"
    },
    {
      "name": "Alexander Green",
      "company": "Logius",
      "companyURL": "https://www.logius.nl/"
    }
  ],
  "authors": [
    {
      "name": "Michiel Trimpe",
      "company": "VNG Realisatie",
      "companyURL": "https://vng.nl/artikelen/vng-realisatie"
    }
  ],
  "github": "https://github.com/Logius-standaarden/authzen-nlgov",
  "preProcess": [
    null,
    null
  ]
}</script>
<link rel="stylesheet" href="https://gitdocumentatie.logius.nl/publicatie/respec/style/base.css">
<link rel="stylesheet" media="(prefers-color-scheme: dark)" href="https://gitdocumentatie.logius.nl/publicatie/respec/style/dark.css"></head>
 <body class="h-entry"><div class="head">
    <a class="logo" href="https://www.logius.nl/onze-dienstverlening/standaarden"><img alt="Logius" height="77" id="Logius" src="https://gitdocumentatie.logius.nl/publicatie/respec/style/logos/figure-logius.svg" width="44">
  </a> <h1 id="title" class="title">NLGov Profile for OpenID AuthZEN Authorization API</h1>
    
    <h2>
      Logius Standard<br>
      Consultation version
      <time class="dt-published" datetime="2025-10-15">October 15, 2025</time>
    </h2>
    <dl>
      
      
      <dt>Latest editor's draft:</dt><dd><a href="https://logius-standaarden.github.io/authzen-nlgov/">https://logius-standaarden.github.io/authzen-nlgov/</a></dd>
      
      
      
      
      
      <dt>Editors:</dt>
      <dd class="editor p-author h-card vcard">
    <span class="p-name fn">Stas Mironov</span> (<a class="p-org org h-org" href="https://www.logius.nl/">Logius</a>)
  </dd><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Alexander Green</span> (<a class="p-org org h-org" href="https://www.logius.nl/">Logius</a>)
  </dd>
      
      <dt>Author:</dt><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Michiel Trimpe</span> (<a class="p-org org h-org" href="https://vng.nl/artikelen/vng-realisatie">VNG Realisatie</a>)
  </dd>
      <dt>Participate:</dt><dd>
    <a href="https://github.com/Logius-standaarden/authzen-nlgov/">GitHub Logius-standaarden/authzen-nlgov</a>
  </dd><dd>
    <a href="https://github.com/Logius-standaarden/authzen-nlgov/issues/">File an issue</a>
  </dd><dd>
    <a href="https://github.com/Logius-standaarden/authzen-nlgov/commits/">Commit history</a>
  </dd><dd>
    <a href="https://github.com/Logius-standaarden/authzen-nlgov/pulls/">Pull requests</a>
  </dd>
    </dl>
    <p class="copyright">
            This document is licensed under 
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0/legalcode" class="subfoot"><img class="license" src="https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-by.svg" alt="Logo Creative Commons Attribution 4.0 International Public License"><br> Creative Commons Attribution 4.0 International Public License</a>
          </p>
    <hr title="Separator for header">
  </div><section id="sotd" class="introductory"><h2>Status of This Document</h2><p>This is a proposed recommendation approved by TO. Comments regarding this document may be sent to api@logius.nl</p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#conformance">Conformance</a></li><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#dutch-government-profile-for-openid-authzen-authorization-api">Dutch government profile for OpenID AuthZEN Authorization API</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a></li><li class="tocline"><a class="tocxref" href="#model"><bdi class="secno">2. </bdi>Model</a></li><li class="tocline"><a class="tocxref" href="#features"><bdi class="secno">3. </bdi>Features</a></li><li class="tocline"><a class="tocxref" href="#api-version"><bdi class="secno">4. </bdi>API Version</a></li><li class="tocline"><a class="tocxref" href="#information-model"><bdi class="secno">5. </bdi>Information Model</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#subject"><bdi class="secno">5.1 </bdi>Subject</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#subject-properties"><bdi class="secno">5.1.1 </bdi>Subject Properties</a></li><li class="tocline"><a class="tocxref" href="#subject-examples"><bdi class="secno">5.1.2 </bdi>Examples (non-normative)</a></li></ol></li><li class="tocline"><a class="tocxref" href="#resource"><bdi class="secno">5.2 </bdi>Resource</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#resource-properties"><bdi class="secno">5.2.1 </bdi>Resource Properties</a></li><li class="tocline"><a class="tocxref" href="#resource-examples"><bdi class="secno">5.2.2 </bdi>Examples (non-normative)</a></li></ol></li><li class="tocline"><a class="tocxref" href="#action"><bdi class="secno">5.3 </bdi>Action</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#action-properties"><bdi class="secno">5.3.1 </bdi>Action Properties</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#processing-activity-identifier"><bdi class="secno">5.3.1.1 </bdi><span class="nlgov-add">Processing Activity identifier</span></a></li><li class="tocline"><a class="tocxref" href="#algorithm-identifier"><bdi class="secno">5.3.1.2 </bdi><span class="nlgov-add">Algorithm identifier</span></a></li></ol></li><li class="tocline"><a class="tocxref" href="#action-examples"><bdi class="secno">5.3.2 </bdi>Examples (non-normative)</a></li></ol></li><li class="tocline"><a class="tocxref" href="#context"><bdi class="secno">5.4 </bdi>Context</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#context-properties"><bdi class="secno">5.4.1 </bdi><span class="nlgov-add">Context Properties</span></a><ol class="toc"><li class="tocline"><a class="tocxref" href="#time"><bdi class="secno">5.4.1.1 </bdi><span class="nlgov-add">Time</span></a></li><li class="tocline"><a class="tocxref" href="#w3c-trace-context"><bdi class="secno">5.4.1.2 </bdi><span class="nlgov-add">W3C Trace Context</span></a></li><li class="tocline"><a class="tocxref" href="#verifiable-claims"><bdi class="secno">5.4.1.3 </bdi><span class="nlgov-add">Verifiable claims</span></a></li><li class="tocline"><a class="tocxref" href="#context-mim"><bdi class="secno">5.4.1.4 </bdi><span class="nlgov-add">Meta-information Model</span></a></li><li class="tocline"><a class="tocxref" href="#context-ld"><bdi class="secno">5.4.1.5 </bdi><span class="nlgov-add">Linked Data context</span></a></li></ol></li><li class="tocline"><a class="tocxref" href="#context-examples"><bdi class="secno">5.4.2 </bdi>Examples (non-normative)</a></li></ol></li><li class="tocline"><a class="tocxref" href="#decision"><bdi class="secno">5.5 </bdi>Decision</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#decision-context"><bdi class="secno">5.5.1 </bdi>Decision Context</a></li><li class="tocline"><a class="tocxref" href="#decision-examples"><bdi class="secno">5.5.2 </bdi>Examples (non-normative)</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#non-normative-example-1-conveying-decision-reasons"><bdi class="secno">5.5.2.1 </bdi>Non-normative Example 1: conveying decision Reasons</a></li><li class="tocline"><a class="tocxref" href="#non-normative-example-2-conveying-metadata-and-environmental-elements"><bdi class="secno">5.5.2.2 </bdi>Non-normative Example 2: conveying metadata and environmental elements</a></li><li class="tocline"><a class="tocxref" href="#non-normative-example-3-requesting-step-up-authentication"><bdi class="secno">5.5.2.3 </bdi>Non-normative Example 3: requesting step-up authentication</a></li></ol></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#access-evaluation-api"><bdi class="secno">6. </bdi>Access Evaluation API</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#access-evaluation-request"><bdi class="secno">6.1 </bdi>The Access Evaluation API Request</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#example-non-normative"><bdi class="secno">6.1.1 </bdi>Example (non-normative)</a></li></ol></li><li class="tocline"><a class="tocxref" href="#access-evaluation-response"><bdi class="secno">6.2 </bdi>The Access Evaluation API Response</a></li></ol></li><li class="tocline"><a class="tocxref" href="#access-evaluations-api"><bdi class="secno">7. </bdi>Access Evaluations API</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#access-evaluations-request"><bdi class="secno">7.1 </bdi>The Access Evaluations API Request</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#default-values"><bdi class="secno">7.1.1 </bdi>Default values</a></li><li class="tocline"><a class="tocxref" href="#evaluations-options"><bdi class="secno">7.1.2 </bdi>Evaluations options</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#evaluations-semantics"><bdi class="secno">7.1.2.1 </bdi>Evaluations semantics</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#example-evaluate-read-action-for-three-documents-using-all-three-semantics"><bdi class="secno">7.1.2.1.1 </bdi>Example: Evaluate <code>read</code> action for three documents using all three semantics</a></li></ol></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#access-evaluations-response"><bdi class="secno">7.2 </bdi>The Access Evaluations API Response</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#errors"><bdi class="secno">7.2.1 </bdi>Errors</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#search"><bdi class="secno">8. </bdi>Search APIs</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#search-semantics"><bdi class="secno">8.1 </bdi>Semantics</a></li><li class="tocline"><a class="tocxref" href="#search-pagination"><bdi class="secno">8.2 </bdi>Pagination</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#search-pagination-request"><bdi class="secno">8.2.1 </bdi>Paginated Requests</a></li><li class="tocline"><a class="tocxref" href="#search-pagination-response"><bdi class="secno">8.2.2 </bdi>Paginated Responses</a></li><li class="tocline"><a class="tocxref" href="#search-pagination-examples"><bdi class="secno">8.2.3 </bdi>Examples (non-normative)</a></li></ol></li><li class="tocline"><a class="tocxref" href="#search-response"><bdi class="secno">8.3 </bdi>The Search API Response</a></li><li class="tocline"><a class="tocxref" href="#subject-search-api"><bdi class="secno">8.4 </bdi>Subject Search API</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#subject-search-request"><bdi class="secno">8.4.1 </bdi>The Subject Search API Request</a></li><li class="tocline"><a class="tocxref" href="#example-non-normative-subject-search-example"><bdi class="secno">8.4.2 </bdi>Example (non-normative) {#subject-search-example"}</a></li></ol></li><li class="tocline"><a class="tocxref" href="#resource-search-api"><bdi class="secno">8.5 </bdi>Resource Search API</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#resource-search-request"><bdi class="secno">8.5.1 </bdi>The Resource Search API Request</a></li><li class="tocline"><a class="tocxref" href="#example-non-normative-resource-search-example"><bdi class="secno">8.5.2 </bdi>Example (non-normative) {#resource-search-example"}</a></li></ol></li><li class="tocline"><a class="tocxref" href="#action-search-api"><bdi class="secno">8.6 </bdi>Action Search API</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#action-search-request"><bdi class="secno">8.6.1 </bdi>The Action Search API Request</a></li><li class="tocline"><a class="tocxref" href="#example-non-normative-action-search-example"><bdi class="secno">8.6.2 </bdi>Example (non-normative) {#action-search-example"}</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#pdp-metadata"><bdi class="secno">9. </bdi>Policy Decision Point Metadata</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#pdp-metadata-data"><bdi class="secno">9.1 </bdi>Data structure</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#pdp-metadata-data-endpoint"><bdi class="secno">9.1.1 </bdi>Endpoint Parameters</a></li><li class="tocline"><a class="tocxref" href="#pdp-metadata-data-capabilities"><bdi class="secno">9.1.2 </bdi>Capabilities Parameters</a></li><li class="tocline"><a class="tocxref" href="#pdp-metadata-data-sig"><bdi class="secno">9.1.3 </bdi>Signature Parameter</a></li></ol></li><li class="tocline"><a class="tocxref" href="#pdp-metadata-access"><bdi class="secno">9.2 </bdi>Obtaining Policy Decision Point Metadata</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#pdp-metadata-access-request"><bdi class="secno">9.2.1 </bdi>Policy Decision Point Metadata Request</a></li><li class="tocline"><a class="tocxref" href="#pdp-metadata-access-response"><bdi class="secno">9.2.2 </bdi>Policy Decision Point Metadata Response</a></li><li class="tocline"><a class="tocxref" href="#pdp-metadata-data-endpoint-validation"><bdi class="secno">9.2.3 </bdi>Policy Decision Point Metadata Validation</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#transport"><bdi class="secno">10. </bdi>Transport</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#transport-https-json"><bdi class="secno">10.1 </bdi>HTTPS JSON Binding</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#transport-https-json-serialization"><bdi class="secno">10.1.1 </bdi>JSON Serialization</a></li><li class="tocline"><a class="tocxref" href="#error-responses"><bdi class="secno">10.1.2 </bdi>Error Responses</a></li><li class="tocline"><a class="tocxref" href="#request-identification"><bdi class="secno">10.1.3 </bdi>Request Identification</a></li><li class="tocline"><a class="tocxref" href="#examples-non-normative-5"><bdi class="secno">10.1.4 </bdi>Examples (non-normative)</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#Security"><bdi class="secno">11. </bdi>Security Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#security-integrity-confidentiality"><bdi class="secno">11.1 </bdi>Communication Integrity and Confidentiality</a></li><li class="tocline"><a class="tocxref" href="#security-confidentiality-authn"><bdi class="secno">11.2 </bdi>Policy Confidentiality and Sender Authentication</a></li><li class="tocline"><a class="tocxref" href="#security-sender-authentn-fail"><bdi class="secno">11.3 </bdi>Sender Authentication Failure</a></li><li class="tocline"><a class="tocxref" href="#security-trust"><bdi class="secno">11.4 </bdi>Trust</a></li><li class="tocline"><a class="tocxref" href="#security-json"><bdi class="secno">11.5 </bdi>JSON Payload Considerations</a></li><li class="tocline"><a class="tocxref" href="#security-authorization-response-integrity"><bdi class="secno">11.6 </bdi>Authorization Response Integrity</a></li><li class="tocline"><a class="tocxref" href="#availability-denial-of-service-security-avail-dos"><bdi class="secno">11.7 </bdi>Availability &amp; Denial of Service {#security-avail-dos}}</a></li><li class="tocline"><a class="tocxref" href="#security-metadata-sig"><bdi class="secno">11.8 </bdi>Differences between Unsigned and Signed Metadata</a></li><li class="tocline"><a class="tocxref" href="#security-metadata-caching"><bdi class="secno">11.9 </bdi>Metadata Caching</a></li></ol></li><li class="tocline"><a class="tocxref" href="#iana"><bdi class="secno">12. </bdi>IANA Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#iana-pdp-metadata-registry"><bdi class="secno">12.1 </bdi>AuthZEN Policy Decision Point Metadata Registry</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#registry-definition"><bdi class="secno">12.1.1 </bdi>Registry Definition</a></li><li class="tocline"><a class="tocxref" href="#iana-pdp-metadata-template"><bdi class="secno">12.1.2 </bdi>Registration Template</a></li><li class="tocline"><a class="tocxref" href="#iana-pdp-metadata-initial"><bdi class="secno">12.1.3 </bdi>Initial Registrations</a></li></ol></li><li class="tocline"><a class="tocxref" href="#iana-wk-registry"><bdi class="secno">12.2 </bdi>Well-Known URI Registry</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#iana-wk-contents"><bdi class="secno">12.2.1 </bdi>Registry Contents</a></li></ol></li><li class="tocline"><a class="tocxref" href="#iana-pdp-capabilities-registry"><bdi class="secno">12.3 </bdi>AuthZEN Policy Decision Point Capabilities Registry</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#iana-pdp-capabilities-definition"><bdi class="secno">12.3.1 </bdi>Registry Definition</a></li><li class="tocline"><a class="tocxref" href="#iana-pdp-capabilities-template"><bdi class="secno">12.3.2 </bdi>Registration Template</a></li></ol></li><li class="tocline"><a class="tocxref" href="#iana-urn-namespace"><bdi class="secno">12.4 </bdi>Registration of "authzen" URN Sub-namespace</a></li></ol></li><li class="tocline"><a class="tocxref" href="#terminology"><bdi class="secno">A. </bdi>Terminology</a></li><li class="tocline"><a class="tocxref" href="#Acknowledgements"><bdi class="secno">B. </bdi>Acknowledgements</a></li><li class="tocline"><a class="tocxref" href="#index"><bdi class="secno">C. </bdi>Index</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#index-defined-here"><bdi class="secno">C.1 </bdi>Terms defined by this specification</a></li><li class="tocline"><a class="tocxref" href="#index-defined-elsewhere"><bdi class="secno">C.2 </bdi>Terms defined by reference</a></li></ol></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">D. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">D.1 </bdi>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">D.2 </bdi>Informative references</a></li></ol></li></ol></nav><section id="conformance" class="introductory"><div class="header-wrapper"><h2 id="conformance-0">Conformance</h2><a class="self-link" href="#conformance" aria-label="Permalink for this Section"></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key words <em class="rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, <em class="rfc2119">MUST NOT</em>, <em class="rfc2119">OPTIONAL</em>, <em class="rfc2119">RECOMMENDED</em>, <em class="rfc2119">REQUIRED</em>, <em class="rfc2119">SHOULD</em>, and <em class="rfc2119">SHOULD NOT</em> in this document
        are to be interpreted as described in
        <a href="https://www.rfc-editor.org/info/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all
        capitals, as shown here.
      </p></section>

  <section id="abstract" class="introductory"><h2>Abstract</h2><p>The Authorization API enables Policy Decision Points (PDPs) and Policy Enforcement Points (PEPs) to communicate authorization requests and decisions to each other without requiring knowledge of each other's inner workings. The Authorization API is served by the PDP and is called by the PEP. The Authorization API includes evaluation endpoints, which provide specific access decisions, and search endpoints for discovering permissible subjects, resources, or actions.</p>
</section>
  <div>
   <i>
    This document is an adaptation of the
    <a href="https://openid.net/specs/authorization-api-1_0-04.html">
     'OpenID AuthZEN Authorization API 1.0 – draft 04’ (hereinafter: AuthZEN)
    </a>
    of the OpenID Foundation.
      This does not indicate an endorsement by the OpenID Foundation. In as far as AuthZEN is incorporated in this document, the
    <a href="https://openid.net/intellectual-property/contribution-license-agreement/">
     OpenID Copyright License
    </a>
    applies.
   </i>
  </div>
  
  <section class="introductory" id="dutch-government-profile-for-openid-authzen-authorization-api"><div class="header-wrapper"><h2 id="dutch-government-profile-for-openid-authzen-authorization-api-0">Dutch government profile for OpenID AuthZEN Authorization API</h2><a class="self-link" href="#dutch-government-profile-for-openid-authzen-authorization-api" aria-label="Permalink for this Section"></a></div>
<p>This profile is based upon the <a href="https://openid.net/wg/authzen/specifications/">AuthZEN Authorization API</a> as published by the <a href="https://openid.net/">OpenID Foundation</a>. It should be considered a fork of this standard geared more towards the Netherlands and operating within the context of the European Union.</p>
<p>Starting with chapter Introduction we follow the structure of the AuthZEN Authorization API. Content introduced by the NLGov profile is marked in <span class="nlgov-add">green</span>. Content from the AuthZEN Authorization API that is not used in the NLGov profile is marked <span class="nlgov-del">red</span>.</p>
</section>
  <section id="introduction"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div>
<p>Computational services often implement access control within their components by separating Policy Decision Points (PDPs) from Policy Enforcement Points (PEPs). PDPs and PEPs are defined in XACML ([<cite><a class="bibref" data-link-type="biblio" href="#bib-xacml20" title="OASIS eXtensible Access Control Markup Language (XACML) Version 2.0">XACML20</a></cite>]) and NIST's ABAC SP 800-162 ([<cite><a class="bibref" data-link-type="biblio" href="#bib-nist.sp.800-162" title=" Guide to Attribute Based Access Control (ABAC) Definition and Considerations ">NIST.SP.800-162</a></cite>]). Communication between PDPs and PEPs follows similar patterns across different software and services that require or provide authorization information. The Authorization API described in this document enables different providers to offer PDP and PEP capabilities without having to bind themselves to one particular implementation of a PDP or PEP.</p>
</section>
  <section id="model"><div class="header-wrapper"><h2 id="x2-model"><bdi class="secno">2. </bdi>Model</h2><a class="self-link" href="#model" aria-label="Permalink for Section 2."></a></div>
<p>By convention, we refer to a service that implements this API as a Policy Decision Point, or PDP. The policy language, architecture, and state management aspects of a PDP are beyond the scope of this specification.</p>
<p>By convention, we refer to a client of the Authorization API as a Policy Enforcement Point, or PEP. Clients may consume the Authorization API for use cases that go beyond enforcement of authorization decisions; for example, the Resource Search API (<a href="#resource-search-api" data-matched-text="[[[#resource-search-api]]]" class="sec-ref"><bdi class="secno">8.5 </bdi>Resource Search API</a>) allows a caller to discover the resources on which a subject can perform an action. For consistency, we use the term PEP to describe a client of the API, regardless of the use case.</p>
<p>The Authorization API is defined in a transport-agnostic manner. A normative HTTPS binding is described in Transport (<a href="#transport" data-matched-text="[[[#transport]]]" class="sec-ref"><bdi class="secno">10. </bdi>Transport</a>). Other bindings, such as gRPC, may be defined in other profiles of this specification.</p>
<p>Authentication for the Authorization API itself is out of scope for this document, since authentication for APIs is well-documented elsewhere. Support for OAuth 2.0 ([<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>]) is <em class="rfc2119">RECOMMENDED</em>.</p>
</section>
  <section id="features"><div class="header-wrapper"><h2 id="x3-features"><bdi class="secno">3. </bdi>Features</h2><a class="self-link" href="#features" aria-label="Permalink for Section 3."></a></div>
<p>The core feature of the Authorization API is the Access Evaluation API (<a href="#access-evaluation-api" data-matched-text="[[[#access-evaluation-api]]]" class="sec-ref"><bdi class="secno">6. </bdi>Access Evaluation API</a>), which enables a PEP to determine whether a specific request can be permitted to access a specific resource. The following are non-normative examples:</p>
<ul>
<li>Can Alice view document #123?</li>
<li>Can Alice view document #123 at 16:30 on Tuesday, June 11, 2024?</li>
<li>Can a manager print?</li>
</ul>
<p>The Access Evaluations API (<a href="#access-evaluations-api" data-matched-text="[[[#access-evaluations-api]]]" class="sec-ref"><bdi class="secno">7. </bdi>Access Evaluations API</a>) enables execution of multiple evaluations in a single request. The following are non-normative examples:</p>
<ul>
<li>Can Alice view documents 123, 234 and 345 on Tuesday, June 11, 2024?</li>
<li>Can document 123 be viewed by Alice and Bob?</li>
</ul>
<p>The Search APIs (<a href="#search" data-matched-text="[[[#search]]]" class="sec-ref"><bdi class="secno">8. </bdi>Search APIs</a>) provide lists of resources, subjects or actions that would be allowed access. The following are non-normative examples:</p>
<ul>
<li>Which documents can Alice view?</li>
<li>Who can view document 123?</li>
<li>What actions can Alice perform on document 123 on Tuesday, June 11, 2024?</li>
</ul>
</section>
  <section id="api-version"><div class="header-wrapper"><h2 id="x4-api-version"><bdi class="secno">4. </bdi>API Version</h2><a class="self-link" href="#api-version" aria-label="Permalink for Section 4."></a></div>
<p>This document describes the API version 1.0. Any updates to this API through subsequent revisions of this document or other documents <em class="rfc2119">MAY</em> augment this API, but <em class="rfc2119">MUST NOT</em> modify the API described here. Augmentation <em class="rfc2119">MAY</em> include additional API methods or additional parameters to existing API methods, additional authorization mechanisms, or additional optional headers in HTTPS transport bindings. Endpoints for version 1.0 <em class="rfc2119">SHOULD</em> include <code>v1</code> in the endpoint identifier (e.g. <code>https://pdp.example.com/access/v1/</code>).</p>
</section>
  <section id="information-model-0"><div class="header-wrapper"><h2 id="information-model"><bdi class="secno">5. </bdi>Information Model</h2><a class="self-link" href="#information-model" aria-label="Permalink for Section 5."></a></div><p>The information model for requests and responses include the following entities: Subject, Action, Resource, Context, and Decision. These are all defined below.</p>
<p><span class="nlgov-add">Specific implementations of the generic AuthZEN information model <em class="rfc2119">SHOULD</em> be documented in a meta-information model. This enables an unambigous interpretation of the meaning of requests. It is <em class="rfc2119">RECOMMENDED</em> to document to the meta-information model using [<cite><a class="bibref" data-link-type="biblio" href="#bib-mim" title="Metamodel Informatie Modellering">MIM</a></cite>].</span></p>
<p><span class="nlgov-add">It is <em class="rfc2119">RECOMMENDED</em> to use [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11" title="JSON-LD 1.1">JSON-LD11</a></cite>] to enable automatic integration into existing semantic models, as described in <a href="#context-mim" data-matched-text="[[[#context-mim]]]" class="sec-ref"><bdi class="secno">5.4.1.4 </bdi><span class="nlgov-add">Meta-information Model</span></a>.</span></p>
<section id="subject-0"><div class="header-wrapper"><h3 id="subject"><bdi class="secno">5.1 </bdi>Subject</h3><a class="self-link" href="#subject" aria-label="Permalink for Section 5.1"></a></div><p>A Subject is the user or machine principal about whom the Authorization API is being invoked. The Subject may be requesting access at the time the Authorization API is invoked.</p>
<p>A Subject is an object that contains two <em class="rfc2119">REQUIRED</em> keys, <code>type</code> and <code>id</code>, which have a string value, and an <em class="rfc2119">OPTIONAL</em> key, <code>properties</code>, with a value of an object.</p>
<p><code>type</code>:
: <em class="rfc2119">REQUIRED</em>. A string value that specifies the type of the Subject. <span class="nlgov-add">It is <em class="rfc2119">RECOMMENDED</em> to define the type as a Linked Data URI.</span></p>
<p><code>id</code>:
: <em class="rfc2119">REQUIRED</em>. A string value containing the unique identifier of the Subject, scoped to the <code>type</code>.</p>
<p><code>properties</code>:
: <em class="rfc2119">OPTIONAL</em>. An object which can be used to express additional attributes of a Subject.</p>
<section id="subject-properties-0"><div class="header-wrapper"><h4 id="subject-properties"><bdi class="secno">5.1.1 </bdi>Subject Properties</h4><a class="self-link" href="#subject-properties" aria-label="Permalink for Section 5.1.1"></a></div><p>Many authorization systems are stateless, and expect the PEP to pass in all relevant attributes used in the evaluation of the authorization policy. To satisfy this requirement, Subjects <em class="rfc2119">MAY</em> include additional attributes as key-value pairs, under the <code>properties</code> object. A property can contain both simple values, such as strings, numbers, booleans and nulls, and complex values, such as arrays and objects.</p>
<p>Examples of subject attributes can include, but are not limited to:</p>
<ul>
<li>department,</li>
<li>group memberships,</li>
<li>device identifier,</li>
<li>IP address.</li>
</ul>
</section><section id="examples-non-normative"><div class="header-wrapper"><h4 id="subject-examples"><bdi class="secno">5.1.2 </bdi>Examples (non-normative)</h4><a class="self-link" href="#subject-examples" aria-label="Permalink for Section 5.1.2"></a></div><p>The following is a non-normative example of a minimal Subject:</p>
<div class="example" id="subject-example">
        <div class="marker">
    <a class="self-link" href="#subject-example">Example<bdi> 1</bdi></a><span class="example-title">: Example Subject</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice@example.com"</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<p>The following is a non-normative example of a Subject which adds a string-valued <code>department</code> property:</p>
<div class="example" id="subject-department-example">
        <div class="marker">
    <a class="self-link" href="#subject-department-example">Example<bdi> 2</bdi></a><span class="example-title">: Example Subject with Additional Property</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice@example.com"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"department"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Sales"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<p>The following is a non-normative example of a subject which adds IP address and device identifier properties:</p>
<div class="example" id="subject-device-id-example">
        <div class="marker">
    <a class="self-link" href="#subject-device-id-example">Example<bdi> 3</bdi></a><span class="example-title">: Example Subject with IP Address and Device ID</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice@example.com"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"ip_address"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"172.217.22.14"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"device_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"8:65:ee:17:7e:0b"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

</section></section><section id="resource-0"><div class="header-wrapper"><h3 id="resource"><bdi class="secno">5.2 </bdi>Resource</h3><a class="self-link" href="#resource" aria-label="Permalink for Section 5.2"></a></div><p>A Resource is the target of an access request. It is an object that is constructed similar to a Subject entity. It has the following keys:</p>
<p><code>type</code>:
: <em class="rfc2119">REQUIRED</em>. A string value that specifies the type of the Resource. <span class="nlgov-add">It is <em class="rfc2119">RECOMMENDED</em> to define the type as a Linked Data URI.</span></p>
<p><code>id</code>:
: <em class="rfc2119">REQUIRED</em>. A string value containing the unique identifier of the Resource, scoped to the <code>type</code>.</p>
<p><code>properties</code>:
: <em class="rfc2119">OPTIONAL</em>. An object which can be used to express additional attributes of a Resource.</p>
<section id="resource-properties-0"><div class="header-wrapper"><h4 id="resource-properties"><bdi class="secno">5.2.1 </bdi>Resource Properties</h4><a class="self-link" href="#resource-properties" aria-label="Permalink for Section 5.2.1"></a></div><p>Similarly to the Subject properties, the PEP can also provide attributes for the Resource in the properties field.</p>
<p>Such attributes can include, but are not limited to, attributes of the resource used in access evaluations or metadata about the resource.</p>
</section><section id="examples-non-normative-0"><div class="header-wrapper"><h4 id="resource-examples"><bdi class="secno">5.2.2 </bdi>Examples (non-normative)</h4><a class="self-link" href="#resource-examples" aria-label="Permalink for Section 5.2.2"></a></div><p>The following is a non-normative example of a Resource with a <code>type</code> and a simple <code>id</code>:</p>
<div class="example" id="resource-example">
        <div class="marker">
    <a class="self-link" href="#resource-example">Example<bdi> 4</bdi></a><span class="example-title">: Example Resource</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"book"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"123"</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<p>The following is a non-normative example of a Resource containing a <code>library_record</code> property, that is itself an object:</p>
<div class="example" id="resource-example-structured">
        <div class="marker">
    <a class="self-link" href="#resource-example-structured">Example<bdi> 5</bdi></a><span class="example-title">: Example Resource with Additional Property</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"book"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"123"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"library_record"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"AuthZEN in Action"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"isbn"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"978-0593383322"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

</section></section><section id="action-0"><div class="header-wrapper"><h3 id="action"><bdi class="secno">5.3 </bdi>Action</h3><a class="self-link" href="#action" aria-label="Permalink for Section 5.3"></a></div><p>An Action is the type of access that the requester intends to perform.</p>
<p>Action is an object that contains a <em class="rfc2119">REQUIRED</em> <code>name</code> key with a string value, and an <em class="rfc2119">OPTIONAL</em> <code>properties</code> key with an object value.</p>
<p><code>name</code>:
: <em class="rfc2119">REQUIRED</em>. A string value containing the name of the Action.</p>
<p><code>properties</code>:
: <em class="rfc2119">OPTIONAL</em>. An object which can be used to express additional attributes of an Action.</p>
<section id="action-properties-0"><div class="header-wrapper"><h4 id="action-properties"><bdi class="secno">5.3.1 </bdi>Action Properties</h4><a class="self-link" href="#action-properties" aria-label="Permalink for Section 5.3.1"></a></div><p>Similarly to the Subject and Resource properties, the PEP can also provide attributes for the Action in the properties field.</p>
<p>Such attributes can include, but are not limited to, parameters of the action that is being requested.</p>
<p><span class="nlgov-add">To increase interoperability, a few common properties are specified below:</span></p>
<section id="processing-activity-identifier"><div class="header-wrapper"><h5 id="x5-3-1-1-processing-activity-identifier"><bdi class="secno">5.3.1.1 </bdi><span class="nlgov-add">Processing Activity identifier</span></h5><a class="self-link" href="#processing-activity-identifier" aria-label="Permalink for Section 5.3.1.1"></a></div>
<p><span class="nlgov-add">Under Dutch and EU legislation, processing of personal data should be described in a Record of Processing Activities. In certain cases, e.g. when a single system processes data for multiple different processing activities, a relation to the processing activity <em class="rfc2119">MAY</em> be included.</span></p>
<p><span class="nlgov-add">When included, the reference to the processing activity <em class="rfc2119">SHOULD</em> be included using the following key:</span></p>
<p><span class="nlgov-add"><code>processing_activity_id</code>:
: <em class="rfc2119">REQUIRED</em>. A string value containing the URI of the processing activity within a Processing Activity registry. </span></p>
<p><span class="nlgov-add"></span></p><div class="note" role="note" id="issue-container-generatedID"><div role="heading" class="note-title marker" id="h-note" aria-level="6"><span>Note</span></div><p class="">The processing activity identifier should only be used within the context of an organization and <em class="rfc2119">SHOULD NOT</em> cross organizational boundaries.</p></div><p></p>
</section><section id="algorithm-identifier"><div class="header-wrapper"><h5 id="x5-3-1-2-algorithm-identifier"><bdi class="secno">5.3.1.2 </bdi><span class="nlgov-add">Algorithm identifier</span></h5><a class="self-link" href="#algorithm-identifier" aria-label="Permalink for Section 5.3.1.2"></a></div>
<p><span class="nlgov-add">When data is processed as part of an algorithm in a public registry, such as <a href="https://algoritmes.overheid.nl/">"Het Algoritmeregister"</a>, a reference to the relevant algorithm <em class="rfc2119">MAY</em> be included.</span></p>
<p><span class="nlgov-add">When included, the reference to the algorithm <em class="rfc2119">SHOULD</em> be included using the following key:</span></p>
<p><span class="nlgov-add"><code>algorithm_id</code>:
: <em class="rfc2119">REQUIRED</em>. A string value containing the URI of the algorithm in an algorithm registry.</span></p>
<p><span class="nlgov-add"></span></p><div class="note" role="note" id="issue-container-generatedID-0"><div role="heading" class="note-title marker" id="h-note-0" aria-level="6"><span>Note</span></div><p class="">The algorithm identifier should only be used within the context of an organization and <em class="rfc2119">SHOULD NOT</em> cross organizational boundaries.</p></div><p></p>
</section></section><section id="examples-non-normative-1"><div class="header-wrapper"><h4 id="action-examples"><bdi class="secno">5.3.2 </bdi>Examples (non-normative)</h4><a class="self-link" href="#action-examples" aria-label="Permalink for Section 5.3.2"></a></div><p>The following is a non-normative example of an action:</p>
<div class="example" id="action-example">
        <div class="marker">
    <a class="self-link" href="#action-example">Example<bdi> 6</bdi></a><span class="example-title">: Example Action</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"can_read"</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<p>The following is a non-normative example of an action with additional properties:</p>
<div class="example" id="action-extend-loan-example">
        <div class="marker">
    <a class="self-link" href="#action-extend-loan-example">Example<bdi> 7</bdi></a><span class="example-title">: Example Action with properties for extending a book loan.</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"extend-loan"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"period"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2W"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

</section></section><section id="context-0"><div class="header-wrapper"><h3 id="context"><bdi class="secno">5.4 </bdi>Context</h3><a class="self-link" href="#context" aria-label="Permalink for Section 5.4"></a></div><p>The Context represents the environment of the access evaluation request.</p>
<p>Context is an object which can be used to express attributes of the environment.</p>
<p>Examples of context attributes can include, but are not limited to:</p>
<ul>
<li>The time of day,</li>
<li>Location from which the request was received,</li>
<li>Capabilities of the PEP,</li>
<li>JSON Schema or JSON-LD definitions for the request.</li>
</ul>
<section id="context-properties"><div class="header-wrapper"><h4 id="x5-4-1-context-properties"><bdi class="secno">5.4.1 </bdi><span class="nlgov-add">Context Properties</span></h4><a class="self-link" href="#context-properties" aria-label="Permalink for Section 5.4.1"></a></div>
<p><span class="nlgov-add">Context <em class="rfc2119">MAY</em> include zero or more additional attributes as key-value pairs.</span></p>
<p><span class="nlgov-add">To increase interoperability, a few common properties are specified below:</span></p>
<section id="time"><div class="header-wrapper"><h5 id="x5-4-1-1-time"><bdi class="secno">5.4.1.1 </bdi><span class="nlgov-add">Time</span></h5><a class="self-link" href="#time" aria-label="Permalink for Section 5.4.1.1"></a></div>
<p><span class="nlgov-add">The logical time at which the action was considered to be initiated, identified by the <code>time</code> field, whose value is a textual representation of the time as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3339" title="Date and Time on the Internet: Timestamps">RFC3339</a></cite>].</span></p>
<p><span class="nlgov-add">This timestamp <em class="rfc2119">SHOULD</em> be used when a PDP evaluates the access request uses information from data sources that support temporal queries. See for example the <cite><a data-matched-text="[[[?ADR]]]" href="https://gitdocumentatie.logius.nl/publicatie/api/adr/2.0">API Design Rules</a></cite> and its <a href="https://docs.geostandaarden.nl/api/API-Strategie-ext/#temporal">temporal extension</a>.</span></p>
</section><section id="w3c-trace-context"><div class="header-wrapper"><h5 id="x5-4-1-2-w3c-trace-context"><bdi class="secno">5.4.1.2 </bdi><span class="nlgov-add">W3C Trace Context</span></h5><a class="self-link" href="#w3c-trace-context" aria-label="Permalink for Section 5.4.1.2"></a></div>
<p><span class="nlgov-add">To enable tracing of requests, request identifiers <em class="rfc2119">SHOULD</em> be included in the evaluation request. Request identifiers <em class="rfc2119">SHOULD</em> be included in the Context object. They <em class="rfc2119">SHOULD</em> be in the form of <code>tracestate</code> and <code>traceparent</code> values as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-trace-context-1" title="Trace Context">trace-context-1</a></cite>].</span></p>
<p><span class="nlgov-add">When included, the W3C Trace Context <em class="rfc2119">SHOULD</em> be included in the Context object using the following keys:</span></p>
<p><span class="nlgov-add"><code>traceparent</code>:
: <em class="rfc2119">REQUIRED</em>. An string value containing a value as defined in Section 3.2.2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-trace-context-1" title="Trace Context">trace-context-1</a></cite>]</span></p>
<p><span class="nlgov-add"><code>tracestate</code>:
: <em class="rfc2119">REQUIRED</em>. An string value containing a value as defined in Section 3.3.1.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-trace-context-1" title="Trace Context">trace-context-1</a></cite>]</span></p>
</section><section id="verifiable-claims"><div class="header-wrapper"><h5 id="x5-4-1-3-verifiable-claims"><bdi class="secno">5.4.1.3 </bdi><span class="nlgov-add">Verifiable claims</span></h5><a class="self-link" href="#verifiable-claims" aria-label="Permalink for Section 5.4.1.3"></a></div>
<p><span class="nlgov-add">As described in <a href="#security-trust" data-matched-text="[[[#security-trust]]]" class="sec-ref"><bdi class="secno">11.4 </bdi>Trust</a>, it is recommended to consider values in the information model as trusted and valid. For purposes of defense-in-depth and traceability, verifiable claims for values in the information model <em class="rfc2119">MAY</em> be provided. The verifiable claims <em class="rfc2119">MAY</em> use standards such as, but not limited to, SAML ([<cite><a class="bibref" data-link-type="biblio" href="#bib-saml2-core" title="Assertions and Protocols for SAML V2.0">SAML2-CORE</a></cite>]), Oauth ([<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>]), and Verifiable Credentials ([<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-model-2.0" title="Verifiable Credentials Data Model v2.0">vc-data-model-2.0</a></cite>]).</span></p>
</section><section id="meta-information-model"><div class="header-wrapper"><h5 id="context-mim"><bdi class="secno">5.4.1.4 </bdi><span class="nlgov-add">Meta-information Model</span></h5><a class="self-link" href="#context-mim" aria-label="Permalink for Section 5.4.1.4"></a></div>

<p><span class="nlgov-add">It is <em class="rfc2119">RECOMMENDED</em> to make the information model self-describing by including a URL to the meta-information model <a href="#information-model" data-matched-text="[[[#information-model]]]" class="sec-ref"><bdi class="secno">5. </bdi>Information Model</a> in the context.</span></p>
<p><span class="nlgov-add">When included, the meta-information model <em class="rfc2119">SHOULD</em> be included in Context object as the following key</span></p>
<p><span class="nlgov-add"><code>mim</code>:
: <em class="rfc2119">REQUIRED</em>. A string value containing a URL that links to the meta-information model for the request. </span></p>
</section><section id="linked-data-context"><div class="header-wrapper"><h5 id="context-ld"><bdi class="secno">5.4.1.5 </bdi><span class="nlgov-add">Linked Data context</span></h5><a class="self-link" href="#context-ld" aria-label="Permalink for Section 5.4.1.5"></a></div>

<p><span class="nlgov-add">When a transport (<a href="#transport" data-matched-text="[[[#transport]]]" class="sec-ref"><bdi class="secno">10. </bdi>Transport</a>) does not use a Linked Data format as its serialization, the Context <em class="rfc2119">SHOULD</em> include a URL to a resource, called the "Linked Data context" that allows the information model to be converted to a Linked Data representation. </span></p>
<p><span class="nlgov-add"></span></p><div class="note" role="note" id="issue-container-generatedID-1"><div role="heading" class="note-title marker" id="h-note-1" aria-level="6"><span>Note</span></div><p class="">The Linked Data context is <em>not</em> the same as the Context object. The Context object describes the context in which an evaluation request takes place. The Linked Data context describes how to convert the <em>entire</em> request, containing a Subject, Action, Resource and Context object, to a Linked Data representation.</p></div><p></p>
<p><span class="nlgov-add">When included, the Linked Data context <em class="rfc2119">SHOULD</em> be included in Context object as the following key:</span></p>
<p><span class="nlgov-add"><code>ld-context</code>:
: <em class="rfc2119">REQUIRED</em>. An object that provides context for mapping the serialized information model to Linked Data, or a string value containing a URL from which the mapping can be retrieved.</span></p>
<p><span class="nlgov-add">When serializing the information model to JSON it is <em class="rfc2119">RECOMMENDED</em> to use [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11" title="JSON-LD 1.1">JSON-LD11</a></cite>] to provide the Linked Data context. In that case, the value of the <code>ld-context</code> key should be considered as the value of the <code>@context</code> key at top-level.</span></p>
</section></section><section id="examples-non-normative-2"><div class="header-wrapper"><h4 id="context-examples"><bdi class="secno">5.4.2 </bdi>Examples (non-normative)</h4><a class="self-link" href="#context-examples" aria-label="Permalink for Section 5.4.2"></a></div><p>The following is a non-normative example of a Context:</p>
<div class="example" id="context-example">
        <div class="marker">
    <a class="self-link" href="#context-example">Example<bdi> 8</bdi></a><span class="example-title">: Example Context</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"time"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1985-10-26T01:22-07:00"</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

</section></section><section id="decision-0"><div class="header-wrapper"><h3 id="decision"><bdi class="secno">5.5 </bdi>Decision</h3><a class="self-link" href="#decision" aria-label="Permalink for Section 5.5"></a></div><p>A Decision is the result of the evaluation of an access request. It provides the information required for the PEP to enforce the decision.</p>
<p>Decision is an object that contains a <em class="rfc2119">REQUIRED</em> <code>decision</code> key with a <code>boolean</code> value, and an <em class="rfc2119">OPTIONAL</em> <code>context</code> key with an object value.</p>
<p><code>decision</code>:
: <em class="rfc2119">REQUIRED</em>. A boolean value that specifies whether the Decision is to allow or deny the operation.</p>
<p><code>context</code>:
: <em class="rfc2119">OPTIONAL</em>. An object which can convey additional information that can be used by the PEP as part of the decision enforcement process.</p>
<p>In this specification, assuming the evaluation was successful, there are only two possible values for the <code>decision</code>:</p>
<ul>
<li><code>true</code>: The access request is permitted to go forward. If the PEP does not understand information in the <code>context</code> response object, the PEP <em class="rfc2119">MAY</em> choose to reject the decision.</li>
<li><code>false</code>: The access request is denied and <em class="rfc2119">MUST NOT</em> be permitted to go forward.</li>
</ul>
<p>The following is a non-normative example of a minimal Decision:</p>
<div class="example" id="decision-example">
        <div class="marker">
    <a class="self-link" href="#decision-example">Example<bdi> 9</bdi></a><span class="example-title">: Example Decision</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<section id="decision-context-0"><div class="header-wrapper"><h4 id="decision-context"><bdi class="secno">5.5.1 </bdi>Decision Context</h4><a class="self-link" href="#decision-context" aria-label="Permalink for Section 5.5.1"></a></div><p>In addition to a <code>decision</code>, a response <em class="rfc2119">MAY</em> contain a <code>context</code> field which contains an object. This context can convey additional information that can be used by the PEP as part of the decision enforcement process.</p>
<p>Examples include, but are not limited to:</p>
<ul>
<li>Reason(s) a decision was made,</li>
<li>"Advices" and/or "Obligations" tied to the access decision,</li>
<li>Hints for rendering UI state,</li>
<li>Instructions for step-up authentication,</li>
<li>Environmental information,</li>
<li>etc.</li>
</ul>
</section><section id="examples-non-normative-3"><div class="header-wrapper"><h4 id="decision-examples"><bdi class="secno">5.5.2 </bdi>Examples (non-normative)</h4><a class="self-link" href="#decision-examples" aria-label="Permalink for Section 5.5.2"></a></div><p>The following are all non-normative examples of possible and valid contexts, provided to illustrate possible usages. The actual semantics and format of the <code>context</code> object are an implementation concern and outside the scope of this specification. For example, implementations <em class="rfc2119">MAY</em> use keys that correspond to concepts from other standards, such as HTTP status codes, to convey common reasons in an interoperable manner.</p>
<section id="non-normative-example-1-conveying-decision-reasons"><div class="header-wrapper"><h5 id="x5-5-2-1-non-normative-example-1-conveying-decision-reasons"><bdi class="secno">5.5.2.1 </bdi>Non-normative Example 1: conveying decision Reasons</h5><a class="self-link" href="#non-normative-example-1-conveying-decision-reasons" aria-label="Permalink for Section 5.5.2.1"></a></div>
<p>The PDP may provide reasons to explain a decision. In the non-normative example below, an implementation might convey different reasons to administrators and end-users, using keys that could correspond to HTTP status codes:</p>
<div class="example" id="response-with-reason-context-example">
        <div class="marker">
    <a class="self-link" href="#response-with-reason-context-example">Example<bdi> 10</bdi></a><span class="example-title">: Non-normative Example Response with reason Context</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"reason_admin"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"403"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Request failed policy C076E82F"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"reason_user"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"403"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Insufficient privileges. Contact your administrator"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

</section><section id="non-normative-example-2-conveying-metadata-and-environmental-elements"><div class="header-wrapper"><h5 id="x5-5-2-2-non-normative-example-2-conveying-metadata-and-environmental-elements"><bdi class="secno">5.5.2.2 </bdi>Non-normative Example 2: conveying metadata and environmental elements</h5><a class="self-link" href="#non-normative-example-2-conveying-metadata-and-environmental-elements" aria-label="Permalink for Section 5.5.2.2"></a></div>
<p>In the following non-normative example, the PDP justifies its decision by including environmental conditions that did not meet its policies. Metadata pertaining to the decision response times is also provided:</p>
<div class="example" id="response-with-environment-context-example">
        <div class="marker">
    <a class="self-link" href="#response-with-environment-context-example">Example<bdi> 11</bdi></a><span class="example-title">: Non-normative Example Response with Environment and Metadata Context</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"metadata"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"response-time"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">60</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"response-time-unit"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ms"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"environment"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"ip"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"10.10.0.1"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"datetime"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025-06-27T18:03:07Z"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"os"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ubuntu24.04.2LTS-AMDx64"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

</section><section id="non-normative-example-3-requesting-step-up-authentication"><div class="header-wrapper"><h5 id="x5-5-2-3-non-normative-example-3-requesting-step-up-authentication"><bdi class="secno">5.5.2.3 </bdi>Non-normative Example 3: requesting step-up authentication</h5><a class="self-link" href="#non-normative-example-3-requesting-step-up-authentication" aria-label="Permalink for Section 5.5.2.3"></a></div>
<p>In the following non-normative example, the PDP requests a step-up authentication of the requesting subject, by signalling the required <code>acr</code> and <code>amr</code> access token claim values it expects to see in order to approve the request:</p>
<div class="example" id="response-with-step-up-example">
        <div class="marker">
    <a class="self-link" href="#response-with-step-up-example">Example<bdi> 12</bdi></a><span class="example-title">: Non-normative Example Response with a step-up request Context</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"acr_values"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"urn:com:example:loa:3"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"amr_values"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"mfa hwk"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div></section></section></section></section>
  <section id="access-evaluation-api-0"><div class="header-wrapper"><h2 id="access-evaluation-api"><bdi class="secno">6. </bdi>Access Evaluation API</h2><a class="self-link" href="#access-evaluation-api" aria-label="Permalink for Section 6."></a></div><p>The Access Evaluation API defines the message exchange pattern between a PEP and a PDP for executing a single access evaluation.</p>
<section id="the-access-evaluation-api-request"><div class="header-wrapper"><h3 id="access-evaluation-request"><bdi class="secno">6.1 </bdi>The Access Evaluation API Request</h3><a class="self-link" href="#access-evaluation-request" aria-label="Permalink for Section 6.1"></a></div><p>The Access Evaluation request is an object consisting of four entities previously defined in the Information Model (<a href="#information-model" data-matched-text="[[[#information-model]]]" class="sec-ref"><bdi class="secno">5. </bdi>Information Model</a>):</p>
<p><code>subject</code>:
: <em class="rfc2119">REQUIRED</em>. The subject (or principal) of type Subject</p>
<p><code>action</code>:
: <em class="rfc2119">REQUIRED</em>. The action (or verb) of type Action.</p>
<p><code>resource</code>:
: <em class="rfc2119">REQUIRED</em>. The resource of type Resource.</p>
<p><code>context</code>:
: <em class="rfc2119">OPTIONAL</em>. The context (or environment) of type Context.</p>
<section id="example-non-normative"><div class="header-wrapper"><h4 id="x6-1-1-example-non-normative"><bdi class="secno">6.1.1 </bdi>Example (non-normative)</h4><a class="self-link" href="#example-non-normative" aria-label="Permalink for Section 6.1.1"></a></div>
<div class="example" id="request-example">
        <div class="marker">
    <a class="self-link" href="#request-example">Example<bdi> 13</bdi></a><span class="example-title">: Example Request</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice@example.com"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"account"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"123"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"can_read"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"method"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"GET"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"time"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1985-10-26T01:22-07:00"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

</section></section><section id="the-access-evaluation-api-response"><div class="header-wrapper"><h3 id="access-evaluation-response"><bdi class="secno">6.2 </bdi>The Access Evaluation API Response</h3><a class="self-link" href="#access-evaluation-response" aria-label="Permalink for Section 6.2"></a></div><p>The response of the Access Evaluation API consists of the Decision entity as defined in the Information Model (<a href="#information-model" data-matched-text="[[[#information-model]]]" class="sec-ref"><bdi class="secno">5. </bdi>Information Model</a>).</p>
</section></section>
  <section id="access-evaluations-api-0"><div class="header-wrapper"><h2 id="access-evaluations-api"><bdi class="secno">7. </bdi>Access Evaluations API</h2><a class="self-link" href="#access-evaluations-api" aria-label="Permalink for Section 7."></a></div><p>The Access Evaluations API defines the message exchange pattern between a PEP and a PDP for evaluating multiple access evaluations within the scope of a single message exchange (also known as "boxcarring" requests).</p>
<section id="the-access-evaluations-api-request"><div class="header-wrapper"><h3 id="access-evaluations-request"><bdi class="secno">7.1 </bdi>The Access Evaluations API Request</h3><a class="self-link" href="#access-evaluations-request" aria-label="Permalink for Section 7.1"></a></div><p>The Access Evaluation API Request builds on the information model presented in <a href="#information-model" data-matched-text="[[[#information-model]]]" class="sec-ref"><bdi class="secno">5. </bdi>Information Model</a> and the object defined in the Access Evaluation Request (<a href="#access-evaluation-request" data-matched-text="[[[#access-evaluation-request]]]" class="sec-ref"><bdi class="secno">6.1 </bdi>The Access Evaluation API Request</a>).</p>
<p>To send multiple access evaluation requests in a single message, the PEP <em class="rfc2119">MAY</em> add an <code>evaluations</code> key to the request. The <code>evaluations</code> key is an array which contains a list of objects, each typed as the object as defined in the Access Evaluation Request (<a href="#access-evaluation-request" data-matched-text="[[[#access-evaluation-request]]]" class="sec-ref"><bdi class="secno">6.1 </bdi>The Access Evaluation API Request</a>), and specifying a discrete request.</p>
<p>If an <code>evaluations</code> array is NOT present or is empty, the Access Evaluations Request behaves in a backwards-compatible manner with the (single) Access Evaluation API Request (<a href="#access-evaluation-request" data-matched-text="[[[#access-evaluation-request]]]" class="sec-ref"><bdi class="secno">6.1 </bdi>The Access Evaluation API Request</a>).</p>
<p>If an <code>evaluations</code> array IS present and contains one or more objects, these form distinct requests that the PDP will evaluate. These requests are independent from each other, and may be executed sequentially or in parallel, left to the discretion of each implementation.</p>
<p>The top-level <code>subject</code>, <code>action</code>, <code>resource</code>, and <code>context</code> keys provide default values for their respective fields in the <code>evaluations</code> array.  The top-level <code>subject</code>, <code>action</code> and <code>resource</code> keys <em class="rfc2119">MAY</em> be omitted if the <code>evaluations</code> array is present, contains one or more objects, and every object in the <code>evaluations</code> array contains the respective top-level key. This behavior is described in <a href="#default-values" data-matched-text="[[[#default-values]]]" class="sec-ref"><bdi class="secno">7.1.1 </bdi>Default values</a>.</p>
<p>The following is a non-normative example for specifying three requests, with no default values:</p>
<div class="example" id="example-14">
        <div class="marker">
    <a class="self-link" href="#example-14">Example<bdi> 14</bdi></a>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"evaluations"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice@example.com"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"can_read"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"document"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"boxcarring.md"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"time"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2024-05-31T15:22-07:00"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice@example.com"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"can_read"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"document"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"subject-search.md"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"time"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2024-05-31T15:22-07:00"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice@example.com"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"can_read"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"document"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"resource-search.md"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"time"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2024-05-31T15:22-07:00"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<section id="default-values-0"><div class="header-wrapper"><h4 id="default-values"><bdi class="secno">7.1.1 </bdi>Default values</h4><a class="self-link" href="#default-values" aria-label="Permalink for Section 7.1.1"></a></div><p>While the example above provides the most flexibility in specifying distinct values in each request for every evaluation, it is common for boxcarred requests to share one or more values of the evaluation request. For example, evaluations <em class="rfc2119">MAY</em> all refer to a single subject, and/or have the same contextual (environmental) attributes.</p>
<p>Default values offer a more compact syntax that avoids unnecessary duplication of request data.</p>
<p>The top-level <code>subject</code>, <code>action</code>, <code>resource</code>, and <code>context</code> keys provide default values for each object in the evaluations array. Any of these keys specified within an individual evaluation object overrides the corresponding top-level default. Because <code>subject</code>, <code>action</code>, and <code>resource</code> are required for a valid evaluation, any of these keys omitted from an evaluation object <em class="rfc2119">MUST</em> be provided as a top-level key.</p>
<p>The following is a non-normative example for specifying three requests that refer to a single subject and context:</p>
<div class="example" id="example-15">
        <div class="marker">
    <a class="self-link" href="#example-15">Example<bdi> 15</bdi></a>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice@example.com"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"time"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2024-05-31T15:22-07:00"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"evaluations"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"can_read"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"document"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"boxcarring.md"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"can_read"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"document"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"subject-search.md"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"can_read"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"document"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"resource-search.md"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<p>The following is a non-normative example for specifying three requests that refer to a single <code>subject</code> and <code>context</code>, with a default value for <code>action</code>, that is overridden by the third request:</p>
<div class="example" id="example-16">
        <div class="marker">
    <a class="self-link" href="#example-16">Example<bdi> 16</bdi></a>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice@example.com"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"time"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2024-05-31T15:22-07:00"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"can_read"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"evaluations"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"document"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"boxcarring.md"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"document"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"subject-search.md"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"can_edit"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"document"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"resource-search.md"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

</section><section id="evaluations-options"><div class="header-wrapper"><h4 id="x7-1-2-evaluations-options"><bdi class="secno">7.1.2 </bdi>Evaluations options</h4><a class="self-link" href="#evaluations-options" aria-label="Permalink for Section 7.1.2"></a></div>
<p>The <code>evaluations</code> request payload includes an <em class="rfc2119">OPTIONAL</em> <code>options</code> key, with a value that is an object.</p>
<p>This provides a general-purpose mechanism for providing PEP-supplied metadata on how the request is to be executed.</p>
<p>One such option controls <em>evaluation semantics</em>, and is described in <a href="#evaluations-semantics" data-matched-text="[[[#evaluations-semantics]]]" class="sec-ref"><bdi class="secno">7.1.2.1 </bdi>Evaluations semantics</a>.</p>
<p>A non-normative example of the <code>options</code> field is shown below, following an <code>evaluations</code> array provided for the sake of completeness:</p>
<div class="example" id="example-17">
        <div class="marker">
    <a class="self-link" href="#example-17">Example<bdi> 17</bdi></a>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"evaluations"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"doc"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"doc"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"options"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"evaluations_semantic"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"execute_all"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"another_option"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"value"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<section id="evaluations-semantics-0"><div class="header-wrapper"><h5 id="evaluations-semantics"><bdi class="secno">7.1.2.1 </bdi>Evaluations semantics</h5><a class="self-link" href="#evaluations-semantics" aria-label="Permalink for Section 7.1.2.1"></a></div><p>By default, every request in the <code>evaluations</code> array is executed and a response returned in the same array order. This is the most common use-case for boxcarring multiple evaluation requests in a single payload.</p>
<p>This specification supports three evaluation semantics:</p>
<ol>
<li><em>Execute all of the requests (potentially in parallel), return all of the results.</em> Any failure can be denoted by <code>"decision": false</code> and <em class="rfc2119">MAY</em> provide a reason code in the context.</li>
<li><em>Deny on first denial (or failure).</em> This semantic could be desired if a PEP wants to issue a few requests in a particular order, with any denial (error, or <code>"decision": false</code>) "short-circuiting" the evaluations call and returning on the first denial. This essentially works like the <code>&amp;&amp;</code> operator in programming languages.</li>
<li><em>Permit on first permit.</em> This is the converse "short-circuiting" semantic, working like the <code>||</code> operator in programming languages.</li>
</ol>
<p>To select the desired evaluation semantic, a PEP can pass in <code>options.evaluations_semantic</code> with exactly one of the following values:</p>
<ul>
<li><code>execute_all</code></li>
<li><code>deny_on_first_deny</code></li>
<li><code>permit_on_first_permit</code></li>
</ul>
<p><code>execute_all</code> is the default semantic, so an <code>evaluations</code> request without the <code>options.evaluations_semantic</code> flag will execute using this semantic.</p>
<section id="example-evaluate-read-action-for-three-documents-using-all-three-semantics"><div class="header-wrapper"><h6 id="x7-1-2-1-1-example-evaluate-read-action-for-three-documents-using-all-three-semantics"><bdi class="secno">7.1.2.1.1 </bdi>Example: Evaluate <code>read</code> action for three documents using all three semantics</h6><a class="self-link" href="#example-evaluate-read-action-for-three-documents-using-all-three-semantics" aria-label="Permalink for Section 7.1.2.1.1"></a></div>
<p>Execute all requests:</p>
<div class="example" id="example-18">
        <div class="marker">
    <a class="self-link" href="#example-18">Example<bdi> 18</bdi></a>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice@example.com"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"read"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"options"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"evaluations_semantic"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"execute_all"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"evaluations"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"document"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"document"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"document"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"3"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<p>Response:</p>
<div class="example" id="example-19">
        <div class="marker">
    <a class="self-link" href="#example-19">Example<bdi> 19</bdi></a>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"evaluations"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<p>Deny on first deny:</p>
<div class="example" id="example-20">
        <div class="marker">
    <a class="self-link" href="#example-20">Example<bdi> 20</bdi></a>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice@example.com"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"read"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"options"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"evaluations_semantic"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"deny_on_first_deny"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"evaluations"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"document"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"document"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"document"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"3"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<p>Response:</p>
<div class="example" id="example-21">
        <div class="marker">
    <a class="self-link" href="#example-21">Example<bdi> 21</bdi></a>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"evaluations"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"200"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"deny_on_first_deny"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<p>Permit on first permit:</p>
<div class="example" id="example-22">
        <div class="marker">
    <a class="self-link" href="#example-22">Example<bdi> 22</bdi></a>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice@example.com"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"read"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"options"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"evaluations_semantic"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"permit_on_first_permit"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"evaluations"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"document"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"document"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"document"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"3"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<p>Response:</p>
<div class="example" id="example-23">
        <div class="marker">
    <a class="self-link" href="#example-23">Example<bdi> 23</bdi></a>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"evaluations"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

</section></section></section></section><section id="the-access-evaluations-api-response"><div class="header-wrapper"><h3 id="access-evaluations-response"><bdi class="secno">7.2 </bdi>The Access Evaluations API Response</h3><a class="self-link" href="#access-evaluations-response" aria-label="Permalink for Section 7.2"></a></div><p>Like the request format, the Access Evaluations Response format for an Access Evaluations Request adds an <code>evaluations</code> array that lists the decisions in the same order they were provided in the <code>evaluations</code> array in the request. Each value of the evaluations array is typed as a Decision as defined in the Information Model (<a href="#information-model" data-matched-text="[[[#information-model]]]" class="sec-ref"><bdi class="secno">5. </bdi>Information Model</a>).</p>
<p>In case the <code>evaluations</code> array is present, it is <em class="rfc2119">RECOMMENDED</em> that the <code>decision</code> key of the response be omitted. If present, it can be ignored by the PEP.</p>
<p>The following is a non-normative example of a Access Evaluations Response to an Access Evaluations Request containing three evaluation objects:</p>
<div class="example" id="example-24">
        <div class="marker">
    <a class="self-link" href="#example-24">Example<bdi> 24</bdi></a>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"evaluations"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"resource not found"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Subject is a viewer of the resource"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<section id="errors"><div class="header-wrapper"><h4 id="x7-2-1-errors"><bdi class="secno">7.2.1 </bdi>Errors</h4><a class="self-link" href="#errors" aria-label="Permalink for Section 7.2.1"></a></div>
<p>There are two types of errors, and they are handled differently:</p>
<ol>
<li>Transport-level errors, or errors that pertain to the entire payload.</li>
<li>Errors in individual evaluations.</li>
</ol>
<p>The first type of error is handled at the transport level. For example, for the HTTP binding, the 4XX and 5XX codes indicate a general error that pertains to the entire payload, as described in Transport (<a href="#transport" data-matched-text="[[[#transport]]]" class="sec-ref"><bdi class="secno">10. </bdi>Transport</a>).</p>
<p>The second type of error is handled at the payload level. Decisions default to <em>closed</em> (i.e. <code>false</code>), but the <code>context</code> field can include errors that are specific to that request.</p>
<p>The following is a non-normative example of a response to an Access Evaluations Request containing three evaluation objects, two of them demonstrating how errors can be returned for two of the evaluation requests:</p>
<div class="example" id="example-25">
        <div class="marker">
    <a class="self-link" href="#example-25">Example<bdi> 25</bdi></a>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"evaluations"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"error"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"status"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">404</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Resource not found"</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"decision"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Subject is a viewer of the resource"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div></section></section></section>
  <section id="search-apis"><div class="header-wrapper"><h2 id="search"><bdi class="secno">8. </bdi>Search APIs</h2><a class="self-link" href="#search" aria-label="Permalink for Section 8."></a></div><p>The Search APIs enable a PEP to discover the set of subjects, resources, or actions that are permitted within a specific authorization context. Their purpose is to return a list of authorized entities, rather than verify a single access request.</p>
<p>To perform a search, the PEP provides the Subject, Resource, Action, and Context entities defined in the Information Model (<a href="#information-model" data-matched-text="[[[#information-model]]]" class="sec-ref"><bdi class="secno">5. </bdi>Information Model</a>), but omits the unique identifier of the entity being queried. The PDP then responds with the set of authorized entities for the queried entity type which would be authorized according to the provided criteria.</p>
<section id="semantics"><div class="header-wrapper"><h3 id="search-semantics"><bdi class="secno">8.1 </bdi>Semantics</h3><a class="self-link" href="#search-semantics" aria-label="Permalink for Section 8.1"></a></div><p>A search is designed to return entities that would correspond to a permitted decision. Therefore, any result from a Search API, when subsequently used in an Access Evaluation API call, <em class="rfc2119">SHOULD</em> result in a <code>"decision": true</code> response. However, because the evaluation is implementation-specific and may depend on other variables (such as time), this outcome is not guaranteed.</p>
<p>In addition, it is <em class="rfc2119">RECOMMENDED</em> that a search be performed transitively, traversing intermediate attributes and/or relationships. For example, if user U is a member of group G, and group G is designated as a viewer on a document D, then a search for all subjects of type user that can view document D will include user U.</p>
</section><section id="pagination"><div class="header-wrapper"><h3 id="search-pagination"><bdi class="secno">8.2 </bdi>Pagination</h3><a class="self-link" href="#search-pagination" aria-label="Permalink for Section 8.2"></a></div><p>Search APIs can return large result sets. To manage this, a PDP <em class="rfc2119">MAY</em> support pagination, allowing a PEP to navigate and retrieve subsets of the total result set.</p>
<p>Pagination does not guarantee an atomic snapshot of the result set. Consequently, if items are added or removed while paginating, results <em class="rfc2119">MAY</em> be repeated or omitted between pages.</p>
<p>Pagination is based on the use of opaque tokens. A PEP makes an initial request for data by sending a query that does not contain a token. If the PDP determines that the result set contains too many results to fit in a single response, the PDP returns a partial result set and a token that the PEP can use to retrieve the next page of results.</p>
<p>A paginated response <em class="rfc2119">MUST</em> be clearly identified by the inclusion of a <code>page</code> object containing a non-empty, opaque <code>next_token</code>. This token is the signal to the PEP that more results are available.</p>
<p>To retrieve the next page, the PEP sends a subsequent request containing a <code>page</code> object with the <code>token</code> field set to the <code>next_token</code> value from the previous response. This process is repeated until the PDP returns a <code>page</code> object in which the value of the <code>next_token</code> field is an empty string, signaling the end of the result set.</p>
<p>When a request contains a token, all entities (e.g., <code>subject</code>, <code>resource</code>, <code>action</code>, <code>context</code>) and pagination parameters (e.g., <code>limit</code>)  <em class="rfc2119">MUST</em> be identical to the preceding request. PDPs <em class="rfc2119">SHOULD</em> return an error when any entity or parameter has been changed.</p>
<p>PEPs that wish to sequentially iterate through the entire result set <em class="rfc2119">SHOULD</em> use the core pagination mechanism described above, which is designed to work consistently across all PDPs that support the search APIs.</p>
<section id="paginated-requests"><div class="header-wrapper"><h4 id="search-pagination-request"><bdi class="secno">8.2.1 </bdi>Paginated Requests</h4><a class="self-link" href="#search-pagination-request" aria-label="Permalink for Section 8.2.1"></a></div><p>A Search API Request <em class="rfc2119">MAY</em> include a <code>page</code> object indicating which subset of the larger result set the PEP would like to receive.</p>
<p>The <code>page</code> object in a Search API Request consists of the following keys:</p>
<p><code>token</code>:
: <em class="rfc2119">OPTIONAL</em>. An opaque string value from the <code>next_token</code> of a previous response.</p>
<p><code>limit</code>:
: <em class="rfc2119">OPTIONAL</em>. A non-negative integer indicating the maximum number of results to return in the response.</p>
<p><code>properties</code>:
: <em class="rfc2119">OPTIONAL</em>. An object containing additional implementation-specific pagination request attributes, such as, but not limited to, sorting and filtering.</p>
<p>Apart from the <code>token</code>, all values from the initial request <em class="rfc2119">MUST</em> remain identical for subsequent pages. If a different value is provided mid-pagination the PDP <em class="rfc2119">SHOULD</em> return an error.</p>
<p>Additional keys <em class="rfc2119">MAY</em> be included in the <code>page</code> object. If they are, they <em class="rfc2119">MUST</em> be defined in a specification referenced in the AuthZEN Policy Decision Point Capabilities Registry (<a href="#iana-pdp-capabilities-registry" data-matched-text="[[[#iana-pdp-capabilities-registry]]]" class="sec-ref"><bdi class="secno">12.3 </bdi>AuthZEN Policy Decision Point Capabilities Registry</a>). Furthermore, the PDP <em class="rfc2119">MUST</em> declare support for the corresponding capability URN in its <code>supported_capabilities</code> metadata (<a href="#pdp-metadata-data-capabilities" data-matched-text="[[[#pdp-metadata-data-capabilities]]]" class="sec-ref"><bdi class="secno">9.1.2 </bdi>Capabilities Parameters</a>).</p>
</section><section id="paginated-responses"><div class="header-wrapper"><h4 id="search-pagination-response"><bdi class="secno">8.2.2 </bdi>Paginated Responses</h4><a class="self-link" href="#search-pagination-response" aria-label="Permalink for Section 8.2.2"></a></div><p>Any Search API Response <em class="rfc2119">MAY</em> include a <code>page</code> object, but if a response does not contain the entire result set, it <em class="rfc2119">MUST</em> include this object.</p>
<p>The <code>page</code> object contains the following keys:</p>
<p><code>next_token</code>:
: <em class="rfc2119">REQUIRED</em>. An opaque string value indicating the next page of results to return. If there are no more results after this page, its value <em class="rfc2119">MUST</em> be an empty string.</p>
<p><code>count</code>:
: <em class="rfc2119">OPTIONAL</em>. A non-negative integer indicating the number of results included in this response. When included at the start of a response, as described in the Search API Response (<a href="#search-response" data-matched-text="[[[#search-response]]]" class="sec-ref"><bdi class="secno">8.3 </bdi>The Search API Response</a>), this enables a PEP to display a progress indicator when processing large or slow responses.</p>
<p><code>total</code>:
: <em class="rfc2119">OPTIONAL</em>. A non-negative integer indicating the total number of results matching the query criteria at the time of the request. This value is not guaranteed to equal the total number of items returned across all pages if the underlying data set changes during pagination.</p>
<p><code>properties</code>:
: <em class="rfc2119">OPTIONAL</em>. An object containing additional pagination response attributes. Examples include, but are not limited to, estimated totals or the number of remaining results.</p>
</section><section id="examples-non-normative-4"><div class="header-wrapper"><h4 id="search-pagination-examples"><bdi class="secno">8.2.3 </bdi>Examples (non-normative)</h4><a class="self-link" href="#search-pagination-examples" aria-label="Permalink for Section 8.2.3"></a></div><p>The following is a non-normative example of a request-response cycle to retrieve a total of three results with a page size limit of two.</p>
<div class="example" id="search-pagination-token-initial-request">
        <div class="marker">
    <a class="self-link" href="#search-pagination-token-initial-request">Example<bdi> 26</bdi></a><span class="example-title">: Example initial Search API Request</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice@example.com"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"can_read"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"account"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"page"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"limit"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<div class="example" id="search-pagination-token-initial-response">
        <div class="marker">
    <a class="self-link" href="#search-pagination-token-initial-response">Example<bdi> 27</bdi></a><span class="example-title">: Example initial Search API Response</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"page"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"next_token"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"a3M9NDU2O3N6PTI="</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"count"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"total"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"results"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"account"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"123"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"account"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"456"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<div class="example" id="search-pagination-token-second-request">
        <div class="marker">
    <a class="self-link" href="#search-pagination-token-second-request">Example<bdi> 28</bdi></a><span class="example-title">: Example second Search API Request</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice@example.com"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"can_read"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"account"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"page"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"a3M9NDU2O3N6PTI="</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<div class="example" id="search-pagination-token-second-response">
        <div class="marker">
    <a class="self-link" href="#search-pagination-token-second-response">Example<bdi> 29</bdi></a><span class="example-title">: Example second Search API Response</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"page"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"next_token"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"count"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"total"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"results"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"account"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"789"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

</section></section><section id="the-search-api-response"><div class="header-wrapper"><h3 id="search-response"><bdi class="secno">8.3 </bdi>The Search API Response</h3><a class="self-link" href="#search-response" aria-label="Permalink for Section 8.3"></a></div><p>The response to a Search API Request always follows the same structure. Each Search API Response is a JSON object with the following keys:</p>
<p><code>page</code>:
: <em class="rfc2119">OPTIONAL</em>. An object providing pagination information, as defined in Paginated Responses (<a href="#search-pagination-response" data-matched-text="[[[#search-pagination-response]]]" class="sec-ref"><bdi class="secno">8.2.2 </bdi>Paginated Responses</a>). It is <em class="rfc2119">RECOMMENDED</em> that the <code>page</code> object be the first key in the response, as this allows a PEP to use the <code>count</code> value to display a progress indicator when processing large or slow responses.</p>
<p><code>context</code>:
: <em class="rfc2119">OPTIONAL</em>. An object that can convey additional information that can be used by the PEP, similar to its function in the Access Evaluation Response (see <a href="#access-evaluation-response" data-matched-text="[[[#access-evaluation-response]]]" class="sec-ref"><bdi class="secno">6.2 </bdi>The Access Evaluation API Response</a>).</p>
<p><code>results</code>:
: <em class="rfc2119">REQUIRED</em>. An array containing zero or more entities, as defined in the Information Model (<a href="#information-model" data-matched-text="[[[#information-model]]]" class="sec-ref"><bdi class="secno">5. </bdi>Information Model</a>). It <em class="rfc2119">MUST</em> contain only entities of the type being searched for (e.g., Subjects, Resources, or Actions).</p>
<p>The following is a non-normative example of a search response returning resources:</p>
<div class="example" id="search-response-example">
        <div class="marker">
    <a class="self-link" href="#search-response-example">Example<bdi> 30</bdi></a><span class="example-title">: Example Resource Search API Response</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"page"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"count"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"total"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">102</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"query_execution_time_ms"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">42</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"results"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"account"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"123"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"account"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"456"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

</section><section id="subject-search-api-0"><div class="header-wrapper"><h3 id="subject-search-api"><bdi class="secno">8.4 </bdi>Subject Search API</h3><a class="self-link" href="#subject-search-api" aria-label="Permalink for Section 8.4"></a></div><p>The Subject Search API returns all subjects of a given type that are permitted according to the provided Action (<a href="#action" data-matched-text="[[[#action]]]" class="sec-ref"><bdi class="secno">5.3 </bdi>Action</a>), Resource (<a href="#resource" data-matched-text="[[[#resource]]]" class="sec-ref"><bdi class="secno">5.2 </bdi>Resource</a>), and Context (<a href="#context" data-matched-text="[[[#context]]]" class="sec-ref"><bdi class="secno">5.4 </bdi>Context</a>).</p>
<section id="the-subject-search-api-request"><div class="header-wrapper"><h4 id="subject-search-request"><bdi class="secno">8.4.1 </bdi>The Subject Search API Request</h4><a class="self-link" href="#subject-search-request" aria-label="Permalink for Section 8.4.1"></a></div><p>The Subject Search request is an object consisting of the following entities:</p>
<p><code>subject</code>:
: <em class="rfc2119">REQUIRED</em>. The subject (or principal) of type Subject. The Subject <em class="rfc2119">MUST</em> contain a <code>type</code>, but the Subject <code>id</code> <em class="rfc2119">SHOULD</em> be omitted, and if present, <em class="rfc2119">MUST</em> be ignored.</p>
<p><code>action</code>:
: <em class="rfc2119">REQUIRED</em>. The action (or verb) of type Action.</p>
<p><code>resource</code>:
: <em class="rfc2119">REQUIRED</em>. The resource of type Resource.</p>
<p><code>context</code>:
: <em class="rfc2119">OPTIONAL</em>. Contextual data about the request.</p>
<p><code>page</code>:
: <em class="rfc2119">OPTIONAL</em>. A page object for paginated requests.</p>
</section><section id="example-non-normative-subject-search-example"><div class="header-wrapper"><h4 id="x8-4-2-example-non-normative-subject-search-example"><bdi class="secno">8.4.2 </bdi>Example (non-normative) {#subject-search-example"}</h4><a class="self-link" href="#example-non-normative-subject-search-example" aria-label="Permalink for Section 8.4.2"></a></div>
<p>The following payload defines a request for the subjects of type <code>user</code> that can perform the <code>can_read</code> action on the resource of type <code>account</code> and ID <code>123</code>.</p>
<div class="example" id="subject-search-request-example">
        <div class="marker">
    <a class="self-link" href="#subject-search-request-example">Example<bdi> 31</bdi></a><span class="example-title">: Example Subject Search API Request</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"can_read"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"account"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"123"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"time"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2024-10-26T01:22-07:00"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<p>The following payload defines a valid response to this request.</p>
<div class="example" id="subject-search-response-example">
        <div class="marker">
    <a class="self-link" href="#subject-search-response-example">Example<bdi> 32</bdi></a><span class="example-title">: Example Subject Search API Response</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"results"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice@example.com"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"bob@example.com"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

</section></section><section id="resource-search-api-0"><div class="header-wrapper"><h3 id="resource-search-api"><bdi class="secno">8.5 </bdi>Resource Search API</h3><a class="self-link" href="#resource-search-api" aria-label="Permalink for Section 8.5"></a></div><p>The Resource Search API returns all resources of a given type that are permitted according to the provided Action (<a href="#action" data-matched-text="[[[#action]]]" class="sec-ref"><bdi class="secno">5.3 </bdi>Action</a>), Subject (<a href="#subject" data-matched-text="[[[#subject]]]" class="sec-ref"><bdi class="secno">5.1 </bdi>Subject</a>), and Context (<a href="#context" data-matched-text="[[[#context]]]" class="sec-ref"><bdi class="secno">5.4 </bdi>Context</a>).</p>
<section id="the-resource-search-api-request"><div class="header-wrapper"><h4 id="resource-search-request"><bdi class="secno">8.5.1 </bdi>The Resource Search API Request</h4><a class="self-link" href="#resource-search-request" aria-label="Permalink for Section 8.5.1"></a></div><p>The Resource Search request is an object consisting of the following entities:</p>
<p><code>subject</code>:
: <em class="rfc2119">REQUIRED</em>. The subject (or principal) of type Subject.</p>
<p><code>action</code>:
: <em class="rfc2119">REQUIRED</em>. The action (or verb) of type Action.</p>
<p><code>resource</code>:
: <em class="rfc2119">REQUIRED</em>. The resource of type Resource. The Resource <em class="rfc2119">MUST</em> contain a <code>type</code>, but the Resource <code>id</code> <em class="rfc2119">SHOULD</em> be omitted, and if present, <em class="rfc2119">MUST</em> be ignored.</p>
<p><code>context</code>:
: <em class="rfc2119">OPTIONAL</em>. Contextual data about the request.</p>
<p><code>page</code>:
: <em class="rfc2119">OPTIONAL</em>. A page object for paginated requests.</p>
</section><section id="example-non-normative-resource-search-example"><div class="header-wrapper"><h4 id="x8-5-2-example-non-normative-resource-search-example"><bdi class="secno">8.5.2 </bdi>Example (non-normative) {#resource-search-example"}</h4><a class="self-link" href="#example-non-normative-resource-search-example" aria-label="Permalink for Section 8.5.2"></a></div>
<p>The following payload defines a request for the resources of type <code>account</code> on which the subject of type <code>user</code> and ID <code>alice@example.com</code> can perform the <code>can_read</code> action.</p>
<div class="example" id="resource-search-request-example">
        <div class="marker">
    <a class="self-link" href="#resource-search-request-example">Example<bdi> 33</bdi></a><span class="example-title">: Example Resource Search API Request</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice@example.com"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"can_read"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"account"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<p>The following payload defines a valid response to this request.</p>
<div class="example" id="resource-search-response-example">
        <div class="marker">
    <a class="self-link" href="#resource-search-response-example">Example<bdi> 34</bdi></a><span class="example-title">: Example Resource Search API Response</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"results"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"account"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"123"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"account"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"456"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

</section></section><section id="action-search-api-0"><div class="header-wrapper"><h3 id="action-search-api"><bdi class="secno">8.6 </bdi>Action Search API</h3><a class="self-link" href="#action-search-api" aria-label="Permalink for Section 8.6"></a></div><p>The Action Search API returns all actions that are permitted according to the provided Subject (<a href="#subject" data-matched-text="[[[#subject]]]" class="sec-ref"><bdi class="secno">5.1 </bdi>Subject</a>), Resource (<a href="#resource" data-matched-text="[[[#resource]]]" class="sec-ref"><bdi class="secno">5.2 </bdi>Resource</a>), and Context (<a href="#context" data-matched-text="[[[#context]]]" class="sec-ref"><bdi class="secno">5.4 </bdi>Context</a>).</p>
<section id="the-action-search-api-request"><div class="header-wrapper"><h4 id="action-search-request"><bdi class="secno">8.6.1 </bdi>The Action Search API Request</h4><a class="self-link" href="#action-search-request" aria-label="Permalink for Section 8.6.1"></a></div><p>The Action Search request is an object consisting of the following entities:</p>
<p><code>subject</code>:
: <em class="rfc2119">REQUIRED</em>. The subject (or principal) of type Subject.</p>
<p><code>resource</code>:
: <em class="rfc2119">REQUIRED</em>. The resource of type Resource.</p>
<p><code>context</code>:
: <em class="rfc2119">OPTIONAL</em>. Contextual data about the request.</p>
<p><code>page</code>:
: <em class="rfc2119">OPTIONAL</em>. A page object for paginated requests.</p>
<div class="note" role="note" id="issue-container-generatedID-2"><div role="heading" class="note-title marker" id="h-note-2" aria-level="5"><span>Note</span></div><p class="">Unlike the Subject and Resource Search APIs, the <code>action</code> key is omitted from the Action Search request payload.</p></div>

</section><section id="example-non-normative-action-search-example"><div class="header-wrapper"><h4 id="x8-6-2-example-non-normative-action-search-example"><bdi class="secno">8.6.2 </bdi>Example (non-normative) {#action-search-example"}</h4><a class="self-link" href="#example-non-normative-action-search-example" aria-label="Permalink for Section 8.6.2"></a></div>
<p>The following payload defines a request for the actions that the subject of type <code>user</code> with ID <code>123</code> may perform on the resource of type <code>account</code> and ID <code>123</code> at 01:22 AM.</p>
<div class="example" id="action-search-request-example">
        <div class="marker">
    <a class="self-link" href="#action-search-request-example">Example<bdi> 35</bdi></a><span class="example-title">: Example Action Search API Request</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice@example.com"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"account"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"123"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"context"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"time"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2024-10-26T01:22-07:00"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div>

<p>The following payload defines a valid response to this request.</p>
<div class="example" id="action-search-response-example">
        <div class="marker">
    <a class="self-link" href="#action-search-response-example">Example<bdi> 36</bdi></a><span class="example-title">: Example Action Search API Response</span>
  </div> <pre aria-busy="false"><code class="hljs json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"results"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"can_read"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"can_write"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre>
      </div></section></section></section>
  <section id="policy-decision-point-metadata"><div class="header-wrapper"><h2 id="pdp-metadata"><bdi class="secno">9. </bdi>Policy Decision Point Metadata</h2><a class="self-link" href="#pdp-metadata" aria-label="Permalink for Section 9."></a></div><p>It is <em class="rfc2119">RECOMMENDED</em> that PDPs provide metadata describing their configuration.</p>
<section id="data-structure"><div class="header-wrapper"><h3 id="pdp-metadata-data"><bdi class="secno">9.1 </bdi>Data structure</h3><a class="self-link" href="#pdp-metadata-data" aria-label="Permalink for Section 9.1"></a></div><p>The following Policy Decision Point metadata parameters are used by this specification and are registered in the IANA "AuthZEN Policy Decision Point Metadata" registry established in <a href="#iana-pdp-metadata-registry" data-matched-text="[[[#iana-pdp-metadata-registry]]]" class="sec-ref"><bdi class="secno">12.1 </bdi>AuthZEN Policy Decision Point Metadata Registry</a>.</p>
<section id="endpoint-parameters"><div class="header-wrapper"><h4 id="pdp-metadata-data-endpoint"><bdi class="secno">9.1.1 </bdi>Endpoint Parameters</h4><a class="self-link" href="#pdp-metadata-data-endpoint" aria-label="Permalink for Section 9.1.1"></a></div><p><code>policy_decision_point</code>:
: <em class="rfc2119">REQUIRED</em>. The Policy Decision Point identifier, which is a URL that uses the "https" scheme and has no query or fragment components. Policy Decision Point metadata is published at a location that is ".well-known" according to [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8615" title="Well-Known Uniform Resource Identifiers (URIs)">RFC8615</a></cite>] derived from this Policy Decision Point identifier, as described in <a href="#pdp-metadata-access" data-matched-text="[[[#pdp-metadata-access]]]" class="sec-ref"><bdi class="secno">9.2 </bdi>Obtaining Policy Decision Point Metadata</a>. The Policy Decision Point identifier is used to prevent Policy Decision Point mix-up attacks.</p>
<p><code>access_evaluation_endpoint</code>:
: <em class="rfc2119">REQUIRED</em>. URL of Access Evaluation API endpoint</p>
<p><code>access_evaluations_endpoint</code>:
: <em class="rfc2119">OPTIONAL</em>. URL of Access Evaluations API endpoint</p>
<p><code>search_subject_endpoint</code>:
: <em class="rfc2119">OPTIONAL</em>. URL of Search API endpoint for subject entities</p>
<p><code>search_action_endpoint</code>:
: <em class="rfc2119">OPTIONAL</em>. URL of Search API endpoint for action entities</p>
<p><code>search_resource_endpoint</code>:
: <em class="rfc2119">OPTIONAL</em>. URL of Search API endpoint for resource entities</p>
<div class="note" role="note" id="issue-container-generatedID-3"><div role="heading" class="note-title marker" id="h-note-3" aria-level="5"><span>Note</span></div><p class="">The absence of any of these parameters is sufficient for the PEP to determine that the PDP is not capable and therefore will not return a result for the associated API.</p></div>

</section><section id="capabilities-parameters"><div class="header-wrapper"><h4 id="pdp-metadata-data-capabilities"><bdi class="secno">9.1.2 </bdi>Capabilities Parameters</h4><a class="self-link" href="#pdp-metadata-data-capabilities" aria-label="Permalink for Section 9.1.2"></a></div><p><code>capabilities</code>:
: <em class="rfc2119">OPTIONAL</em>. JSON array containing a list of registered IANA URNs referencing PDP specific capabilities.</p>
</section><section id="signature-parameter"><div class="header-wrapper"><h4 id="pdp-metadata-data-sig"><bdi class="secno">9.1.3 </bdi>Signature Parameter</h4><a class="self-link" href="#pdp-metadata-data-sig" aria-label="Permalink for Section 9.1.3"></a></div><p>In addition to JSON elements, metadata parameters <em class="rfc2119">MAY</em> also be provided as a <code>signed_metadata</code> value, which is a JSON Web Token [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7519" title="JSON Web Token (JWT)">RFC7519</a></cite>] that asserts metadata values about the PDP as a bundle. A set of metadata parameters that can be used in signed metadata as claims are defined in <a href="#pdp-metadata-data-endpoint" data-matched-text="[[[#pdp-metadata-data-endpoint]]]" class="sec-ref"><bdi class="secno">9.1.1 </bdi>Endpoint Parameters</a>. The signed metadata <em class="rfc2119">MUST</em> be digitally signed or MACed using JSON Web Signature [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7515" title="JSON Web Signature (JWS)">RFC7515</a></cite>] and <em class="rfc2119">MUST</em> contain an <code>iss</code> (issuer) claim denoting the party attesting to the claims in the signed metadata.</p>
<p>A PEP <em class="rfc2119">MAY</em> ignore the signed metadata if they do not support this feature. If the PEP supports signed metadata, metadata values conveyed in the signed metadata <em class="rfc2119">MUST</em> take precedence over the corresponding values conveyed using plain JSON elements. Signed metadata is included in the Policy Decision Point metadata JSON object using this <em class="rfc2119">OPTIONAL</em> metadata parameter:</p>
<p><code>signed_metadata</code>:
: A JWT containing metadata parameters about the protected resource as claims. This is a string value consisting of the entire signed JWT. A <code>signed_metadata</code> parameter <em class="rfc2119">SHOULD NOT</em> appear as a claim in the JWT; it is <em class="rfc2119">RECOMMENDED</em> to reject any metadata in which this occurs.</p>
</section></section><section id="obtaining-policy-decision-point-metadata"><div class="header-wrapper"><h3 id="pdp-metadata-access"><bdi class="secno">9.2 </bdi>Obtaining Policy Decision Point Metadata</h3><a class="self-link" href="#pdp-metadata-access" aria-label="Permalink for Section 9.2"></a></div><p>PDPs supporting metadata <em class="rfc2119">MUST</em> make a JSON document containing metadata as specified in the AuthZEN Policy Decision Point Metadata Registry (<a href="#iana-pdp-metadata-registry" data-matched-text="[[[#iana-pdp-metadata-registry]]]" class="sec-ref"><bdi class="secno">12.1 </bdi>AuthZEN Policy Decision Point Metadata Registry</a>) available at a URL formed by inserting a well-known URI string between the host component and the path and/or query components, if any. The well-known URI string used is <code>/.well-known/authzen-configuration</code>.</p>
<p>The syntax and semantics of .well-known are defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8615" title="Well-Known Uniform Resource Identifiers (URIs)">RFC8615</a></cite>]. The well-known URI path suffix used is registered in the <cite><a data-matched-text="[[[IANA.well-known-uris]]]" href="https://www.iana.org/assignments/well-known-uris/well-known-uris.xhtml">IANA "Well-Known URIs" registry</a></cite>.</p>
<p>An example of a PDP supporting multiple tenants will have a discovery endpoint as follows:</p>
<pre><code class="text hljs" aria-busy="false">https://pdp.example.com/.well-known/authzen-configuration/tenant1
</code></pre>
<section id="policy-decision-point-metadata-request"><div class="header-wrapper"><h4 id="pdp-metadata-access-request"><bdi class="secno">9.2.1 </bdi>Policy Decision Point Metadata Request</h4><a class="self-link" href="#pdp-metadata-access-request" aria-label="Permalink for Section 9.2.1"></a></div><p>A Policy Decision Point metadata document <em class="rfc2119">MUST</em> be queried using an HTTP GET request at the previously specified URL. The consumer of the metadata would make the following request when the resource identifier is <code>https://pdp.example.com</code>:</p>
<div class="example" id="example-37">
        <div class="marker">
    <a class="self-link" href="#example-37">Example<bdi> 37</bdi></a>
  </div> <pre aria-busy="false"><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/.well-known/authzen-configuration</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>pdp.example.com</code></pre>
      </div>

</section><section id="policy-decision-point-metadata-response"><div class="header-wrapper"><h4 id="pdp-metadata-access-response"><bdi class="secno">9.2.2 </bdi>Policy Decision Point Metadata Response</h4><a class="self-link" href="#pdp-metadata-access-response" aria-label="Permalink for Section 9.2.2"></a></div><p>The response is a set of metadata parameters about the protected resource's configuration.</p>
<p>A successful response <em class="rfc2119">MUST</em> use the HTTP status code <code>200</code> and a <code>Content-Type</code> of <code>application/json</code>. Its body <em class="rfc2119">MUST</em> be a JSON object that contains a set of metadata parameters as defined in the AuthZEN Policy Decision Point Metadata Registry (<a href="#iana-pdp-metadata-registry" data-matched-text="[[[#iana-pdp-metadata-registry]]]" class="sec-ref"><bdi class="secno">12.1 </bdi>AuthZEN Policy Decision Point Metadata Registry</a>).</p>
<p>Any metadata parameters in the response that are not understood by the PEP <em class="rfc2119">MUST</em> be ignored.</p>
<p>Parameters that have multiple values are represented as JSON arrays. Parameters that have no values <em class="rfc2119">MUST</em> be omitted from the response.</p>
<p>An error response uses the applicable HTTP status code value.</p>
<p>The following is a non-normative example response:</p>
<div class="example" id="example-38">
        <div class="marker">
    <a class="self-link" href="#example-38">Example<bdi> 38</bdi></a>
  </div> <pre aria-busy="false"><code class="hljs http"><span class="hljs-meta">HTTP/1.1</span> <span class="hljs-number">200</span> OK
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json

<span class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"policy_decision_point"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://pdp.example.com"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"access_evaluation_endpoint"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://pdp.example.com/access/v1/evaluation"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"search_subject_endpoint"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://pdp.example.com/access/v1/search/subject"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"search_resource_endpoint"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://pdp.example.com/access/v1/search/resource"</span>
<span class="hljs-punctuation">}</span></span></code></pre>
      </div>

</section><section id="policy-decision-point-metadata-validation"><div class="header-wrapper"><h4 id="pdp-metadata-data-endpoint-validation"><bdi class="secno">9.2.3 </bdi>Policy Decision Point Metadata Validation</h4><a class="self-link" href="#pdp-metadata-data-endpoint-validation" aria-label="Permalink for Section 9.2.3"></a></div><p>The <code>policy_decision_point</code> value returned <em class="rfc2119">MUST</em> be identical to the Policy Decision Point identifier value into which the well-known URI string was inserted to create the URL used to retrieve the metadata.  If these values are not identical, the data contained in the response <em class="rfc2119">MUST NOT</em> be used.</p>
<p>The recipient <em class="rfc2119">MUST</em> validate that any signed metadata was signed by a key belonging to the issuer and that the signature is valid. If the signature does not validate or the issuer is not trusted, the recipient <em class="rfc2119">SHOULD</em> treat this as an error condition.</p>
</section></section></section>
  <section id="transport-0"><div class="header-wrapper"><h2 id="transport"><bdi class="secno">10. </bdi>Transport</h2><a class="self-link" href="#transport" aria-label="Permalink for Section 10."></a></div><p>This specification defines an HTTPS binding using JSON serialization which <em class="rfc2119">MUST</em> be implemented by a compliant PDP.</p>
<p>Additional transport bindings (e.g. gRPC or CoAP) <em class="rfc2119">MAY</em> be defined in the future in the form of profiles, and <em class="rfc2119">MAY</em> be implemented by a PDP.</p>
<section id="https-json-binding"><div class="header-wrapper"><h3 id="transport-https-json"><bdi class="secno">10.1 </bdi>HTTPS JSON Binding</h3><a class="self-link" href="#transport-https-json" aria-label="Permalink for Section 10.1"></a></div><p>All API requests within this binding are made via an HTTPS <code>POST</code> request.</p>
<p>Requests <em class="rfc2119">MUST</em> include a <code>Content-Type</code> header with the value <code>application/json</code>, and the request body for each endpoint <em class="rfc2119">MUST</em> be a JSON object that conforms to the corresponding request structure, as defined in <a href="#table-api-endpoints" data-matched-text="[[[#table-api-endpoints]]]"></a>.</p>
<p>A successful response is an HTTPS response with a status code of <code>200</code> and a <code>Content-Type</code> of <code>application/json</code>. Its body is a JSON object that conforms to the corresponding response structure, as defined in <a href="#table-api-endpoints" data-matched-text="[[[#table-api-endpoints]]]"></a>.</p>
<p>The request URL <em class="rfc2119">MUST</em> be the value of the corresponding endpoint parameter, as defined in <a href="#table-api-endpoints" data-matched-text="[[[#table-api-endpoints]]]"></a>, if it is provided in the Policy Decision Point metadata (<a href="#pdp-metadata-data-endpoint" data-matched-text="[[[#pdp-metadata-data-endpoint]]]" class="sec-ref"><bdi class="secno">9.1.1 </bdi>Endpoint Parameters</a>). If the parameter is not provided, the URL <em class="rfc2119">SHOULD</em> be formed by appending the default path, as defined in <a href="#table-api-endpoints" data-matched-text="[[[#table-api-endpoints]]]"></a>, to the PDP's base URL (which is the <code>policy_decision_point</code> value from the Policy Decision Point metadata, if available.</p>
<p>The following table provides an overview of the API endpoints defined in this binding:</p>
<table id="table-api-endpoints" title="API Endpoint Overview">
    <tbody><tr>
        <td>API Endpoint</td>
        <td>Default Path</td>
        <td>Metadata Parameter</td>
        <td>Request Schema</td>
        <td>Response Schema</td>
    </tr>
    <tr>
        <td>Access Evaluation</td>
        <td>/access/v1/evaluation</td>
        <td>access_evaluation_endpoint</td>
        <td><a href="#access-evaluation-request" data-matched-text="[[[#access-evaluation-request]]]" class="sec-ref"><bdi class="secno">6.1 </bdi>The Access Evaluation API Request</a></td>
        <td><a href="#access-evaluation-response" data-matched-text="[[[#access-evaluation-response]]]" class="sec-ref"><bdi class="secno">6.2 </bdi>The Access Evaluation API Response</a></td>
    </tr>
    <tr>
        <td>Access Evaluations</td>
        <td>/access/v1/evaluations</td>
        <td>access_evaluations_endpoint</td>
        <td><a href="#access-evaluations-request" data-matched-text="[[[#access-evaluations-request]]]" class="sec-ref"><bdi class="secno">7.1 </bdi>The Access Evaluations API Request</a></td>
        <td><a href="#access-evaluations-response" data-matched-text="[[[#access-evaluations-response]]]" class="sec-ref"><bdi class="secno">7.2 </bdi>The Access Evaluations API Response</a></td>
    </tr>
    <tr>
        <td>Subject Search</td>
        <td>/access/v1/search/subject</td>
        <td>search_subject_endpoint</td>
        <td><a href="#subject-search-request" data-matched-text="[[[#subject-search-request]]]" class="sec-ref"><bdi class="secno">8.4.1 </bdi>The Subject Search API Request</a></td>
        <td><a href="#search-response" data-matched-text="[[[#search-response]]]" class="sec-ref"><bdi class="secno">8.3 </bdi>The Search API Response</a></td>
    </tr>
    <tr>
        <td>Resource Search</td>
        <td>/access/v1/search/resource</td>
        <td>search_resource_endpoint</td>
        <td><a href="#resource-search-request" data-matched-text="[[[#resource-search-request]]]" class="sec-ref"><bdi class="secno">8.5.1 </bdi>The Resource Search API Request</a></td>
        <td><a href="#search-response" data-matched-text="[[[#search-response]]]" class="sec-ref"><bdi class="secno">8.3 </bdi>The Search API Response</a></td>
    </tr>
    <tr>
        <td>Action Search</td>
        <td>/access/v1/search/action</td>
        <td>search_action_endpoint</td>
        <td><a href="#action-search-request" data-matched-text="[[[#action-search-request]]]" class="sec-ref"><bdi class="secno">8.6.1 </bdi>The Action Search API Request</a></td>
        <td><a href="#search-response" data-matched-text="[[[#search-response]]]" class="sec-ref"><bdi class="secno">8.3 </bdi>The Search API Response</a></td>
    </tr>
</tbody></table>

<section id="json-serialization"><div class="header-wrapper"><h4 id="transport-https-json-serialization"><bdi class="secno">10.1.1 </bdi>JSON Serialization</h4><a class="self-link" href="#transport-https-json-serialization" aria-label="Permalink for Section 10.1.1"></a></div><p>This section specifies the serialization of the information model entities and API schemas defined in this document to the JSON format [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8259" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC8259</a></cite>]. The top-level element of all request and response bodies <em class="rfc2119">MUST</em> be a JSON object (Section 4 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8259" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC8259</a></cite>]). Implementations <em class="rfc2119">SHOULD</em> also adhere to the security recommendations in JSON Payload Considerations (<a href="#security-json" data-matched-text="[[[#security-json]]]" class="sec-ref"><bdi class="secno">11.5 </bdi>JSON Payload Considerations</a>).</p>
<p>The data types defined in this specification are mapped to JSON types as follows:</p>
<p>Object:
: Represented as a JSON object (Section 4 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8259" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC8259</a></cite>]). The values of its members can be any valid JSON value as defined in Section 3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8259" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC8259</a></cite>], including other objects and arrays, unless specified otherwise.</p>
<p>Array:
: Represented as a JSON array (Section 5 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8259" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC8259</a></cite>]).</p>
<p>String:
: Represented as a JSON string (Section 7 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8259" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC8259</a></cite>]).</p>
<p>Integer:
: Represented as a JSON number (Section 6 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8259" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC8259</a></cite>]). Note the recommendation in <a href="#security-json" data-matched-text="[[[#security-json]]]" class="sec-ref"><bdi class="secno">11.5 </bdi>JSON Payload Considerations</a> to not encode values that exceed IEEE 754 double-precision.</p>
<p>Boolean:
: Represented as the JSON literals <code>true</code> or <code>false</code> (Section 3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8259" title="The JavaScript Object Notation (JSON) Data Interchange Format">RFC8259</a></cite>]).</p>
</section><section id="error-responses"><div class="header-wrapper"><h4 id="x10-1-2-error-responses"><bdi class="secno">10.1.2 </bdi>Error Responses</h4><a class="self-link" href="#error-responses" aria-label="Permalink for Section 10.1.2"></a></div>
<p>The following error responses are common to all methods of the Authorization API. The error response is indicated by an HTTPS status code (Section 15 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9110" title="HTTP Semantics">RFC9110</a></cite>]) that indicates error.</p>
<p>The following errors are indicated by the status codes defined below:</p>
<table id="table-error-status-codes" title="HTTPS Error status codes">
    <tbody><tr>
        <td>Code</td>
        <td>Description</td>
        <td>HTTPS Body Content</td>
    </tr>
    <tr>
        <td>400</td>
        <td>Bad Request</td>
        <td>An error message string</td>
    </tr>
    <tr>
        <td>401</td>
        <td>Unauthorized</td>
        <td>An error message string</td>
    </tr>
    <tr>
        <td>403</td>
        <td>Forbidden</td>
        <td>An error message string</td>
    </tr>
    <tr>
        <td>500</td>
        <td>Internal Error</td>
        <td>An error message string</td>
    </tr>
</tbody></table>

<div class="note" role="note" id="issue-container-generatedID-4"><div role="heading" class="note-title marker" id="h-note-4" aria-level="5"><span>Note</span></div><p class="">HTTPS errors are returned by the PDP to indicate an error condition relating to the request or its processing; they are unrelated to the outcome of an authorization decision and are distinct from it. A successful request that results in a "deny" is indicated by a 200 OK status code with a { "decision": false } payload.</p></div>

<p>To make this concrete:</p>
<ul>
<li>a <code>401</code> HTTPS status code indicates that the PEP did not properly authenticate to the PDP - for example, by omitting a required <code>Authorization</code> header, or using an invalid access token.</li>
<li>the PDP indicates to the PEP that the authorization request is denied by sending a response with a <code>200</code> HTTPS status code, along with a payload of <code>{ "decision": false }</code>.</li>
</ul>
</section><section id="request-identification"><div class="header-wrapper"><h4 id="x10-1-3-request-identification"><bdi class="secno">10.1.3 </bdi>Request Identification</h4><a class="self-link" href="#request-identification" aria-label="Permalink for Section 10.1.3"></a></div>
<p>All requests to the API <em class="rfc2119">MAY</em> have request identifiers to uniquely identify them. The PEP is responsible for generating the request identifier. If present, it is <em class="rfc2119">RECOMMENDED</em> to use the HTTPS Header <code>X-Request-ID</code> as the request identifier. The value of this header is an arbitrary string. The following non-normative example describes this header:</p>
<div class="example" id="request-id-example">
        <div class="marker">
    <a class="self-link" href="#request-id-example">Example<bdi> 39</bdi></a><span class="example-title">: Example HTTPS request with a Request Id Header</span>
  </div> <pre aria-busy="false"><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/access/v1/evaluation</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Authorization</span><span class="hljs-punctuation">: </span>Bearer mF_9.B5f-4.1JqM
<span class="hljs-attribute">X-Request-ID</span><span class="hljs-punctuation">: </span>bfe9eb29-ab87-4ca3-be83-a1d5d8305716</code></pre>
      </div>

<p>When an Authorization API request contains a request identifier the PDP <em class="rfc2119">MUST</em> include a request identifier in the response. It is <em class="rfc2119">RECOMMENDED</em> to specify the request identifier using the HTTPS Response header <code>X-Request-ID</code>. If the PEP specified a request identifier in the request, the PDP <em class="rfc2119">MUST</em> include the same identifier in the response to that request.</p>
<p>The following is a non-normative example of an HTTPS Response with this header:</p>
<div class="example" id="example-response-request-id">
        <div class="marker">
    <a class="self-link" href="#example-response-request-id">Example<bdi> 40</bdi></a><span class="example-title">: Example HTTPS response with a Request Id Header</span>
  </div> <pre class="http" aria-busy="false"><code class="hljs">HTTP/1.1 OK
Content-Type: application/json
X-Request-ID: bfe9eb29-ab87-4ca3-be83-a1d5d8305716</code></pre>
      </div>

</section><section id="examples-non-normative-5"><div class="header-wrapper"><h4 id="x10-1-4-examples-non-normative"><bdi class="secno">10.1.4 </bdi>Examples (non-normative)</h4><a class="self-link" href="#examples-non-normative-5" aria-label="Permalink for Section 10.1.4"></a></div>
<p>The following is a non-normative example of the HTTPS binding of the Access Evaluation Request:</p>
<div class="example" id="example-access-evaluation-request">
        <div class="marker">
    <a class="self-link" href="#example-access-evaluation-request">Example<bdi> 41</bdi></a><span class="example-title">: Example of an HTTPS Access Evaluation Request</span>
  </div> <pre aria-busy="false"><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/access/v1/evaluation</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>pdp.example.com
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json
<span class="hljs-attribute">Authorization</span><span class="hljs-punctuation">: </span>Bearer 
<span class="hljs-attribute">X-Request-ID</span><span class="hljs-punctuation">: </span>bfe9eb29-ab87-4ca3-be83-a1d5d8305716

<span class="language-css">{
  "subject": {
    "type": <span class="hljs-string">"user"</span>,
    <span class="hljs-string">"id"</span>: <span class="hljs-string">"alice@example.com"</span>
  },
  "resource": {
    "type": <span class="hljs-string">"todo"</span>,
    <span class="hljs-string">"id"</span>: <span class="hljs-string">"1"</span>
  },
  "action": {
    "name": <span class="hljs-string">"can_read"</span>
  },
  "context": {
    "<span class="hljs-selector-tag">time</span>": <span class="hljs-string">"1985-10-26T01:22-07:00"</span>
  }
}
</span></code></pre>
      </div>

<p>The following is a non-normative example of an HTTPS Access Evaluation Response:</p>
<div class="example" id="example-access-evaluation-response">
        <div class="marker">
    <a class="self-link" href="#example-access-evaluation-response">Example<bdi> 42</bdi></a><span class="example-title">: Example of an HTTP Access Evaluation Response</span>
  </div> <pre class="http" aria-busy="false"><code class="hljs">HTTP/1.1 OK
Content-Type: application/json
X-Request-ID: bfe9eb29-ab87-4ca3-be83-a1d5d8305716

{
  "decision": true
}</code></pre>
      </div>

<p>The following is a non-normative example of a the HTTPS binding of the Access Evaluations Request:</p>
<div class="example" id="example-access-evaluations-request">
        <div class="marker">
    <a class="self-link" href="#example-access-evaluations-request">Example<bdi> 43</bdi></a><span class="example-title">: Example of an HTTPS Access Evaluations Request</span>
  </div> <pre aria-busy="false"><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/access/v1/evaluations</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>pdp.example.com
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json
<span class="hljs-attribute">Authorization</span><span class="hljs-punctuation">: </span>Bearer 
<span class="hljs-attribute">X-Request-ID</span><span class="hljs-punctuation">: </span>bfe9eb29-ab87-4ca3-be83-a1d5d8305716

<span class="language-css">{
  "subject": {
    "type": <span class="hljs-string">"user"</span>,
    <span class="hljs-string">"id"</span>: <span class="hljs-string">"alice@example.com"</span>
  },
  "context": {
    "<span class="hljs-selector-tag">time</span>": <span class="hljs-string">"2024-05-31T15:22-07:00"</span>
  },
  "action": {
    "name": <span class="hljs-string">"can_read"</span>
  },
  "evaluations": [
    {
      "resource": {
        "type": <span class="hljs-string">"document"</span>,
        <span class="hljs-string">"id"</span>: <span class="hljs-string">"boxcarring.md"</span>
      }
    },
    {
      "resource": {
        "type": <span class="hljs-string">"document"</span>,
        <span class="hljs-string">"id"</span>: <span class="hljs-string">"subject-search.md"</span>
      }
    },
    {
      "action": {
        "name": <span class="hljs-string">"can_edit"</span>
      },
      "resource": {
        "type": <span class="hljs-string">"document"</span>,
        <span class="hljs-string">"id"</span>: <span class="hljs-string">"resource-search.md"</span>
      }
    }
  ]
}
</span></code></pre>
      </div>

<p>The following is a non-normative example of an HTTPS Access Evaluations Response:</p>
<div class="example" id="example-access-evaluations-response">
        <div class="marker">
    <a class="self-link" href="#example-access-evaluations-response">Example<bdi> 44</bdi></a><span class="example-title">: Example of an HTTPS Access Evaluations Response</span>
  </div> <pre class="http" aria-busy="false"><code class="hljs">HTTP/1.1 OK
Content-Type: application/json
X-Request-ID: bfe9eb29-ab87-4ca3-be83-a1d5d8305716

{
  "evaluations": [
    {
      "decision": true
    },
    {
      "decision": false,
      "context": {
        "error": {
          "status": 404,
          "message": "Resource not found"
        }
      }
    },
    {
      "decision": false,
      "context": {
        "reason": "Subject is a viewer of the resource"
      }
    }
  ]
}</code></pre>
      </div>

<p>The following is a non-normative example of the HTTPS binding of the Subject Search Request:</p>
<div class="example" id="example-subject-search-request">
        <div class="marker">
    <a class="self-link" href="#example-subject-search-request">Example<bdi> 45</bdi></a><span class="example-title">: Example of an HTTPS Subject Search Request</span>
  </div> <pre aria-busy="false"><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/access/v1/search/subject</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>pdp.example.com
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json
<span class="hljs-attribute">Authorization</span><span class="hljs-punctuation">: </span>Bearer 
<span class="hljs-attribute">X-Request-ID</span><span class="hljs-punctuation">: </span>bfe9eb29-ab87-4ca3-be83-a1d5d8305716

<span class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"can_read"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"account"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"123"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</span></code></pre>
      </div>

<p>The following is a non-normative example of an HTTPS Subject Search Response:</p>
<div class="example" id="example-subject-search-response">
        <div class="marker">
    <a class="self-link" href="#example-subject-search-response">Example<bdi> 46</bdi></a><span class="example-title">: Example of an HTTPS Subject Search Response</span>
  </div> <pre class="http" aria-busy="false"><code class="hljs">HTTP/1.1 OK
Content-Type: application/json
X-Request-ID: bfe9eb29-ab87-4ca3-be83-a1d5d8305716

{
  "page": {
    "next_token": "a3M9NDU2O3N6PTI="
  },
  "results": [
    {
      "type": "user",
      "id": "alice@example.com"
    },
    {
      "type": "user",
      "id": "bob@example.com"
    }
  ]
}</code></pre>
      </div>

<p>The following is a non-normative example of the HTTPS binding of the Resource Search Request:</p>
<div class="example" id="example-resource-search-request">
        <div class="marker">
    <a class="self-link" href="#example-resource-search-request">Example<bdi> 47</bdi></a><span class="example-title">: Example of an HTTPS Resource Search Request</span>
  </div> <pre aria-busy="false"><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/access/v1/search/resource</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>pdp.example.com
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json
<span class="hljs-attribute">Authorization</span><span class="hljs-punctuation">: </span>Bearer 
<span class="hljs-attribute">X-Request-ID</span><span class="hljs-punctuation">: </span>bfe9eb29-ab87-4ca3-be83-a1d5d8305716

<span class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alice@example.com"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"can_read"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"resource"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"account"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</span></code></pre>
      </div>

<p>The following is a non-normative example of an HTTPS Resource Search Response:</p>
<div class="example" id="example-resource-search-response">
        <div class="marker">
    <a class="self-link" href="#example-resource-search-response">Example<bdi> 48</bdi></a><span class="example-title">: Example of an HTTPS Resource Search Response</span>
  </div> <pre class="http" aria-busy="false"><code class="hljs">HTTP/1.1 OK
Content-Type: application/json
X-Request-ID: bfe9eb29-ab87-4ca3-be83-a1d5d8305716

{
  "page": {
    "next_token": "a3M9NDU2O3N6PTI="
  },
  "results": [
    {
      "type": "account",
      "id": "123"
    },
    {
      "type": "account",
      "id": "456"
    }
  ]
}</code></pre>
      </div>

<p>The following is a non-normative example of the HTTPS binding of the Action Search Request:</p>
<div class="example" id="example-action-search-request">
        <div class="marker">
    <a class="self-link" href="#example-action-search-request">Example<bdi> 49</bdi></a><span class="example-title">: Example of an HTTPS Action Search Request</span>
  </div> <pre aria-busy="false"><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/access/v1/search/action</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>pdp.example.com
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json
<span class="hljs-attribute">Authorization</span><span class="hljs-punctuation">: </span>Bearer 
<span class="hljs-attribute">X-Request-ID</span><span class="hljs-punctuation">: </span>bfe9eb29-ab87-4ca3-be83-a1d5d8305716

<span class="language-css">{
  "subject": {
    "type": <span class="hljs-string">"user"</span>,
    <span class="hljs-string">"id"</span>: <span class="hljs-string">"alice@example.com"</span>
  },
  "resource": {
    "type": <span class="hljs-string">"account"</span>,
    <span class="hljs-string">"id"</span>: <span class="hljs-string">"123"</span>
  },
  "context": {
    "<span class="hljs-selector-tag">time</span>": <span class="hljs-string">"2024-10-26T01:22-07:00"</span>
  }
}
</span></code></pre>
      </div>

<p>The following is a non-normative example of an HTTPS Action Search Response:</p>
<div class="example" id="example-action-search-response">
        <div class="marker">
    <a class="self-link" href="#example-action-search-response">Example<bdi> 50</bdi></a><span class="example-title">: Example of an HTTPS Action Search Response</span>
  </div> <pre class="http" aria-busy="false"><code class="hljs">HTTP/1.1 OK
Content-Type: application/json
X-Request-ID: bfe9eb29-ab87-4ca3-be83-a1d5d8305716

{
  "page": {
    "next_token": "a3M9NDU2O3N6PTI="
  },
  "results": [
    {
      "name": "can_read"
    },
    {
      "name": "can_write"
    }
  ]
}</code></pre>
      </div></section></section></section>
  <section id="security-considerations"><div class="header-wrapper"><h2 id="Security"><bdi class="secno">11. </bdi>Security Considerations</h2><a class="self-link" href="#Security" aria-label="Permalink for Section 11."></a></div><section id="communication-integrity-and-confidentiality"><div class="header-wrapper"><h3 id="security-integrity-confidentiality"><bdi class="secno">11.1 </bdi>Communication Integrity and Confidentiality</h3><a class="self-link" href="#security-integrity-confidentiality" aria-label="Permalink for Section 11.1"></a></div><p>In the ABAC architecture, the PEP-PDP connection is the most sensitive one and needs to be secured to guarantee:</p>
<ul>
<li>Integrity</li>
<li>Confidentiality</li>
</ul>
<p>As a result, the connection between the PEP and the PDP <em class="rfc2119">MUST</em> be secured using the most adequate means given the choice of transport (e.g. TLS for HTTP REST).</p>
</section><section id="policy-confidentiality-and-sender-authentication"><div class="header-wrapper"><h3 id="security-confidentiality-authn"><bdi class="secno">11.2 </bdi>Policy Confidentiality and Sender Authentication</h3><a class="self-link" href="#security-confidentiality-authn" aria-label="Permalink for Section 11.2"></a></div><p>Additionally, the PDP <em class="rfc2119">SHOULD</em> authenticate the calling PEP. There are several ways authentication can be established. These ways are out of scope of this specification. They <em class="rfc2119">MAY</em> include:</p>
<ul>
<li>Mutual TLS</li>
<li>OAuth-based authentication</li>
<li>API key</li>
</ul>
<p>The choice and strength of either mechanism is not in scope.</p>
<p>Authenticating the PEP allows the PDP to avoid common attacks (such as DoS - see below) and/or reveal its internal policies. A malicious actor could craft a large number of requests to try and understand what policies the PDP is configured with. Requesting a PEP be authenticated mitigates that risk.</p>
</section><section id="sender-authentication-failure"><div class="header-wrapper"><h3 id="security-sender-authentn-fail"><bdi class="secno">11.3 </bdi>Sender Authentication Failure</h3><a class="self-link" href="#security-sender-authentn-fail" aria-label="Permalink for Section 11.3"></a></div><p>If the protected resource request does not include the proper authentication credentials, or does not have a valid authentication scheme proof that enables access to the protected resource, the resource server <em class="rfc2119">MUST</em> respond with a 401 HTTP status code and <em class="rfc2119">SHOULD</em> include the HTTP "WWW-Authenticate" response header field; it <em class="rfc2119">MAY</em> include it in response to other conditions as well. The "WWW-Authenticate" header field uses the framework defined by HTTP/1.1 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2617" title="HTTP Authentication: Basic and Digest Access Authentication">RFC2617</a></cite>] and indicates the expected authentication scheme as well as the realm that has authority for it.</p>
<p>The following is a non-normative example response:</p>
<pre><code class="http hljs" aria-busy="false"><span class="hljs-meta">HTTP/1.1</span> <span class="hljs-number">401</span> Unauthorized
<span class="hljs-attribute">WWW-Authenticate</span><span class="hljs-punctuation">: </span>Bearer realm="https://as.example.com"
</code></pre>
</section><section id="trust"><div class="header-wrapper"><h3 id="security-trust"><bdi class="secno">11.4 </bdi>Trust</h3><a class="self-link" href="#security-trust" aria-label="Permalink for Section 11.4"></a></div><p>In ABAC, there are occasionally conversations around the trust between PEP and PDP: how can the PDP trust that the PEP is sending the correct values? The architecture of this model assumes the PDP must trust the PEP, as the PEP is ultimately responsible for enforcing the decision the PDP produces.</p>
</section><section id="json-payload-considerations"><div class="header-wrapper"><h3 id="security-json"><bdi class="secno">11.5 </bdi>JSON Payload Considerations</h3><a class="self-link" href="#security-json" aria-label="Permalink for Section 11.5"></a></div><p>To ensure the unambiguous interpretation of JSON payloads, implementations <em class="rfc2119">SHOULD</em> process and generate JSON payloads in a manner consistent with the I-JSON profile ([<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7493" title="The I-JSON Message Format">RFC7493</a></cite>]). In particular, implementations <em class="rfc2119">SHOULD</em> ensure that:</p>
<ul>
<li>JSON text is encoded as UTF-8, and strings do not contain invalid Unicode sequences such as unpaired surrogates (Section 2.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7493" title="The I-JSON Message Format">RFC7493</a></cite>]).</li>
<li>Numeric values do not exceed the magnitude or precision supported by IEEE 754 double-precision (Section 2.2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7493" title="The I-JSON Message Format">RFC7493</a></cite>]).  </li>
<li>Member names within a JSON object are unique after processing escape characters (Section 2.3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7493" title="The I-JSON Message Format">RFC7493</a></cite>]).</li>
</ul>
<p>To avoid ambiguity between a property that is absent and one that is present with a null value, properties with a value of null <em class="rfc2119">SHOULD</em> be omitted from JSON objects.</p>
</section><section id="authorization-response-integrity"><div class="header-wrapper"><h3 id="security-authorization-response-integrity"><bdi class="secno">11.6 </bdi>Authorization Response Integrity</h3><a class="self-link" href="#security-authorization-response-integrity" aria-label="Permalink for Section 11.6"></a></div><p>The PDP <em class="rfc2119">MAY</em> choose to sign its authorization response, ensuring the PEP can verify the integrity of the data it receives. This practice is valuable for maintaining trust in the authorization process.</p>
<p>The PEP can ensure that the authorization response is not tampered with by verifying the signature of the authorization decision if it is signed. It ensures response accuracy and completeness.</p>
<p>TLS effectively protects data in transit for a direct, point-to-point connection but does not guarantee data integrity for the full connection path between the PEP and the PDP if there are intermediaries, such as proxies or gateways.</p>
<p>Digital signatures offer important advantages in this context. They provide non-repudiation, allowing verification that the response genuinely originated from the PDP. Moreover, digital signatures ensure the integrity of the authorization response, confirming that its contents have not been altered in transit.</p>
</section><section id="availability-denial-of-service-security-avail-dos"><div class="header-wrapper"><h3 id="x11-7-availability-denial-of-service-security-avail-dos"><bdi class="secno">11.7 </bdi>Availability &amp; Denial of Service {#security-avail-dos}}</h3><a class="self-link" href="#availability-denial-of-service-security-avail-dos" aria-label="Permalink for Section 11.7"></a></div>
<p>The PDP <em class="rfc2119">SHOULD</em> apply reasonable protections to avoid common attacks tied to request payload size, the number of requests, invalid JSON, nested JSON attacks, or memory consumption. Rate limiting is one such way to address such issues.</p>
</section><section id="differences-between-unsigned-and-signed-metadata"><div class="header-wrapper"><h3 id="security-metadata-sig"><bdi class="secno">11.8 </bdi>Differences between Unsigned and Signed Metadata</h3><a class="self-link" href="#security-metadata-sig" aria-label="Permalink for Section 11.8"></a></div><p>Unsigned metadata is integrity protected by use of TLS at the site where it is hosted. This means that its security is dependent upon the Internet Public Key Infrastructure (PKI) [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9525" title="Service Identity in TLS">RFC9525</a></cite>]. Signed metadata is additionally integrity protected by the JWS signature applied by the issuer, which is not dependent upon the Internet PKI.
When using unsigned metadata, the party issuing the metadata is the PDP itself. Whereas, when using signed metadata, the party issuing the metadata is represented by the <code>iss</code> (issuer) claim in the signed metadata. When using signed metadata, applications can make trust decisions based on the issuer that performed the signing -- information that is not available when using unsigned metadata. How these trust decisions are made is out of scope for this specification.</p>
</section><section id="metadata-caching"><div class="header-wrapper"><h3 id="security-metadata-caching"><bdi class="secno">11.9 </bdi>Metadata Caching</h3><a class="self-link" href="#security-metadata-caching" aria-label="Permalink for Section 11.9"></a></div><p>Policy Decision Point metadata is retrieved using an HTTP GET request, as specified in <a href="#pdp-metadata-access-request" data-matched-text="[[[#pdp-metadata-access-request]]]" class="sec-ref"><bdi class="secno">9.2.1 </bdi>Policy Decision Point Metadata Request</a>. Normal HTTP caching behaviors apply, meaning that the GET may retrieve a cached copy of the content, rather than the latest copy. Implementations should utilize HTTP caching directives such as Cache-Control with max-age, as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7234" title="Hypertext Transfer Protocol (HTTP/1.1): Caching">RFC7234</a></cite>], to enable caching of retrieved metadata for appropriate time periods.</p>
</section></section>
  <section id="iana-considerations"><div class="header-wrapper"><h2 id="iana"><bdi class="secno">12. </bdi>IANA Considerations</h2><a class="self-link" href="#iana" aria-label="Permalink for Section 12."></a></div><p>This specification requests IANA to take four actions: the creation of a new protocol registry group named 'AuthZEN', the establishment of two new registries within this group ('AuthZEN Policy Decision Point Metadata' and 'AuthZEN Policy Decision Point Capabilities'), the registration of a new Well-Known URI ('authzen-configuration'), and the registration of a new URN sub-namespace ('authzen').</p>
<p>The following registration procedure is used for the registries established by this specification.</p>
<p>Values are registered on a Specification Required [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8126" title="Guidelines for Writing an IANA Considerations Section in RFCs">RFC8126</a></cite>] basis after a two-week review period on the <a href="mailto:openid-specs-authzen@lists.openid.net">openid-specs-authzen@lists.openid.net</a> mailing list, following review and approval by one or more Designated Experts. However, to allow for the allocation of values prior to publication of the final version of a specification, the Designated Experts may approve registration once they are satisfied that the specification will be completed and published. However, if the specification is not completed and published in a timely manner, as determined by the Designated Experts, the Designated Experts may request that IANA withdraw the registration.</p>
<p>Registration requests sent to the mailing list for review should use an appropriate subject (e.g., "Request to register AuthZEN Policy Decision Point Metadata: example").</p>
<p>Within the review period, the Designated Experts will either approve or deny the registration request, communicating this decision to the review list and IANA. Denials should include an explanation and, if applicable, suggestions as to how to make the request successful. The IANA escalation process is followed when the Designated Experts are not responsive within 14 days.</p>
<p>Criteria that should be applied by the Designated Experts includes determining whether the proposed registration duplicates existing functionality, determining whether it is likely to be of general applicability or whether it is useful only for a single application, and whether the registration makes sense.</p>
<p>IANA must only accept registry updates from the Designated Experts and should direct all requests for registration to the review mailing list.</p>
<p>It is suggested that multiple Designated Experts be appointed who are able to represent the perspectives of different applications using this specification, in order to enable broadly-informed review of registration decisions. In cases where a registration decision could be perceived as creating a conflict of interest for a particular Expert, that Expert should defer to the judgment of the other Experts.</p>
<p>The reason for the use of the mailing list is to enable public review of registration requests, enabling both Designated Experts and other interested parties to provide feedback on proposed registrations. The reason to allow the Designated Experts to allocate values prior to publication as a final specification is to enable giving authors of specifications proposing registrations the benefit of review by the Designated Experts before the specification is completely done, so that if problems are identified, the authors can iterate and fix them before publication of the final specification.</p>
<section id="authzen-policy-decision-point-metadata-registry"><div class="header-wrapper"><h3 id="iana-pdp-metadata-registry"><bdi class="secno">12.1 </bdi>AuthZEN Policy Decision Point Metadata Registry</h3><a class="self-link" href="#iana-pdp-metadata-registry" aria-label="Permalink for Section 12.1"></a></div><p>This specification asks IANA to establish the "AuthZEN Policy Decision Point Metadata" registry under the registry group "AuthZEN Parameters". The registry records the Policy Decision Point metadata parameter and a reference to the specification that defines it.</p>
<section id="registry-definition"><div class="header-wrapper"><h4 id="x12-1-1-registry-definition"><bdi class="secno">12.1.1 </bdi>Registry Definition</h4><a class="self-link" href="#registry-definition" aria-label="Permalink for Section 12.1.1"></a></div>
<p>Registry Name: AuthZEN Policy Decision Point Metadata</p>
<p>Registration Policy: Specification Required per [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8126" title="Guidelines for Writing an IANA Considerations Section in RFCs">RFC8126</a></cite>]</p>
<p>Reference: [This Document]</p>
</section><section id="registration-template"><div class="header-wrapper"><h4 id="iana-pdp-metadata-template"><bdi class="secno">12.1.2 </bdi>Registration Template</h4><a class="self-link" href="#iana-pdp-metadata-template" aria-label="Permalink for Section 12.1.2"></a></div><p>Metadata Name:
: The name requested (e.g., "resource"). This name is case-sensitive. Names may not match other registered names in a case-insensitive manner unless the Designated Experts state that there is a compelling reason to allow an exception.</p>
<p>Metadata Description:
: Brief description of the metadata (e.g., "Resource identifier URL").</p>
<p>Change Controller:
: For IETF stream RFCs, list the "IETF". For others, give the name of the responsible party. Other details (e.g., postal address, email address, home page URI) may also be included.</p>
<p>Specification Document(s):
: Reference to the document or documents that specify the parameter, preferably including URIs that can be used to retrieve copies of the documents. An indication of the relevant sections may also be included but is not required.</p>
</section><section id="initial-registrations"><div class="header-wrapper"><h4 id="iana-pdp-metadata-initial"><bdi class="secno">12.1.3 </bdi>Initial Registrations</h4><a class="self-link" href="#iana-pdp-metadata-initial" aria-label="Permalink for Section 12.1.3"></a></div><p>Metadata Name:
: <code>policy_decision_point</code></p>
<p>Metadata Description:
: Base URL of the Policy Decision Point</p>
<p>Change Controller:
: OpenID Foundation AuthZEN Working Group
: <a href="mailto:openid-specs-authzen@lists.openid.net">openid-specs-authzen@lists.openid.net</a></p>
<p>Specification Document(s):
: <a href="#pdp-metadata-data-endpoint" data-matched-text="[[[#pdp-metadata-data-endpoint]]]" class="sec-ref"><bdi class="secno">9.1.1 </bdi>Endpoint Parameters</a> of [This Document]</p>
<p>Metadata Name:
: <code>access_evaluation_endpoint</code></p>
<p>Metadata Description:
: URL of the Policy Decision Point's Access Evaluation API endpoint</p>
<p>Change Controller:
: OpenID Foundation AuthZEN Working Group
: <a href="mailto:openid-specs-authzen@lists.openid.net">openid-specs-authzen@lists.openid.net</a></p>
<p>Specification Document(s):
: <a href="#pdp-metadata-data-endpoint" data-matched-text="[[[#pdp-metadata-data-endpoint]]]" class="sec-ref"><bdi class="secno">9.1.1 </bdi>Endpoint Parameters</a> of [This Document]</p>
<p>Metadata Name:
: <code>access_evaluations_endpoint</code></p>
<p>Metadata Description:
: URL of the Policy Decision Point's Access Evaluations API endpoint</p>
<p>Change Controller:
: OpenID Foundation AuthZEN Working Group
: <a href="mailto:openid-specs-authzen@lists.openid.net">openid-specs-authzen@lists.openid.net</a></p>
<p>Specification Document(s):
: <a href="#pdp-metadata-data-endpoint" data-matched-text="[[[#pdp-metadata-data-endpoint]]]" class="sec-ref"><bdi class="secno">9.1.1 </bdi>Endpoint Parameters</a> of [This Document]</p>
<p>Metadata Name:
: <code>search_subject_endpoint</code></p>
<p>Metadata Description:
: URL of the Policy Decision Point's Search API endpoint for Subject entities</p>
<p>Change Controller:
: OpenID Foundation AuthZEN Working Group
: <a href="mailto:openid-specs-authzen@lists.openid.net">openid-specs-authzen@lists.openid.net</a></p>
<p>Specification Document(s):
: <a href="#pdp-metadata-data-endpoint" data-matched-text="[[[#pdp-metadata-data-endpoint]]]" class="sec-ref"><bdi class="secno">9.1.1 </bdi>Endpoint Parameters</a> of [This Document]</p>
<p>Metadata Name:
: <code>search_resource_endpoint</code></p>
<p>Metadata Description:
: URL of the Policy Decision Point's Search API endpoint for Resource entities</p>
<p>Change Controller:
: OpenID Foundation AuthZEN Working Group
: <a href="mailto:openid-specs-authzen@lists.openid.net">openid-specs-authzen@lists.openid.net</a></p>
<p>Specification Document(s):
: <a href="#pdp-metadata-data-endpoint" data-matched-text="[[[#pdp-metadata-data-endpoint]]]" class="sec-ref"><bdi class="secno">9.1.1 </bdi>Endpoint Parameters</a> of [This Document]</p>
<p>Metadata Name:
: <code>search_action_endpoint</code></p>
<p>Metadata Description:
: URL of the Policy Decision Point's Search API endpoint for Action entities</p>
<p>Change Controller:
: OpenID Foundation AuthZEN Working Group
: <a href="mailto:openid-specs-authzen@lists.openid.net">openid-specs-authzen@lists.openid.net</a></p>
<p>Specification Document(s):
: <a href="#pdp-metadata-data-endpoint" data-matched-text="[[[#pdp-metadata-data-endpoint]]]" class="sec-ref"><bdi class="secno">9.1.1 </bdi>Endpoint Parameters</a> of [This Document]</p>
<p>Metadata Name:
: <code>capabilities</code></p>
<p>Metadata Description:
: Array of URNs describing specific Policy Decision Point capabilities</p>
<p>Change Controller:
: OpenID Foundation AuthZEN Working Group
: <a href="mailto:openid-specs-authzen@lists.openid.net">openid-specs-authzen@lists.openid.net</a></p>
<p>Specification Document(s):
: <a href="#pdp-metadata-data-capabilities" data-matched-text="[[[#pdp-metadata-data-capabilities]]]" class="sec-ref"><bdi class="secno">9.1.2 </bdi>Capabilities Parameters</a> of [This Document]</p>
<p>Metadata Name:
: <code>signed_metadata</code></p>
<p>Metadata Description:
: JWT containing metadata parameters about the protected resource as claims.</p>
<p>Change Controller:
: OpenID Foundation AuthZEN Working Group
: <a href="mailto:openid-specs-authzen@lists.openid.net">openid-specs-authzen@lists.openid.net</a></p>
<p>Specification Document(s):
: <a href="#pdp-metadata-data-sig" data-matched-text="[[[#pdp-metadata-data-sig]]]" class="sec-ref"><bdi class="secno">9.1.3 </bdi>Signature Parameter</a> of [This Document]</p>
</section></section><section id="well-known-uri-registry"><div class="header-wrapper"><h3 id="iana-wk-registry"><bdi class="secno">12.2 </bdi>Well-Known URI Registry</h3><a class="self-link" href="#iana-wk-registry" aria-label="Permalink for Section 12.2"></a></div><p>This specification asks IANA to register the well-known URI defined in <a href="#pdp-metadata-access" data-matched-text="[[[#pdp-metadata-access]]]" class="sec-ref"><bdi class="secno">9.2 </bdi>Obtaining Policy Decision Point Metadata</a> in the IANA "Well-Known URIs" registry [<cite><a class="bibref" data-link-type="biblio" href="#bib-iana.well-known-uris" title="IANA &quot;Well-Known URIs&quot; registry">IANA.well-known-uris</a></cite>].</p>
<section id="registry-contents"><div class="header-wrapper"><h4 id="iana-wk-contents"><bdi class="secno">12.2.1 </bdi>Registry Contents</h4><a class="self-link" href="#iana-wk-contents" aria-label="Permalink for Section 12.2.1"></a></div><p>URI Suffix:
: authzen-configuration</p>
<p>Reference:
: [This Document]</p>
<p>Status:
: permanent</p>
<p>Change Controller:
: OpenID Foundation AuthZEN Working Group
: <a href="mailto:openid-specs-authzen@lists.openid.net">openid-specs-authzen@lists.openid.net</a></p>
<p>Related Information:
: (none)</p>
</section></section><section id="authzen-policy-decision-point-capabilities-registry"><div class="header-wrapper"><h3 id="iana-pdp-capabilities-registry"><bdi class="secno">12.3 </bdi>AuthZEN Policy Decision Point Capabilities Registry</h3><a class="self-link" href="#iana-pdp-capabilities-registry" aria-label="Permalink for Section 12.3"></a></div><p>This specification asks IANA to establish the "AuthZEN Policy Decision Point Capabilities" registry under the registry group "AuthZEN Parameters". The registry contains PDP-specific capabilities or features. These URNs are intended to be used in Policy Decision Point metadata discovery documents (as described in <a href="#pdp-metadata" data-matched-text="[[[#pdp-metadata]]]" class="sec-ref"><bdi class="secno">9. </bdi>Policy Decision Point Metadata</a>) to allow a PEP to determine the supported functionality of a given PDP instance. The content of this registry will be specified by AuthZEN-compliant PDP vendors that want to declare interoperable capabilities.</p>
<section id="registry-definition-0"><div class="header-wrapper"><h4 id="iana-pdp-capabilities-definition"><bdi class="secno">12.3.1 </bdi>Registry Definition</h4><a class="self-link" href="#iana-pdp-capabilities-definition" aria-label="Permalink for Section 12.3.1"></a></div><p>Registry Name: AuthZEN Policy Decision Point Capabilities</p>
<p>Registration Policy: Specification Required per [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8126" title="Guidelines for Writing an IANA Considerations Section in RFCs">RFC8126</a></cite>]</p>
<p>Reference: [This Document]</p>
</section><section id="registration-template-0"><div class="header-wrapper"><h4 id="iana-pdp-capabilities-template"><bdi class="secno">12.3.2 </bdi>Registration Template</h4><a class="self-link" href="#iana-pdp-capabilities-template" aria-label="Permalink for Section 12.3.2"></a></div><p>Capability Name:
: The name of the capability. This name <em class="rfc2119">MUST</em> begin with the colon (":") character. This name is case-sensitive. Names may not match other registered names in a case-insensitive manner unless the Designated Experts state that there is a compelling reason to allow an exception.</p>
<p>Capability URN: The URN of the AuthZEN Policy Decision Point Capability.</p>
<p>Capability Description:
: Brief description of the capability.</p>
<p>Change Controller:
: OpenID Foundation AuthZEN Working Group
: <a href="mailto:openid-specs-authzen@lists.openid.net">openid-specs-authzen@lists.openid.net</a></p>
<p>Specification Document(s):
: Reference to the document or documents that specify the parameter, preferably including URIs that can be used to retrieve copies of the documents. An indication of the relevant sections may also be included but is not required.</p>
</section></section><section id="registration-of-authzen-urn-sub-namespace"><div class="header-wrapper"><h3 id="iana-urn-namespace"><bdi class="secno">12.4 </bdi>Registration of "authzen" URN Sub-namespace</h3><a class="self-link" href="#iana-urn-namespace" aria-label="Permalink for Section 12.4"></a></div><p>This specification asks IANA to register a new URN sub-namespace within the "IETF URN Sub-namespace for Registered Protocol Parameter Identifiers" registry defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3553" title="An IETF URN Sub-namespace for Registered Protocol Parameters">RFC3553</a></cite>].</p>
<p>Registry Name: authzen</p>
<p>Specification: [This Document]</p>
<p>Repository: "AuthZEN Policy Decision Point Capabilities" registry (<a href="#iana-pdp-capabilities-registry" data-matched-text="[[[#iana-pdp-capabilities-registry]]]" class="sec-ref"><bdi class="secno">12.3 </bdi>AuthZEN Policy Decision Point Capabilities Registry</a> of [This Document])</p>
<p>Index value: Sub-parameters <em class="rfc2119">MUST</em> be specified in UTF-8, using standard URI encoding where necessary.</p>
</section></section>
  <section class="appendix" id="terminology"><div class="header-wrapper"><h2 id="a-terminology"><bdi class="secno">A. </bdi>Terminology</h2><a class="self-link" href="#terminology" aria-label="Permalink for Appendix A."></a></div>
<p><dfn data-lt="Subject" id="dfn-subject" tabindex="0" aria-haspopup="dialog">Subject</dfn></p>
<p>The user or machine principal for whom an authorization decision is being requested.</p>
<p><dfn data-lt="Resource" id="dfn-resource" tabindex="0" aria-haspopup="dialog">Resource</dfn></p>
<p>The target of the request; the resource about which the Authorization API is being made.</p>
<p><dfn data-lt="Action" id="dfn-action" tabindex="0" aria-haspopup="dialog">Action</dfn></p>
<p>The operation the <a data-xref-type="_IDL_" data-link-type="idl" data-lt="Subject" href="#dfn-subject" class="internalDFN" id="ref-for-dfn-subject-1"><code>Subject</code></a> has attempted on the <a data-xref-type="_IDL_" data-link-type="idl" data-lt="Resource" href="#dfn-resource" class="internalDFN" id="ref-for-dfn-resource-1"><code>Resource</code></a> in an Authorization API call.</p>
<p><dfn data-lt="Context" id="dfn-context" tabindex="0" aria-haspopup="dialog">Context</dfn></p>
<p>The environmental or contextual attributes for this request.</p>
<p><dfn data-lt="Decision" id="dfn-decision" tabindex="0" aria-haspopup="dialog">Decision</dfn></p>
<p>The value of the evaluation decision made by the PDP: <code>true</code> for "allow", <code>false</code> for "deny".</p>
<p><dfn data-lt="PDP" id="dfn-pdp" tabindex="0" aria-haspopup="dialog">PDP</dfn></p>
<p>Policy Decision Point. The component or system that provides authorization decisions over the network interface defined here as the Authorization API.</p>
<p><dfn data-lt="PEP" id="dfn-pep" tabindex="0" aria-haspopup="dialog">PEP</dfn></p>
<p>Policy Enforcement Point. The component or system that requests decisions from the PDP and enforces access to specific requests based on the decisions obtained from the PDP.</p>
</section>
  <section class="appendix" id="acknowledgements"><div class="header-wrapper"><h2 id="Acknowledgements"><bdi class="secno">B. </bdi>Acknowledgements</h2><a class="self-link" href="#Acknowledgements" aria-label="Permalink for Appendix B."></a></div><p>This template uses extracts from templates written by
Pekka Savola, Elwyn Davies and Henrik Levkowetz.</p>
</section>
  
  <section id="tof"></section>
  <section id="index" class="appendix"><div class="header-wrapper"><h2 id="c-index"><bdi class="secno">C. </bdi>Index</h2><a class="self-link" href="#index" aria-label="Permalink for Appendix C."></a></div><section id="index-defined-here">
    <div class="header-wrapper"><h3 id="c-1-terms-defined-by-this-specification"><bdi class="secno">C.1 </bdi>Terms defined by this specification</h3><a class="self-link" href="#index-defined-here" aria-label="Permalink for Appendix C.1"></a></div>
    <ul class="index">
    <li>
      <a class="index-term" href="#dfn-action">Action</a> 
    <span class="print-only">§A.</span></li><li>
      <a class="index-term" href="#dfn-context">Context</a> 
    <span class="print-only">§A.</span></li><li>
      <a class="index-term" href="#dfn-decision">Decision</a> 
    <span class="print-only">§A.</span></li><li>
      <a class="index-term" href="#dfn-pdp">PDP</a> 
    <span class="print-only">§A.</span></li><li>
      <a class="index-term" href="#dfn-pep">PEP</a> 
    <span class="print-only">§A.</span></li><li>
      <a class="index-term" href="#dfn-resource">Resource</a> 
    <span class="print-only">§A.</span></li><li>
      <a class="index-term" href="#dfn-subject">Subject</a> 
    <span class="print-only">§A.</span></li>
  </ul>
  </section><section id="index-defined-elsewhere">
    <div class="header-wrapper"><h3 id="c-2-terms-defined-by-reference"><bdi class="secno">C.2 </bdi>Terms defined by reference</h3><a class="self-link" href="#index-defined-elsewhere" aria-label="Permalink for Appendix C.2"></a></div>
    <ul class="index">
    
  </ul>
  </section></section>


<section id="references" class="appendix"><div class="header-wrapper"><h2 id="d-references"><bdi class="secno">D. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix D."></a></div><section id="normative-references">
    <div class="header-wrapper"><h3 id="d-1-normative-references"><bdi class="secno">D.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix D.1"></a></div>
    <dl class="bibliography"><dt id="bib-iana.well-known-uris">[IANA.well-known-uris]</dt><dd>
      <a href="https://www.iana.org/assignments/well-known-uris/well-known-uris.xhtml"><cite>IANA "Well-Known URIs" registry</cite></a>. 2010-01-20. URL: <a href="https://www.iana.org/assignments/well-known-uris/well-known-uris.xhtml">https://www.iana.org/assignments/well-known-uris/well-known-uris.xhtml</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc3339">[RFC3339]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc3339"><cite>Date and Time on the Internet: Timestamps</cite></a>. G. Klyne; C. Newman.  IETF. July 2002. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc3339">https://www.rfc-editor.org/rfc/rfc3339</a>
    </dd><dt id="bib-rfc3553">[RFC3553]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc3553"><cite>An IETF URN Sub-namespace for Registered Protocol Parameters</cite></a>. M. Mealling; L. Masinter; T. Hardie; G. Klyne.  IETF. June 2003. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc3553">https://www.rfc-editor.org/rfc/rfc3553</a>
    </dd><dt id="bib-rfc7515">[RFC7515]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7515"><cite>JSON Web Signature (JWS)</cite></a>. M. Jones; J. Bradley; N. Sakimura.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7515">https://www.rfc-editor.org/rfc/rfc7515</a>
    </dd><dt id="bib-rfc7519">[RFC7519]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7519"><cite>JSON Web Token (JWT)</cite></a>. M. Jones; J. Bradley; N. Sakimura.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd><dt id="bib-rfc8259">[RFC8259]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8259"><cite>The JavaScript Object Notation (JSON) Data Interchange Format</cite></a>. T. Bray, Ed. IETF. December 2017. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8259">https://www.rfc-editor.org/rfc/rfc8259</a>
    </dd><dt id="bib-rfc8615">[RFC8615]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8615"><cite>Well-Known Uniform Resource Identifiers (URIs)</cite></a>. M. Nottingham.  IETF. May 2019. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8615">https://www.rfc-editor.org/rfc/rfc8615</a>
    </dd><dt id="bib-rfc9110">[RFC9110]</dt><dd>
      <a href="https://httpwg.org/specs/rfc9110.html"><cite>HTTP Semantics</cite></a>. R. Fielding, Ed.; M. Nottingham, Ed.; J. Reschke, Ed. IETF. June 2022. Internet Standard. URL: <a href="https://httpwg.org/specs/rfc9110.html">https://httpwg.org/specs/rfc9110.html</a>
    </dd></dl>
  </section><section id="informative-references">
    <div class="header-wrapper"><h3 id="d-2-informative-references"><bdi class="secno">D.2 </bdi>Informative references</h3><a class="self-link" href="#informative-references" aria-label="Permalink for Appendix D.2"></a></div>
    <dl class="bibliography"><dt id="bib-adr">[ADR]</dt><dd>
      <a href="https://gitdocumentatie.logius.nl/publicatie/api/adr/2.0"><cite>API Design Rules</cite></a>. Jasper Roes; Joost Farla.  Logius. URL: <a href="https://gitdocumentatie.logius.nl/publicatie/api/adr/2.0">https://gitdocumentatie.logius.nl/publicatie/api/adr/2.0</a>
    </dd><dt id="bib-json-ld11">[JSON-LD11]</dt><dd>
      <a href="https://www.w3.org/TR/json-ld11/"><cite>JSON-LD 1.1</cite></a>. Gregg Kellogg; Pierre-Antoine Champin; Dave Longley.  W3C. 16 July 2020. W3C Recommendation. URL: <a href="https://www.w3.org/TR/json-ld11/">https://www.w3.org/TR/json-ld11/</a>
    </dd><dt id="bib-mim">[MIM]</dt><dd>
      <a href="https://docs.geostandaarden.nl/mim/mim/"><cite>Metamodel Informatie Modellering</cite></a>. 13 juni 2024. URL: <a href="https://docs.geostandaarden.nl/mim/mim/">https://docs.geostandaarden.nl/mim/mim/</a>
    </dd><dt id="bib-nist.sp.800-162">[NIST.SP.800-162]</dt><dd>
      <a href=" https://doi.org/10.6028/NIST.SP.800-162 "><cite> Guide to Attribute Based Access Control (ABAC) Definition and Considerations </cite></a>. Vincent C. Hu; David Ferraiolo; Rick Kuhn; Adam Schnitzer; Kenneth Sandlin; Robert Miller; Karen Scarfone.  January 2014 . URL: <a href=" https://doi.org/10.6028/NIST.SP.800-162 "> https://doi.org/10.6028/NIST.SP.800-162 </a>
    </dd><dt id="bib-rfc2617">[RFC2617]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2617"><cite>HTTP Authentication: Basic and Digest Access Authentication</cite></a>. J. Franks; P. Hallam-Baker; J. Hostetler; S. Lawrence; P. Leach; A. Luotonen; L. Stewart.  IETF. June 1999. Draft Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc2617">https://www.rfc-editor.org/rfc/rfc2617</a>
    </dd><dt id="bib-rfc6749">[RFC6749]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc6749"><cite>The OAuth 2.0 Authorization Framework</cite></a>. D. Hardt, Ed. IETF. October 2012. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>
    </dd><dt id="bib-rfc7234">[RFC7234]</dt><dd>
      <a href="https://httpwg.org/specs/rfc7234.html"><cite>Hypertext Transfer Protocol (HTTP/1.1): Caching</cite></a>. R. Fielding, Ed.; M. Nottingham, Ed.; J. Reschke, Ed. IETF. June 2014. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc7234.html">https://httpwg.org/specs/rfc7234.html</a>
    </dd><dt id="bib-rfc7493">[RFC7493]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7493"><cite>The I-JSON Message Format</cite></a>. T. Bray, Ed. IETF. March 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7493">https://www.rfc-editor.org/rfc/rfc7493</a>
    </dd><dt id="bib-rfc8126">[RFC8126]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8126"><cite>Guidelines for Writing an IANA Considerations Section in RFCs</cite></a>. M. Cotton; B. Leiba; T. Narten.  IETF. June 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>
    </dd><dt id="bib-rfc9525">[RFC9525]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc9525"><cite>Service Identity in TLS</cite></a>. P. Saint-Andre; R. Salz.  IETF. November 2023. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc9525">https://www.rfc-editor.org/rfc/rfc9525</a>
    </dd><dt id="bib-saml2-core">[SAML2-CORE]</dt><dd>
      <a href="http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf"><cite>Assertions and Protocols for SAML V2.0</cite></a>. Scott Cantor; John Kemp; Rob Philpott; Eve Maler. 15 March 2005. URL: <a href="http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf">http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf</a>
    </dd><dt id="bib-trace-context-1">[trace-context-1]</dt><dd>
      <a href="https://www.w3.org/TR/trace-context-1/"><cite>Trace Context</cite></a>. Sergey Kanzhelev; Morgan McLean; Alois Reitbauer; Bogdan Drutu; Nik Molnar; Yuri Shkuro.  W3C. 23 November 2021. W3C Recommendation. URL: <a href="https://www.w3.org/TR/trace-context-1/">https://www.w3.org/TR/trace-context-1/</a>
    </dd><dt id="bib-vc-data-model-2.0">[vc-data-model-2.0]</dt><dd>
      <a href="https://www.w3.org/TR/vc-data-model-2.0/"><cite>Verifiable Credentials Data Model v2.0</cite></a>. Ivan Herman; Michael Jones; Manu Sporny; Ted Thibodeau Jr; Gabe Cohen.  W3C. 15 May 2025. W3C Recommendation. URL: <a href="https://www.w3.org/TR/vc-data-model-2.0/">https://www.w3.org/TR/vc-data-model-2.0/</a>
    </dd><dt id="bib-xacml20">[XACML20]</dt><dd>
      <a href="http://docs.oasis-open.org/xacml/2.0/access_control-xacml-2.0-core-spec-os.pdf"><cite>OASIS eXtensible Access Control Markup Language (XACML) Version 2.0</cite></a>. Tim Moses. 1 February 2005. URL: <a href="http://docs.oasis-open.org/xacml/2.0/access_control-xacml-2.0-core-spec-os.pdf">http://docs.oasis-open.org/xacml/2.0/access_control-xacml-2.0-core-spec-os.pdf</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-subject" aria-label="Links in this document to definition: Subject">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-subject" aria-label="Permalink for definition: Subject. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-subject-1" title="§ A. Terminology">§ A. Terminology</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-resource" aria-label="Links in this document to definition: Resource">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-resource" aria-label="Permalink for definition: Resource. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-resource-1" title="§ A. Terminology">§ A. Terminology</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-action" aria-label="Links in this document to definition: Action">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-action" aria-label="Permalink for definition: Action. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-context" aria-label="Links in this document to definition: Context">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-context" aria-label="Permalink for definition: Context. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-decision" aria-label="Links in this document to definition: Decision">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-decision" aria-label="Permalink for definition: Decision. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-pdp" aria-label="Links in this document to definition: PDP">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-pdp" aria-label="Permalink for definition: PDP. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-pep" aria-label="Links in this document to definition: PEP">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-pep" aria-label="Permalink for definition: PEP. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><div class="sidelabel">Logius Standard - Consultation version</div><script src="https://gitdocumentatie.logius.nl/publicatie/respec/fixup.js"></script></body><b883a3940-9271-45e1-91d6-df87d4c95a1a></b883a3940-9271-45e1-91d6-df87d4c95a1a></html>
